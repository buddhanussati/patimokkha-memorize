<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="icon" type="image/x-icon" href="./images/favicon3.ico">
	<link rel="manifest" href="./manifest5.json">
	<meta name="theme-color" content="#8b5cf6">
	<link rel="apple-touch-icon" href="./images/icon-192-paritta.png">
	<link href="./css/css.css" rel="stylesheet">
    <title>Kinh Hộ Trì</title>
 	<script src="./js/jquery-1.10.2.min.js"></script>
    <script src="./js/prdpd_i2h.js"></script>
    <script src="./js/prdpd_ebts.js"></script>
    <script src="./js/prdpd_deconstructor.js"></script>

<style>
    /* Popup styling (Z-Index Fixed) */
    /* Popup styling (Z-Index Fixed) */
    span.meaning {
        display: block;
        position: absolute;
        background-color: #ffd;
        background-image: url('./images/imgbk.png');
        color: #333;
        padding: 10px;
        border-radius: 5px;
        z-index: 2000;
        font-size: 16px;
        line-height: 1.4;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        max-width: 550px;
        text-align: left;
        margin-top: 1px; /* Tăng khoảng cách ra một chút */
        border: 1px solid #d4a373;
        min-width: 250px;
        transition: 100ms;
    }

    [data-theme="dark"] span.meaning {
        display: block;
        position: absolute;
        background-color: #333;
        background-image: url('./images/imgbk.png');
        color: #fff;
        padding: 10px;
        border-radius: 5px;
        z-index: 2000;
        font-size: 16px;
        line-height: 1.4;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        max-width: 550px;
        text-align: left;
        margin-top: 1px; /* Tăng khoảng cách ra một chút */
        border: 1px solid #d4a373;
        min-width: 250px;
        transition: 100ms;
        /* --- DÒNG QUAN TRỌNG ĐỂ SỬA LỖI GIẬT --- */
    }
    /* Highlight word when lookup is active */
    .word.lookup-enabled {
        cursor: help;
        border-bottom: 1px dotted #888;
    }
    .word.lookup-enabled:hover {
        background-color: rgba(255, 215, 0, 0.2);
    }
</style>
    <style>
        /* --- CẤU HÌNH MÀU SẮC --- */
        :root {
            --primary-color: #8B4513;
            --bg-color: #ffd;
            --text-color: #333;
            --box-bg: #e0e0e0;
            --box-border: #999;
            --footer-bg: #ffd;
            --highlight-color: #d35400;
            --recitation-bg-active: #ffd;
            --recitation-text-active: #8B4513;
        }

        [data-theme="dark"] {
            --primary-color: #d4a373;
            --bg-color: #1a1a1a;
            --text-color: #e0e0e0;
            --box-bg: #333;
            --box-border: #555;
            --footer-bg: rgba(45, 45, 45, 0.95);
            --highlight-color: #f39c12;
            --recitation-bg-active: #2d2d2d;
            --recitation-text-active: #f39c12;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
			background-image: url('./images/imgbk.png');
            color: var(--text-color);
            margin: 0;
            padding: 15px;
            padding-bottom: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container { max-width: 800px; width: 100%; }

        /* --- TOP NAV --- */
        .top-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-bottom: 15px;
        }

        .nav-controls { display: flex; gap: 5px; flex-grow: 1; justify-content: center; }

        select {
            padding: 6px; font-size: 16px; border-radius: 5px;
            border: 1px solid var(--box-border);
            background-color: var(--bg-color); background-image: url('./images/imgbk.png'); color: var(--text-color);
            max-width: 200px;
        }

        .btn-nav, .btn-darkmode {
            background: transparent; border: 1px solid var(--primary-color);
            color: var(--primary-color); padding: 7px 7px; border-radius: 5px; cursor: pointer;
        }
        .btn-darkmode { background: #34495e; color: #fff; border: none; font-size: 14px; }

        h2 { text-align: center; color: var(--primary-color); margin: 5px 0 15px 0; font-size: 20px; }

        /* --- TEXT CONTENT --- */
        .text-content {
            font-size: 18px; text-align: center; line-height: 1.8; position: relative;
        }
        
        /* Ẩn văn bản gốc khi Recitation bật */
        .text-content.recitation-active > .line-break { display: none; }

        /* Hiện dòng Recitation */
        .text-content.recitation-active .line-recitation-show {
            display: block !important;
            font-size: 22px; font-weight: bold;
            color: var(--recitation-text-active);
            background-color: var(--recitation-bg-active);
			background-image: url('./images/imgbk.png');
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            animation: fadeIn 0.4s;
            border: 2px solid var(--primary-color);
            margin-top: 20px;
            position: relative;
        }

        .line-recitation-show[data-has-custom-time="true"]::after {
            position: absolute; top: 5px; right: 5px; font-size: 12px; opacity: 0.5;
        }

        .word { display: inline-block; margin: 0 2px; padding: 1px 2px; }
        .word.hidden {
            color: transparent; background-color: var(--box-bg);
            border: 1px solid var(--box-border); cursor: pointer; min-width: 1.2em;
        }
        .word.revealed { color: var(--highlight-color); border-bottom: 1px dashed var(--highlight-color); }
        .line-break { display: block; margin-bottom: 8px; }

        /* --- BOTTOM BAR --- */
        .bottom-bar {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background-color: var(--footer-bg); background-image: url('./images/imgbk.png'); color: var(--text-color);
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2); z-index: 1000;
            border-top: 2px solid var(--primary-color);
            backdrop-filter: blur(5px);
        }

        .bar-main-row {
            display: flex; align-items: center; justify-content: space-between;
            padding: 8px 10px; gap: 10px; max-width: 800px; margin: 0 auto;
        }

        audio { height: 32px; flex-grow: 1; max-width: 100%; border-radius: 15px; }

        .controls-cluster { display: flex; gap: 8px; align-items: center; flex-shrink: 0; }

        .icon-btn {
            background-color: var(--primary-color); color: #fff; border: none;
            width: 36px; height: 36px; border-radius: 50%;
            font-size: 16px; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: transform 0.1s;
        }
        .icon-btn:active { transform: scale(0.95); }
        
        /* Trạng thái nút Recitation */
        .btn-recitation { background-color: #2e8b57; transition: all 0.3s ease; }
        .btn-recitation.active-auto { background-color: #2e8b57; animation: pulse-green 2s infinite; }
        .btn-recitation.active-manual { background-color: #3566d0; }
        
        /* Nút Exit mới */
        #btn-exit-recitation {
            background-color: #c0392b; /* Màu đỏ */
            display: none; /* Mặc định ẩn */
        }
   /* --- CSS CHO PHẦN DỊCH VIỆT --- */
.translation-line {
    display: none; /* Mặc định ẩn */
    font-size: 16px;
    color: #666;
    font-style: italic;
    margin-bottom: 12px;
    font-family: 'Segoe UI', sans-serif;
}

/* Khi class 'show-translation' được thêm vào display-area, hiện dòng dịch */
.text-content.show-translation .translation-line {
    display: block;
}

/* Trong chế độ Tối */
[data-theme="dark"] .translation-line {
    color: #aaa;
}

/* Ẩn dòng dịch khi đang trong chế độ Tụng Đọc (Recitation Mode) để tránh rối */
.text-content.recitation-active .translation-line {
    display: none !important;
}

/* --- LOGIC ẨN/HIỆN NÚT --- */

/* Mặc định: Nút Exit ẩn, Nút VN hiện */
#btn-exit-recitation { display: none; }
#btn-viet-toggle { font-weight: bold;
    font-size: 13px;
    background-color: #4a69bd;
    display: flex; }

/* Khi vào chế độ Tụng Đọc: Nút Exit hiện, Nút VN ẩn */
.recitation-active-mode #btn-exit-recitation { display: flex; }
.recitation-active-mode #btn-viet-toggle { display: none; }

/* Trạng thái nút VN khi đang bật */
.btn-viet-active {
    background-color: #4a69bd !important;
   box-shadow: 0 0 10px rgba(39, 174, 96, 0.5);
    border: 2px solid #fff;
}

        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(39, 174, 96, 0.4); }
            70% { box-shadow: 0 0 0 6px rgba(39, 174, 96, 0); }
            100% { box-shadow: 0 0 0 0 rgba(39, 174, 96, 0); }
        }
        
        .btn-settings { background-color: #7f8c8d; }
        .settings-panel {
            max-height: 0; overflow: hidden; transition: max-height 0.3s ease-in-out;
            background-color: rgba(0,0,0,0.03); border-top: 1px dashed var(--box-border);
        }
        .settings-panel.open { max-height: 200px; }
        .settings-content { padding: 10px; display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;}
        .setting-group { display: flex; align-items: center; gap: 8px; }

        /* Nút nhỏ trong setting */
        .btn-sm {
            border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 13px;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        @media (max-width: 600px) {
            .bar-main-row { flex-direction: column; }
            .controls-cluster { width: 100%; justify-content: center; gap: 15px; }
        }
	#help-container a {
        /* Đặt màu liên kết cố định */
        color: #007bff; /* Màu xanh dương sáng */
        text-decoration: underline;
    }

    /* Quy tắc cho chế độ Tối (Dark Mode) */
    [data-theme="dark"] #help-container a {
        /* Màu liên kết trong Dark Mode */
        color: #90CAF9; /* Màu xanh sáng hơn */
    }

    /* Định dạng khi di chuột qua */
    #help-container a:hover {
        color: var(--highlight-color); /* Sử dụng màu nổi bật đã có của bạn */
    }
	@media (max-width: 600px) {
/* FIX 1: Tighten the top navigation bar */
.top-nav {
gap: 9px; /* Smaller gap between the Dark Mode button and main controls */
}
.nav-controls {
gap: 7px; /* Tighter gap for the navigation arrows and select */
justify-content: flex-end; /* Ensure controls are aligned right */
}
.btn-nav, .btn-darkmode {
padding: 7px 7px; /* Slightly reduced button padding */
}
#section-select {
max-width: 180px; /* Force the select box to be much narrower on mobile */
font-size: 14px; /* Smaller font to save space */
padding: 6px; /* Tighter padding */
}
/* FIX 2: Ensure the Help button fits without being cut off */
#top-right-controls {
gap: 3px; /* Tighter gap for the rightmost controls */
}
/* End FIX for top bar */

/* Keep the bottom bar layout fix */
.bar-main-row { flex-direction: column; }
.controls-cluster { width: 100%; justify-content: center; gap: 15px; }
}

/* --- BUTTON VISIBILITY LOGIC (Nav vs Random) --- */

/* Default State (Not Recitation Mode): */
/* Hide the Previous/Next buttons */
.btn-nav-recitation {
    display: none;
}
/* Show the Random button */
#btn-random {
    display: flex;
    background-color: #9b59b6; /* Purple color for distinction */
}

/* Recitation Mode Active: */
/* When body has class 'recitation-active-mode' */
.recitation-active-mode .btn-nav-recitation {
    display: flex; /* Show Prev/Next */
}
.recitation-active-mode #btn-random {
    display: none; /* Hide Random to make room */
}
/* --- RECITAION DASHBOARD & SLIDER --- */

/* Container for the boxes */
#recitation-dashboard {
    display: none; /* Hidden by default */
    width: 90%;
    max-width: 800px;
    background-color: var(--box-bg);
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
    border: 1px solid var(--box-border);
    animation: fadeIn 0.5s;
}
/* Tablet/Desktop scale */
@media (min-width: 768px) {
    #recitation-dashboard { width: 96%; }
}
/* Recitation active? Show dashboard */
.recitation-active-mode #recitation-dashboard {
    display: block;
}

/* The Grid of Boxes */
.dashboard-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    justify-content: center;
    margin-bottom: 15px;
}

.progress-box {
    width: 40px;
    height: 40px;
    border-radius: 4px;
    background-color: #ebedf0; /* Default empty */
    border: 1px solid #ccc;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    color: #555;
    transition: transform 0.1s;
	-webkit-user-select: none; /* Safari / Chrome */
    -moz-user-select: none;    /* Firefox */
    -ms-user-select: none;     /* IE 10+ */
    user-select: none;         /* Standard */
    
    -webkit-touch-callout: none; /* iOS Safari: Disables the system menu */
    -webkit-tap-highlight-color: transparent; /* Removes the blue flash on tap */
}

[data-theme="dark"] .progress-box {
    background-color: #2d333b;
    border-color: #444;
    color: #aaa;
}

.progress-box:hover { transform: scale(1.15); border-color: #888; }
.progress-box.active-box { border: 2px solid var(--highlight-color); transform: scale(1.1); }

/* Heatmap Colors (GitHub style Green) */
.heatmap-0 { background-color: #ebedf0; }
.heatmap-1 { background-color: #9be9a8; color: #222; } /* 1-25% */
.heatmap-2 { background-color: #40c463; color: #fff; } /* 26-50% */
.heatmap-3 { background-color: #30a14e; color: #fff; } /* 51-75% */
.heatmap-4 { background-color: #216e39; color: #fff; } /* 76-100% */

/* Dark mode overrides for colors */
[data-theme="dark"] .heatmap-0 { background-color: #2d333b; }
[data-theme="dark"] .heatmap-1 { background-color: #0e4429; color: #ccc; }
[data-theme="dark"] .heatmap-2 { background-color: #006d32; }
[data-theme="dark"] .heatmap-3 { background-color: #26a641; }
[data-theme="dark"] .heatmap-4 { background-color: #39d353; color: #000; }

/* Progress Bars Area */
.dashboard-stats {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.progress-bar-container {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 13px;
}

.progress-track {
    flex-grow: 1;
    height: 8px;
   background-color: rgba(0, 0, 0, 0.1); /* Visible track */
    border-radius: 4px;
    overflow: hidden;
	border: 1px solid rgba(0, 0, 0, 0.2);
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
}

[data-theme="dark"] .progress-track {
    background-color: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.2);
}

.progress-fill {
    height: 100%;
    background-color: var(--primary-color);
    width: 0%;
    transition: width 0.3s ease;
}

/* --- CHECKBOX UNDER SENTENCE --- */
.memorize-slider-container {
    margin-top: 15px;
    padding-top: 10px;
    border-top: 1px dashed var(--primary-color);
    text-align: center;
    animation: fadeIn 0.3s;
    display: flex;           /* Flexbox to center content */
    justify-content: center;
    align-items: center;
}

/* Label styling for the checkbox */
.memorize-checkbox-label {
    font-size: 16px;
    font-weight: bold;
    color: var(--highlight-color);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;               /* Space between box and text */
    user-select: none;       /* Prevent text selection on click */
}

/* The actual checkbox styling */
.memorize-checkbox {
    width: 20px;
    height: 20px;
    cursor: pointer;
    accent-color: var(--highlight-color); /* Uses your theme color (Orange/Yellow) */
}
/* --- BUTTON VISIBILITY LOGIC --- */
        
        /* 1. Default State (Normal Mode) */
        #btn-loop, #btn-exit-recitation, .btn-nav-recitation { 
            display: none; 
        }
        #btn-dictionary, #btn-english-toggle, #btn-random { 
            display: flex; 
        }

        /* 2. Recitation Mode Active */
        .recitation-active-mode #btn-loop,
        .recitation-active-mode #btn-exit-recitation,
        .recitation-active-mode .btn-nav-recitation {
            display: flex; /* Show these */
        }

        .recitation-active-mode #btn-dictionary,
        .recitation-active-mode #btn-english-toggle,
        .recitation-active-mode #btn-random {
            display: none; /* Hide these to save space */
        }
        
        /* Loop Button Active State */
       #btn-loop.active-loop {
    background-color: #9b59b6 !important; /* Gold/Orange */
    color: #fff;
    box-shadow: 0 0 8px rgba(243, 156, 18, 0.6);
    border: 1px solid #fff;
}

/* --- MULTI-LOOP SELECTION STYLE --- */
.progress-box.multi-loop-selected {
    border: 2px solid #e74c3c !important; /* Red Border */
    box-shadow: 0 0 6px rgba(231, 76, 60, 0.6);
    background-color: rgba(231, 76, 60, 0.1);
    transform: scale(1.05);
    z-index: 5; /* Ensure it sits above others */
}

/* Dark mode adjustment */
[data-theme="dark"] .progress-box.multi-loop-selected {
    border-color: #ff6b6b !important;
    background-color: rgba(255, 107, 107, 0.2);
}

/* --- ACHIEVEMENT BANNER (SECTION LEVEL) --- */
#section-achievement-banner {
    display: none;
    background: #fffdf0; /* Màu giấy chứng chỉ nhẹ */
    color: #5d4037;
    width: 90%;
    max-width: 800px;
    text-align: center;
    padding: 15px;
    border-radius: 4px;
    margin-bottom: 20px;
    /* Viền kép tạo nét cổ điển trang trọng */
    border: 4px double #FDB931; 
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    animation: slideDown 0.5s ease-out;
    position: relative;
	
}
@media (min-width: 768px) {
    #section-achievement-banner { width: 96%; }
}
[data-theme="dark"] #section-achievement-banner {
    background-color: #2d2d2d;
    color: #fff;
    border-color: #d4a373;
}
#section-achievement-banner h3 {
    color: #b35900;
    font-family: "Times New Roman", serif;
    font-size: 18px;
    margin: 0;
    text-transform: uppercase;
}
[data-theme="dark"] #section-achievement-banner h3 {
    color: #e67300;
}


/* --- GRAND ACHIEVEMENT MODAL (GLOBAL LEVEL) --- */
.modal-overlay {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.85);
    z-index: 9999;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    backdrop-filter: blur(5px);
    animation: fadeIn 0.5s;
}

.modal-content {
    background: #fff;
    background-image: url('./images/imgbk.png');
    padding: 20px; /* Reduced slightly for mobile comfort */
    border-radius: 15px;
    text-align: center;
    
    /* FIX STARTS HERE */
    box-sizing: border-box;     /* Includes padding/border in the width calculation */
    width: 90%;                /* Takes up 90% of screen width on small devices */
    max-width: 400px;          /* Won't grow larger than 400px on tablets/PC */
    /* FIX ENDS HERE */

    border: 4px solid #FDB931;
    box-shadow: 0 0 30px rgba(253, 185, 49, 0.6);
    position: relative;
    animation: popIn 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
}

[data-theme="dark"] .modal-content {
    background-color: #2d2d2d;
    color: #fff;
    border-color: #d4a373;
}

.medal-icon {
    font-size: 80px;
    color: #e39802;
    margin-bottom: 20px;
    filter: drop-shadow(0 0 10px rgba(253, 185, 49, 0.8));
    animation: floatMedal 3s ease-in-out infinite;
}
[data-theme="dark"] .modal-icon { color: #FDB931;}

.modal-title {
    font-size: 24px;
    color: #d35400;
    margin-bottom: 10px;
    font-weight: bold;
    text-transform: uppercase;
}
[data-theme="dark"] .modal-title { color: #f39c12; }

.modal-text {
    font-size: 16px;
    margin-bottom: 25px;
    line-height: 1.5;
}

.btn-close-modal {
    background: #d35400;
    color: white;
    border: none;
    padding: 10px 25px;
    font-size: 16px;
    border-radius: 25px;
    cursor: pointer;
    transition: transform 0.2s;
    font-weight: bold;
}
.btn-close-modal:hover { transform: scale(1.05); background: #e67e22; }

/* Animations */
@keyframes shimmer {
    0% { left: -100%; }
    100% { left: 200%; }
}
@keyframes slideDown {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
}
@keyframes popIn {
    0% { opacity: 0; transform: scale(0.5); }
    100% { opacity: 1; transform: scale(1); }
}
@keyframes floatMedal {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

/* --- SECTION TITLE & INFO ICON LAYOUT --- */
.section-header-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 7px;
    margin: 5px 0 15px 0;
}

#section-title {
    margin: 0; /* Reset margin since wrapper handles it */
}

.btn-info-icon {
    font-size: 15px;
    color: var(--primary-color);
    cursor: pointer;
    transition: transform 0.2s, color 0.2s;
    display: none; /* Hidden by default until JS enables it */
	vertical-align: middle;      /* Aligns to the middle of the text line */
    line-height: 1;              /* Removes extra spacing around the icon */
    position: relative;          /* Allows for micro-adjustments */
    top: 2px;                   /* Manually nudge it down if it still looks 'high' */
}

.btn-info-icon:hover {
    transform: scale(1.1);
    color: var(--highlight-color);
}
.simple-modal-overlay {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.6); /* Simple dark dim */
    z-index: 10000; /* Very high z-index */
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(2px); /* Slight blur, not too heavy */
}

.simple-modal-content {
    background-color: var(--bg-color); /* Matches theme */
    background-image: url('./images/imgbk.png'); /* Keeps texture if you want, or remove */
    color: var(--text-color);
    width: 90%;
    max-width: 650px;
    max-height: 85vh;
    border-radius: 8px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    position: relative; /* For absolute positioning of X button */
    display: flex;
    flex-direction: column;
    border: 1px solid var(--box-border);
}

/* Header Area */
.simple-modal-header {
    padding: 15px 20px;
    border-bottom: 1px solid var(--box-border);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.simple-modal-header h3 {
    margin: 0;
    color: var(--primary-color);
    font-size: 20px;
}

/* The X Close Icon */
.btn-close-simple {
    background: none;
    border: none;
    font-size: 24px;
    color: var(--text-color);
    cursor: pointer;
    padding: 0;
    line-height: 1;
    opacity: 0.7;
    transition: opacity 0.2s;
}

.btn-close-simple:hover {
    opacity: 1;
    color: var(--highlight-color);
}

/* Scrollable Body */
.simple-modal-body {
    padding: 20px;
    overflow-y: auto;
    line-height: 1.6;
    font-size: 16px;
}

/* Scrollbar styling */
.simple-modal-body::-webkit-scrollbar { width: 8px; }
.simple-modal-body::-webkit-scrollbar-track { background: rgba(0,0,0,0.05); }
.simple-modal-body::-webkit-scrollbar-thumb { background: #999; border-radius: 4px; }

/* Content specific styling */
.simple-modal-body h4 {
    color: var(--highlight-color);
    border-bottom: 1px dashed #ccc;
    padding-bottom: 5px;
    margin-top: 3px;
    margin-bottom: 15px;
}
.simple-modal-body ul { padding-left: 20px; }
.simple-modal-body li { margin-bottom: 10px; }

/* Dark mode tweaks */
[data-theme="dark"] .simple-modal-content {
    background-color: #2d2d2d;
    border-color: #555;
}
    </style>
</head>
<body>

<div class="container" id="main-container">
<div class="top-nav">
    <button class="btn-darkmode" onclick="toggleTheme()"><i class="fas fa-moon"></i></button> 
    

        
         <div class="nav-controls">
            <button class="btn-nav" onclick="changeSection(-1)"><i class="fas fa-angle-left"></i></button>
            <select id="section-select" onchange="selectSection()"></select>
            <button class="btn-nav" onclick="changeSection(1)"><i class="fas fa-angle-right"></i></button>
	    <div id="top-right-controls" style="display: flex; gap: 3px; align-items: center;">
        
        <button id="help-toggle" class="btn-nav" style="text-align: center; " aria-expanded="false" title="Trợ giúp"><i class="fas fa-circle-info"></i></button>	
        </div>
    </div>
</div>

<div id="section-achievement-banner">
    <h3>
        <i class="fas fa-wreath-laurel"></i> 
        Hộ Trì Pháp Bảo
        <i class="fas fa-wreath-laurel"></i>
    </h3>
    <div style="font-size:12px; margin-top:5px;">Chứng Nhận Thành Tựu Học&nbsp;Thuộc&nbsp;Lòng Kinh&nbsp;Hộ&nbsp;Trì&nbsp;Paritta</div>
</div>
<div id="help-container" style="display: none; padding: 20px; background-color: var(--box-bg); border: 1px solid var(--box-border); margin-bottom: 15px; border-radius: 8px;">
    
    <h3>Kinh Hộ Trì Paritta</h3>
    <p>Đây là ứng dụng & công cụ được thiết kế để hỗ trợ các hành giả trong việc nghe, học, và tụng trì hàng ngày Kinh Hộ Trì Paritta. Ứng dụng có tính năng đồng bộ văn bản với âm thanh cho phép thực hành tụng đọc theo chính xác, đồng thời bao gồm các bài tập ghi nhớ bằng cách ẩn ngẫu nhiên các từ, và một bảng điều khiển tương tác để theo dõi tiến độ học thuộc.</p>

    <h4><i class="fas fa-book-open-reader"></i> Hướng Dẫn</h4>
    
    <h4>1. Điều Hướng & Cơ Bản</h4>
    <ul>
        <li><b>Giao Diện (<i class="fas fa-moon"></i>/<i class="fas fa-sun-bright"></i>):</b> Chuyển đổi giữa Chế độ Sáng và Tối.</li>
        <li><b>Chọn Mục:</b> Sử dụng menu thả xuống để chuyển đến một bài kinh cụ thể (ví dụ: Maṅgalasutta, Mettasutta)</li>
        <li><b>Ngẫu Nhiên (<i class="far fa-dharmachakra"></i>):</b> Chuyển đến một bài kinh bất kỳ.</li>
        <li><b>Từ Điển (<i class="fas fa-book-open"></i>):</b> Bật để tra cứu Pāli. Di chuột qua từ để xem nghĩa.</li>
    </ul>

    <h4>2. Chế Độ Tụng Đọc (<i class="fas fa-microphone"></i>)</h4>
    <p>Nhấn nút Micro để vào Chế độ Tụng Đọc. Chữ sẽ phóng to và chạy theo âm thanh.</p>
    <ul>
        <li><b>Trạng thái:</b> Xanh Lá = Tự động chạy; Xanh Dương = Tạm dừng/Thủ công.</li>
        <li><b>Điều hướng:</b> Dùng <b>«</b> và <b>»</b> để nhảy dòng.</li>
    </ul>

    <h4>3. Chế Độ Lặp (Ôn Luyện)</h4>
    <ul>
        <li><b>Lặp Một Câu:</b> Nhấn nút Lặp (<i class="fas fa-arrows-repeat"></i>) trên thanh điều khiển để lặp lại câu hiện tại liên tục.</li>
        <li><b>Lặp Nhiều Câu (Tùy Chọn):</b> 
            <ul>
                <li>Trên <b>Lưới Tiến Độ</b> (các ô số màu), <b>Nhấn Giữ</b> vào một ô để chọn. Ô sẽ chuyển sang viền Đỏ.</li>
                <li>Chọn nhiều ô để tạo vòng lặp tùy chỉnh (ví dụ: ôn một đoạn khó). Trình phát sẽ chỉ lặp qua các câu đã chọn.</li>
                <li>Nhấn giữ lần nữa để bỏ chọn.</li>
            </ul>
        </li>
		<li><b>Lặp Mặc Định:</b> Khi không ấn vào, nút Lặp sẽ phát lại toàn bộ mục hiện tại.</li>
    </ul>

    <h4>4. Bảng Tiến Độ & Ghi Nhớ</h4>
    <p>Nằm phía trên văn bản khi ở Chế độ Tụng Đọc, bảng này giúp trực quan hóa mức độ thông thuộc của bạn.</p>
    <ul>
        <li><b>Lưới Màu:</b> Mỗi ô vuông đại diện cho một dòng.
            <ul>
                <li><b>Xám:</b> Chưa thuộc.</li>
                <li><b>Xanh:</b> Đã thuộc.</li>
            </ul>
        </li>
        <li><b>Đánh Dấu:</b> Khi dòng đang chạy, ô chọn <b>"Đã thuộc"</b> sẽ hiện dưới văn bản. Đánh dấu vào đó để xác nhận đã thuộc (100%).</li>
        <li><b>Thống Kê:</b>
            <ul>
                <li><b>Đã thuộc phần này:</b> % hoàn thành của bài kinh hiện tại.</li>
                <li><b>Đã thuộc tất cả:</b> % hoàn thành của toàn bộ các Kinh Hộ Trì.</li>
            </ul>
        </li>
        <li><b>Thành Tựu:</b> Bạn sẽ nhận Biểu ngữ "Hộ Trì Học Pháp" khi thuộc xong một bài kinh, và Huy chương "Bậc Hộ Trì Pháp" khi thuộc toàn bộ.</li>
    </ul>

    <h4>5. Cài Đặt (<i class="fas fa-gear"></i>)</h4>
    <ul>
        <li><b>Ẩn Chữ:</b> Kéo thanh trượt để ẩn ngẫu nhiên các từ (10%-90%) để kiểm tra trí nhớ. Nhấn vào ô trống để hiện từ.</li>
        <li><b>Tốc Độ (<i class="far fa-clock"></i>):</b> Ghi đè thời gian mặc định (ví dụ: cố định 5 giây/dòng) dùng cho việc thực hành tụng đọc ở tốc độ ổn định, chậm hơn hoặc nhanh hơn mà không cần đồng bộ âm thanh.</li>
    </ul>

    <h4><i class="fas fa-floppy-disk"></i> Sử Dụng Ngoại Tuyến</h4>
    <p>
        Tải xuống tệp Apk cho Android, tệp Zip cho PC, hoặc tệp ZIM cho Kiwix.
        (Tìm hiểu thêm về Kiwix: <a href="https://kiwix.org/en/" target="_blank">kiwix.org</a>).
    </p>
    <p>Tải xuống & Mã Nguồn: <a href="https://github.com/buddhanussati/paritta-chanting"><b>tại đây.</b></a></p>

    <h4><i class="fas fa-scale-balanced"></i>&nbsp;&nbsp;Giấy Phép</h4>
    <p>
        Cấp phép theo <a href="https://creativecommons.org/licenses/by-nc/4.0/legalcode" target="_blank">CC BY-NC 4.0</a>.
        Được phép Chia sẻ và Chuyển thể cho mục đích <b>phi thương mại</b>.
    </p>
</div>
	<div id="recitation-dashboard">
    <div id="dashboard-grid" class="dashboard-grid">
        </div>
    <div class="dashboard-stats">
        <div class="progress-bar-container">
            <span style="width: 120px; font-size: 12px;">Đã thuộc phần này:</span>
            <div class="progress-track"><div id="bar-session" class="progress-fill" style="background-color: #3498db;"></div></div>
            <span id="text-session" style="font-size: 12px;">0%</span>
        </div>
        <div class="progress-bar-container">
            <span style="width: 120px; font-size: 12px;">Đã thuộc tất cả:</span>
            <div class="progress-track"><div id="bar-total" class="progress-fill" style="background-color: #27ae60;"></div></div>
            <span id="text-total" style="font-size: 12px;">0%</span>
        </div>
    </div>
</div>
   <div class="section-header-wrapper">
        <h2 id="section-title">Đang tải...</h2>
        <i id="btn-section-info" class="fas fa-circle-info btn-info-icon" onclick="showSectionInfo()" title="Về kinh này"></i>
    </div>
    
    <h2 id="section-title-vn" style="font-weight: normal; font-size: 18px; margin-top: 0; opacity: 0.9;"></h2>
    <div id="display-area" class="text-content"></div>
</div>


<div class="bottom-bar">
    <div class="bar-main-row">
        <audio id="audioPlayer" controls>Trình duyệt không hỗ trợ audio.</audio>

    <div class="controls-cluster">         
	        <button id="btn-dictionary" class="icon-btn" onclick="togglePaliLookup()" title="Từ điển Pali"><i class="fas fa-book-open"></i></button>
            <button id="settings-btn" class="icon-btn btn-settings" onclick="toggleSettings()" title="Cài đặt"><i class="fas fa-gear"></i></button>
		    <button id="btn-exit-recitation" class="icon-btn" onclick="exitRecitation()" title="Thoát Tụng Đọc"><i class="fas fa-xmark"></i></button>
			<button id="btn-loop" class="icon-btn" onclick="toggleLoopSentence()" title="Lặp câu hiện tại">
   <i class="fas fa-arrows-repeat"></i>
</button>
            <button id="recitation-toggle-btn" class="icon-btn btn-recitation" onclick="toggleRecitationAction()" title="Tụng Đọc"><i class="fas fa-microphone"></i></button>
			<button id="btn-random" class="icon-btn" onclick="randomSection()" title="Học giới ngẫu nhiên">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
            <circle cx="12" cy="12" r="9"></circle>
            <circle cx="12" cy="12" r="2.5"></circle>
            <line x1="12" y1="3" x2="12" y2="9.5"></line>   <line x1="12" y1="14.5" x2="12" y2="21"></line> <line x1="3" y1="12" x2="9.5" y2="12"></line>   <line x1="14.5" y1="12" x2="21" y2="12"></line> <line x1="5.64" y1="5.64" x2="10.23" y2="10.23"></line> <line x1="13.77" y1="13.77" x2="18.36" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="13.77" y2="10.23"></line>
            <line x1="10.23" y1="13.77" x2="5.64" y2="18.36"></line>
        </svg>
    </button>
	        <button id="btn-viet-toggle" class="icon-btn" onclick="toggleVietnamese()" title="Hiển thị bản dịch">VI</button>
			<button class="icon-btn btn-nav-recitation" onclick="navigateRecitation(-1)" title="Lùi"><i class="fas fa-angles-left"></i></button>
            <button class="icon-btn btn-nav-recitation" onclick="navigateRecitation(1)" title="Tiến"><i class="fas fa-angles-right"></i></button>
        </div>
    </div>

    <div id="settings-panel" class="settings-panel">
        <div class="settings-content">
            <div class="setting-group">
                <span style="font-size:13px; font-weight:600">Ẩn chữ:</span>
                <input type="range" id="difficulty" min="10" max="90" value="40" oninput="updateLabel(this.value)" style="width:80px">
                <span id="difficulty-label" style="font-size:12px">40%</span>
                <button class="btn-sm" onclick="hideRandomWords()" style="background:#d35400; color:white;">Ẩn</button>
                <button class="btn-sm" onclick="resetText(true)" style="background:#7f8c8d; color:white;">Hiện</button>
            </div>

            <div class="setting-group">
                <span style="font-size:13px; font-weight:600">Tốc độ:</span>
                
                <button id="btn-show-speed" class="btn-sm" onclick="toggleSpeedControl()" style="background:#2980b9; color:white;"><i class="far fa-clock"></i></button>

                <div id="speed-control-area" style="display:none; align-items:center; gap:5px;">
                    <input type="range" id="recitation-interval" min="1" max="10" step="0.5" value="3" oninput="updateRecitationInterval(this.value)" style="width:80px">
                    <span id="recitation-interval-label" style="font-size:12px">3.0s</span>
                    <button class="btn-sm" onclick="resetSpeedDefault()" style="background:#6a4c93; color:white;" title="Huỷ tuỳ chỉnh, dùng thời gian gốc">Về mặc định</button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="simple-info-modal" class="simple-modal-overlay">
    <div class="simple-modal-content">
        <div class="simple-modal-header">
            <h3 id="simple-modal-title">Sutta Info</h3>
            <button class="btn-close-simple" onclick="closeSimpleInfoModal()"><i class="fas fa-times"></i></button>
        </div>
        <div id="simple-modal-body" class="simple-modal-body">
            </div>
    </div>
</div>
<div id="grand-achievement-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="medal-icon">
            <i class="far fa-wreath-laurel"></i>
        </div>
        
        <div class="modal-title">Bậc Hộ Trì Pháp</div>
        
        <p class="modal-text">
            Chứng Nhận Thành Tựu Học&nbsp;Thuộc&nbsp;Lòng <b>Kinh&nbsp;Hộ&nbsp;Trì&nbsp;Paritta</b><br>
            
            <span style="display: block; color: #b35900; font-weight: 600; font-style: italic; margin-top: 15px;">
        "Ðệ tử Gotama<br>
        Luôn luôn tự tỉnh giác,<br>
        Vô luận ngày hay đêm,<br>
        Tưởng Chánh Pháp thường niệm."
    </span>
        </p>
        
        <button class="btn-close-modal" onclick="closeAchievementModal()">Sādhu! Lành thay!</button>
    </div>
</div>
<script>
/* =========================================
   FULL PALI LOOKUP INTEGRATION
   ========================================= */

// Flag to satisfy the check in lookupWordHandler
window.paliDictionary = true;
var isLookupEnabled = false;
// Thêm biến Timer để quản lý độ trễ cho sự kiện mouseenter
var lookupTimer = null; 
// Mặc định: Độ trễ 100ms
const LOOKUP_DELAY_MS = 100; 

function togglePaliLookup() {
    isLookupEnabled = !isLookupEnabled;
    const btn = document.getElementById('btn-dictionary');
    
    // --- SAVE TO LOCAL STORAGE ---
    localStorage.setItem('dictionaryEnabled', isLookupEnabled);

    if (isLookupEnabled) {
        btn.style.backgroundColor = "#d35400"; // Active color (Orange)
        enablePaliLookup();
    } else {
        btn.style.backgroundColor = ""; // Default color
        disablePaliLookup();
    }
}

function enablePaliLookup() {
    // 1. Add visual indicator
    $('.word').addClass('lookup-active');
    
    // 2. Gỡ bỏ các event handler cũ
    $(document).off('mouseenter', '.word'); 
    $(document).off('mouseleave', '.word'); 

    // MOUSEENTER: Thiết lập độ trễ (delay)
    $(document).on('mouseenter', '.word', function() {
        var $word = $(this);
        // Xóa bất kỳ timer nào đang chạy từ các từ khác
        if (lookupTimer) {
            clearTimeout(lookupTimer);
        }
        
        // Thiết lập timer mới
        lookupTimer = setTimeout(function() {
            // Chỉ hiển thị popup nếu con trỏ vẫn còn trên từ
            if ($word.is(':hover')) {
                // Dùng .call() để đảm bảo 'this' trong lookupWordHandler là phần tử DOM hiện tại
                lookupWordHandler.call($word[0]); 
            }
            lookupTimer = null; // Reset timer sau khi chạy
        }, LOOKUP_DELAY_MS); 
    });
    
    // MOUSELEAVE: Xóa timer và tắt popup ngay lập tức
    $(document).on('mouseleave', '.word', function() {
        // 1. Xóa timer hiện popup đang chờ (nếu có)
        if (lookupTimer) {
            clearTimeout(lookupTimer);
            lookupTimer = null;
        }
        
        // 2. Xóa popup đang hiển thị (nếu có)
        $(this).find('span.meaning').remove();
    });
}

function disablePaliLookup() {
    // Đảm bảo xóa timer nếu nó đang chạy khi tắt tính năng
    if (lookupTimer) {
        clearTimeout(lookupTimer);
        lookupTimer = null;
    }
    $('.word').removeClass('lookup-active');
    $(document).off('mouseenter', '.word');
    $(document).off('mouseleave', '.word');
    $('.meaning').remove();
}

/* --- CORE HANDLER (Adapted from pali-lookup-standalone.js) --- */
function lookupWordHandler(event) {
    if (!window.paliDictionary) return;
    if ($(this).children().is("span.meaning")) return;

    // Get text
    var rawText = $(this).text();
    var word = rawText.toLowerCase().trim();

    // --- CRITICAL FIX: Remove punctuation from edges ---
    // The original script split text by punctuation. Since your HTML 
    // includes punctuation in the span (e.g., "dhammo,"), we must strip it here.
    word = word.replace(/^[“‘"(\[]+|[”’"),‚.\]?!:–;]+$/g, '');

    // Standard replacements from original script
    word = word.replace(/­/g, ''); // optional hyphen
    // Fix specific Pali spelling variations handled in original script
    word = word.replace(/ṁg/g, 'ṅg')
               .replace(/ṁk/g, 'ṅk')
               .replace(/ṁ/g, 'ṁ'); // (Original had this, keeping for safety)

    // Perform Lookup
    var meaning = lookupWord(word, rawText); // Pass rawText for display title
    
    if (meaning) {
        var textBox = $('<span class="meaning">' + meaning + '</span>');
        $(this).append(textBox);
        
        // Prevent popup from going off-screen (Right edge detection)
        var offset = $(this).offset();
        var width = 300; // approx max width
        if (offset.left + width > $(window).width()) {
             textBox.css({left: 'auto', right: 0});
        }
    }
}

/* --- LOOKUP LOGIC (Exact copy of logic from pali-lookup-standalone.js) --- */
function lookupWord(word, displayTitle) {
    // Safety check for data
    if (typeof dpd_i2h === 'undefined') {
        console.warn("Pali Data (dpd_i2h) not loaded!");
        return "<i>Dictionary data not found.<br>Please check console.</i>";
    }

    let out = "";
    
    // Logic from original: replace quotes and normalize 'ṁ' to 'ṃ' for dictionary keys
    const originalWord = word;
    var lookupKey = word.replace(/[’”'"]/g, "").replace(/ṁ/g, "ṃ");

    // 1. Dictionary Lookup (dpd_i2h)
    if (lookupKey in dpd_i2h) {
        out += `<strong>${originalWord}</strong>`;
        out += `<ul style="line-height: 1.4em; padding-left: 15px; margin-top: 4px; list-style: disc inside;">`;
        
        for (const headword of dpd_i2h[lookupKey]) {
            if (headword in dpd_ebts) {
                // Formatting logic from original script
                const match = headword.match(/^(.+?)\s(\d[\d.]*)$/);
                let formattedHeadword;
                if (match) {
                    const wordPart = match[1].trim();
                    const numberPart = match[2];
                    formattedHeadword = `${wordPart}<sub style="font-size:60%; font-weight:bold;">${numberPart}</sub>`;
                } else {
                    formattedHeadword = headword;
                }
                out += `<li><b>${formattedHeadword}</b>: ${dpd_ebts[headword]}</li>`;
            }
        }
        out += "</ul>";
    }

    // 2. Deconstructor Lookup (dpd_deconstructor)
    if (typeof dpd_deconstructor !== 'undefined' && lookupKey in dpd_deconstructor) {
        if(out === "") out += `<strong>${originalWord}</strong><br>`; // Header if not already added
        out += `<div style="margin-top:8px; border-top:1px solid #555; padding-top:4px;">
                <small style="color:#aaa"></small>
                ${dpd_deconstructor[lookupKey]}
                </div>`;
    }

    return out === "" ? null : out.replace(/ṁ/g, "ṃ");
}
</script>
<script>
    const introContent = `
        <h4>DẪN NHẬP</h4>
        <p><i><b>“Uggaṇhātha, bhikkhave, āṭānāṭiyaṃ rakkhaṃ. Pariyāpuṇātha, bhikkhave, āṭānāṭiyaṃ rakkhaṃ. Dhāretha, bhikkhave, āṭānāṭiyaṃ rakkhaṃ. Atthasaṃhitā, bhikkhave, āṭānāṭiyā rakkhā bhikkhūnaṃ bhikkhunīnaṃ upāsakṃnaṃ upāsikānaṃ guttiyā rakkhāya avihiṃsāya phāsuvihārāyā”ti.</b></i> (Trích Trường Bộ Kinh 32).</p>
        
        <p><i>“Này các Tỷ-kheo, hãy học Hộ Kinh Āṭānāṭiya này, hãy thuộc lòng Kinh Āṭānāṭiya này. Này các Tỷ-kheo, Tỷ-kheo-ni, Nam cư sĩ, Nữ cư sĩ được che chở, được hộ trì, được ngăn khỏi bị làm hại, được sống thoải mái hạnh phúc.”</i></p>
        
        <p>Với những lời này, Đức Phật đã khuyến khích các hàng đệ tử học tập kinh hộ trì Āṭānāṭiya để tự bảo vệ mình, và từ đó bắt đầu truyền thống tụng đọc các bài Kinh để cầu sự bảo vệ và những kết quả tốt lành. Các bài Kinh được tụng để bảo vệ còn được gọi là Kinh Hộ Trì hay ‘Paritta’, nghĩa là “bài Kinh bảo vệ những người tụng và người nghe khỏi những nguy hiểm, tai họa, v.v., từ khắp xung quanh.” Trải qua các thời đại, các bài Kinh khác đã được thêm vào danh sách ‘Các Kinh để tụng’. Như trong bộ Milindapañha (Mi Tiên Vấn Đáp) và các Chú giải của Ngài Buddhaghosa, có chín bài Kinh được nhắc đến như là Kinh Hộ Trì: Ratanasutta, Mettāsutta, Khandhasutta, Morasutta, Dhajaggasutta, Āṭānāṭiyasutta, Aṅgulimālasutta, Bojhaṅgasutta và Isigilisutta.</p>
        
        <p>Tập kinh trình bày ở đây bao gồm tám bài Kinh đầu tiên và thêm vào đó là cá kinh Maṅgalasutta, Vaṭṭasutta và Pubbaṇhasutta, tổng cộng gồm 11 bài Kinh, cùng với các câu kệ mở đầu cho mỗi bài. Đây là 11 bài Kinh được tụng hàng ngày tại mọi tu viện, chùa chiền và tại nhà của các cư sĩ ở tất cả các quốc gia Phật giáo Theravāda (Phật giáo Nguyên thủy). Bộ sưu tập này được biết đến ở Myanmar với tên gọi ‘Đại Hộ Kinh’, không phải vì các bài Kinh trong đó dài, mà có lẽ vì chúng có sức mạnh to lớn, nếu được trì tụng và lắng nghe đúng đắn, có thể xua tan nguy hiểm và mang lại những kết quả nhiệm màu.</p>
        
        <h4>CÁCH TRÌ TỤNG VÀ LẮNG NGHE KINH</h4>
        <p>Vì các bài Kinh Hộ Trì Paritta này nhằm mục đích bảo vệ và mang lại các kết quả tốt đẹp khác, điều quan trọng là chúng phải được tụng và nghe một cách chính xác. Có một số điều kiện cần được thực hiện bởi cả người tụng và người nghe để nhận được trọn vẹn lợi ích của Kinh Paritta. Cụ thể, có ba điều kiện cho người tụng đọc và ba điều kiện cho người lắng nghe:</p>
        
        <b>Ba điều kiện đối với người tụng đọc:</b>
        <ol>
            <li>Họ phải học và tụng các bài Kinh một cách chính xác và đầy đủ, không được bỏ sót.</li>
            <li>Họ phải hiểu ý nghĩa của các bài Kinh đang được tụng.</li>
            <li>Họ phải tụng với tâm tràn đầy lòng hoan hỷ và từ tâm.</li>
        </ol>
        
        <b>Ba điều kiện đối với người nghe:</b>
        <ol>
            <li>Họ phải không phạm vào ngũ nghịch đại tội: giết cha, giết mẹ, giết bậc A-la-hán, làm thân Phật chảy máu, và làm chia rẽ Tăng đoàn.</li>
            <li>Họ phải không có ‘tà kiến cố định’ (tà kiến bác bỏ nghiệp và quả của nghiệp).</li>
            <li>Họ phải lắng nghe với niềm tin vào hiệu năng của các bài Kinh trong việc ngăn chặn nguy hiểm và mang lại kết quả tốt lành. (Khi mọi người nghe với niềm tin, họ sẽ nghe với sự tôn trọng và chú tâm).</li>
        </ol>
        
        <p>Chỉ khi các điều kiện này được đáp ứng, mọi người mới nhận được đầy đủ lợi ích từ các bài Kinh Paritta. Do đó, điều quan trọng là khi Kinh đang được tụng, mọi người nên lắng nghe với chú ý, tín tâm và sự tôn trọng. Hơn nữa, việc tụng Kinh Paritta là một hành động phát sanh 2 lợi íc. Người tụng giống như người cho đi, và người nghe giống như người nhận; nếu không nhận những gì được cho, họ sẽ không có được món đồ đó. Tương tự như vậy, nếu mọi người không lắng nghe mà lại làm việc khác trong khi người khác tụng, họ chắc chắn sẽ không nhận được lợi ích của việc tụng Kinh.</p>
        
        <h4>NGUỒN TRÍCH DẪN</h4>
        <p>Ngoại trừ các câu kệ mở đầu, các bài Kinh được tìm thấy trong Tam Tạng (Piṭaka) như sau:<br>
        <small>(Số tham chiếu là số trang của Ấn bản Đại hội Kết tập Kinh điển lần thứ VI, ngoại trừ Jātaka (Bổn sanh) được ghi theo số thứ tự của các chuyện Tiền thân).</small></p>
        
        <ul>
            <li><b>Phần mở đầu (Parikamma)</b> => do các nhà kết tập biên soạn.</li>
            <li><b>1. Maṅgalasutta</b> => Khuddakapāṭha, 3-4; Suttanipāta, 308-9.</li>
            
            <li><b>2. Ratatasutta</b><br>
            Đoạn dẫn nhập => Dhammapada Aṭṭhakathā, ii. 272,<br>
            Hai câu kệ tiếp theo => do các nhà kết tập biên soạn,<br>
            Nội dung còn lại => Khuddakapāṭha, 4-7; Suttanipāta, 312-5.</li>
            
            <li><b>3. Mettāsutta</b> => Khuddakapāṭha, 10-12; Suttanipāta, 300-1.</li>
            <li><b>4. Khandhasutta</b> => Vinaya. iv. 245; Aṅguttaranikāya, i. 384; Jātaka số 203.</li>
            <li><b>5. Morasutta</b> => Jātaka số 159.</li>
            <li><b>6. Vaṭṭasutta</b> => Cariyapiṭaka, 415.</li>
            <li><b>7. Dhajaggasutta</b> => Saṃyuttanikāya, i. 220-2.</li>
            
            <li><b>8. Āṭānāṭiyasutta</b><br>
            Các câu kệ 104-109 => Dīghanikāya, iii. 159.<br>
            Các câu kệ 102, 103, 110-130 => do các nhà kết tập biên soạn.<br>
            Câu kệ 131 => Kinh Pháp Cú (Dhammapada), câu 109.</li>
            
            <li><b>9. Aṅgulimālasutta</b> => Majjhimanikāya, ii. 306.</li>
            
            <li><b>10. Bojjhaṅgasutta</b><br>
            Các bài Kinh gốc => Saṃyuttanikāya, iii. 71, 72, 73.<br>
            Các câu kệ ở đây => do các nhà kết tập biên soạn.</li>
            
            <li><b>11. Pubbaṇhasutta</b><br>
            Câu kệ 153 => Khuddakapāṭha, 5; Suttanipāta, 312.<br>
            Các câu kệ 162-4 => Aṅguttaranikāya, i. 299.<br>
            Phần còn lại => do các nhà kết tập biên soạn.</li>
        </ul>

        <h4>CÔNG DỤNG CỦA CÁC BÀI KINH HỘ TRÌ</h4>
        <p>Mặc dù các bài Kinh Paritta nhìn chung là để tụng đọc, nhưng một số bài kinh cũng cần được thực hành. Chỉ có các Kinh Châu Báu (Ratanasutta), Kinh Con Công (Morasutta), Kinh Chim Cút (Vaṭṭasutta), Kinh Āṭānāṭiya, Kinh Aṅgulimāla và Kinh Ban Mai (Pubbaṇhasutta) là dành riêng cho việc tụng đọc; các bài khác dùng cho cả việc tụng đọc và thực hành. Mỗi bài Kinh có những công dụng cụ thể mặc dù mục đích chung là bảo vệ khỏi nguy hiểm. Các công dụng cụ thể có thể được tìm thấy trong các câu kệ dẫn nhập của mỗi bài Kinh, tóm tắt như sau:</p>
        
        <ul style="list-style-type: none; padding-left: 0;">
            <li><b>1. Maṅgalasutta</b> => cầu phước lành và thịnh vượng.</li>
            <li><b>2. Ratatasutta</b> => để thoát khỏi các nguy hiểm do bệnh tật, tà ma và nạn đói.</li>
            <li><b>3. Mettāsutta</b> => để lan tỏa lòng từ ái đến tất cả chúng sinh.</li>
            <li><b>4. Khandhasutta</b> => để bảo vệ khỏi rắn rết và các loài bò sát khác.</li>
            <li><b>5. Morasutta</b> => để bảo vệ khỏi cạm bẫy, sự giam cầm và được an toàn.</li>
            <li><b>6. Vaṭṭasutta</b> => để bảo vệ khỏi hỏa hoạn.</li>
            <li><b>7. Dhajaggasutta</b> => để bảo vệ khỏi sự sợ hãi, run rẩy và kinh hoàng.</li>
            <li><b>8. Āṭānāṭiyasutta</b> => để bảo vệ khỏi tà ma, có được sức khỏe và hạnh phúc.</li>
            <li><b>9. Aṅgulimālasutta</b> => để giúp các sản phụ dễ dàng sinh nở.</li>
            <li><b>10. Bojjhaṅgasutta</b> => để bảo vệ và thoát khỏi ốm đau, bệnh tật.</li>
            <li><b>11. Pubbaṇhasutta</b> => để bảo vệ khỏi điềm xấu, v.v., và có được hạnh phúc.</li>
        </ul>
        
        <h4>RẢI TÂM TỪ</h4>
        <p>Chưa bao giờ sự cần thiết của lòng từ ái (tâm từ) lại được cảm nhận sâu sắc như ngày nay khi bạo lực tràn lan khắp thế giới. Nếu chúng ta không giảm bớt bạo lực, thế giới sẽ trở thành địa ngục cho tất cả mọi người. Do đó, điều cấp thiết là chúng ta phải làm gì đó để ít nhất là giảm bớt bạo lực ngay cả khi không thể xóa sạch nó hoàn toàn. Việc thực hành lòng từ ái có thể giúp chúng ta đạt được mục tiêu đó; chúng ta có thể giúp giảm bớt bạo lực bằng tâm từ và làm cho mọi thứ tốt đẹp hơn cho tất cả chúng sinh.</p>
        
        <h4>HỒI HƯỚNG PHƯỚC BÁU</h4>
        <p>‘Hồi hướng phước báu’ luôn là một hành động đẹp mỗi khi chúng ta làm được việc thiện sự. Khi các bài Kinh Paritta được tụng với âm hưởng trầm bổng và được lắng nghe với niềm tin thành kính, lợi ích tức thì mà chúng mang lại là sự thanh thản, tĩnh lặng, bình an và niềm hỷ lạc. Nhiều thế hệ đã hưởng được những lợi ích này của Paritta và Mettā trong rất nhiều năm qua. Những lợi ích này cũng dành cho chúng ta nếu chúng ta biết tụng, nghe và thực hành đúng cách. Nguyện cầu cho tất cả chúng sinh tận hưởng được lợi ích của Paritta và Mettā theo những lời hướng dẫn ở đây.</p>
        
        <p><i>U Sīlānanda, Aggamahāpaṇḍita<br>Hoa Kỳ, 1998</i></p>
    `;

const sectionInfoData = {
    'Paritta': introContent,
    'MS': introContent,
    'Ratana': introContent,
    'Metta': introContent,
    'Khandha': introContent,
    'Mora': introContent,
    'Vaṭṭa': introContent,
    'Dhajagga': introContent,
    'Āṭānāṭiya': introContent,
    'Aṅgulimāla': introContent,
    'Bojjhaṅga': introContent,
    'Pubbaṇha': introContent
};
   const sections = [
      {
    id: 'Paritta', title: 'Paritta Parikamma', title_vn: 'Kệ Mở Đầu Hộ Kinh', audio: '00-ParittaPalikamma.mp3',
    text: `Namo tassa Bhagavato Arahato Sammāsambuddhassa. [12.437]
Xin thành kính lễ Ngài, Thế Tôn, A-La-Hán, Đấng Toàn Tri diệu giác
Namo tassa Bhagavato Arahato Sammāsambuddhassa. [7.939]
Xin thành kính lễ Ngài, Thế Tôn, A-La-Hán, Đấng Toàn Tri diệu giác
Namo tassa Bhagavato Arahato Sammāsambuddhassa. [8.598]
Xin thành kính lễ Ngài, Thế Tôn, A-La-Hán, Đấng Toàn Tri diệu giác

Samantā cakkavāḷesu, atrāgacchantu devatā, [7.882]
Này hỡi các Thiên giả, từ trong những Thiên hà xin hãy đến nơi đây,
Saddhammaṃ Munirājassa, suṇantu saggamokkhadaṃ: [7.479]
Và lắng nghe diệu pháp; Pháp Thiên lạc, giải thoát của Hiền Vương Thích Ca.
Dhammassavanakālo ayaṃ bhadantā! [5.732]
Này hỡi chư hiền giả, giờ này xin nghe pháp.
Dhammassavanakālo ayaṃ bhadantā! [4.725]
Này hỡi chư hiền giả, giờ này xin nghe pháp.
Dhammassavanakālo ayaṃ bhadantā! [5.419]
Này hỡi chư hiền giả, giờ này xin nghe pháp.

Namo tassa Bhagavato Arahato Sammāsambuddhassa. [6.986]
Xin thành kính lễ Ngài, Thế Tôn, A-La-Hán, Đấng Toàn Tri diệu giác.
Namo tassa Bhagavato Arahato Sammāsambuddhassa. [7.434]
Xin thành kính lễ Ngài, Thế Tôn, A-La-Hán, Đấng Toàn Tri diệu giác.
Namo tassa Bhagavato Arahato Sammāsambuddhassa. [7.815]
Xin thành kính lễ Ngài, Thế Tôn, A-La-Hán, Đấng Toàn Tri diệu giác.

Ye santā santacittā, tisaraṇasaraṇā, ettha lokantare vā, [9.673]
Những hiền trí nào có tâm an tịnh, đã nương tựa vào ba ngôi báu, ở thế giới này hay thế giới khác,
Bhummā bhummā ca devā, guṇagaṇagahaṇa byāvaṭā sabbakālaṃ, [9.472]
Và chư địa tiên hay Thiên tiên, những vị thường tích lũy vô vàn công đức.
Ete āyantu devā, varakanakamaye, Merurāje vasanto, [8.867]
Xin hãy đến nơi đây, những vị an lạc Thiên ngự ở núi chúa Mê-Ru bằng vàng ròng cao quý.
Santo santo sahetuṃ, Munivaravacanaṃ, sotumaggaṃ samaggā. [9.942]
Hãy đồng lòng lắng nghe những lời châu báu của Đức đại hiền (Mâu-Ni) cao thượng là nguồn của sự an lạc.

Sabbesu cakkavāḷesu, yakkhā devā ca brahmano, [7.255]
Từ trong tất cả các Thiên hà, chư Dạ Xoa, chư Thiên và chư Đại Phạm Thiên.
Yaṃ amhehi kataṃ puññaṃ, sabbasampattisādhakaṃ, [6.605]
Những công đức nào được làm bởi chúng tôi, khiến trọn vẹn tất cả những sự thành tựu,
Sabbe taṃ anumoditvā, samaggā sāsane ratā, [6.852]
Xin hãy tùy hỷ với tất cả những công đức ấy, tận tâm hòa hợp trong giáo pháp,
Pamādarahitā hontu, ārakkhāsu visesato. [7.210]
Và cùng nhau bảo vệ không xao lãng.

Sāsanassa ca lokassa, vuḍḍhī bhavatu sabbadā, [6.382]
Nguyện cầu những hưng thịnh, hằng hiện hữu cho thế giới và cho giáo pháp.
Sāsanampi ca lokañca, devā rakkhantu sabbadā. [7.568]
Xin chư Thiên hằng hộ trì cho thế giới và giáo pháp.
Saddhiṃ hontu sukhī sabbe, parivārehi attano, [6.986]
Nguyện cầu cho các sanh linh, cùng tất cả tùy tùng, họ hàng quyến thuộc, được an lạc, đẹp ý,
Anīghā sumanā hontu, saha sabbehi ñātibhi. [7.367]
Và thoát khỏi mọi lụy phiền.

Rājato vā, corato vā, manussato vā, amanussato vā, [8.934]
Thoát tai họa từ hôn quân, đạo tặc, phàm nhân, phi nhân,
Aggito vā, udakato vā, pisācato vā, khāṇukato vā, [8.554]
Hỏa hoạn, nước cuốn, ma quỷ, cây đổ,
Kaṇṭakato vā, nakkhattato vā, janapadarogato vā, asaddhammato vā, [9.516]
Vật nhọn, sao nạn, đại dịch, tà giáo,
Asandiṭṭhito vā, asappurisato vā, [5.777]
Tà kiến, hiểm nhân,
Caṇḍahatthī assa miga goṇa kukkura ahivicchikā maṇisappa dīpi [10.524]
Voi, ngựa, hươu, bò, chó dữ, rắn, bò cạp, thủy xà, báo,
Accha taraccha sūkara mahiṃsa yakkha rakkhasādīhi, [7.120]
Gấu, linh cẩu, lợn rừng, trâu, quỷ thần, Dạ Xoa,…
Nānā bhayato vā, nānā rogato vā, [5.105]
Xin bảo vệ sanh linh, tránh khỏi bao tai họa, 
Nānā upaddavato vā, ārakkhaṃ gaṇhantu. [8.8]
Cùng bao nhiêu bệnh hoạn, và mọi điều sợ hãi.`
},

{
    id: 'MS', title: '1. Maṅgalasutta ', title_vn: '1. Kinh Phước Lành', audio: '01-Mangalasutta.mp3',
    text: `Yaṃ maṅgalaṃ dvādasahi, cintayiṃsu sadevakā; [9.582]
Những phước lành mà hàng Thiên - nhân suốt mười hai năm đã suy nghĩ,
Sotthānaṃ nādhigacchanti, aṭṭhattiṃsañca maṅgalaṃ. [7.411]
Họ cũng không biết được những điều cát tường, gồm có ba mươi tám điều phước lành,
Desitaṃ devadevena, sabbapāpavināsanaṃ; [6.680]
Đã được thuyết bởi Thiên chủ muôn Thiên (Đức Thế Tôn), nhằm hủy diệt mọi điều tội lỗi,
Sabbalokahitatthāya, maṅgalaṃ taṃ bhaṇāma he. [7.494]
và mang lại lợi lạc cho tất cả thế gian, hỡi chư hiền, hãy tụng lên những điều phước lành này,

Evaṃ me sutaṃ - ekaṃ samayaṃ bhagavā sāvatthiyaṃ viharati [8.914]
Tôi là Ananda, đã được nghe như vầy: Một thuở Đức Thế Tôn ngự ở Sa-Vát-Thí,
Jetavane anāthapiṇḍikassa ārāme. [5.858]
Tại đại tự Kỳ Viên của trưởng giả Anāthapiṇḍika (Tư-Đà Cấp-Cô-Độc),
Atha kho aññatarā devatā abhikkantāya rattiyā abhikkantavaṇṇā [9.725]
Khi đêm đã gần mãn, có Thiên tử xuất hiện với hào quang thù diệu,
Kevalakappaṃ jetavanaṃ obhāsetvā yena bhagavā tenupasaṅkami; [10.539]
Chiếu sáng cả Kỳ Viên, đi đến chỗ Thế Tôn,
Upasaṅkamitvā bhagavantaṃ abhivādetvā ekamantaṃ aṭṭhāsi. [8.684]
Rồi đảnh lễ Thế Tôn, lễ xong đứng một bên,
Ekamantaṃ ṭhitā kho sā devatā bhagavantaṃ gāthāya ajjhabhāsi: [11.690]
Đứng một bên, vị Thiên bạch Thế Tôn, bằng bài kệ như vầy:

“Bahū devā manussā ca, maṅgalāni acintayuṃ; [6.701]
Nhiều chư Thiên và nhân loại, suy nghĩ về phước lành
Ākaṅkhamānā sotthānaṃ, brūhi maṅgalamuttamaṃ”. [7.035]
Mong ước điều cát tường, xin Ngài hãy nói lên, những phước lành cao thượng. 
Asevanā ca bālānaṃ, paṇḍitānañca sevanā; [6.471]
(Thế Tôn tuỳ lời hỏi rồi giảng giải như vầy) Không kết giao kẻ ngu, thân cận người thiện trí,
Pūjā ca pūjaneyyānaṃ‚ etaṃ maṅgalamuttamaṃ. [7.077]
Kính lễ bậc đáng lễ, là phước lành cao thượng.
Patirūpadesavāso ca, pubbe ca katapuññatā; [7.056]
Ở nơi chốn thích hợp, công đức trước đã làm,
Attasammāpaṇidhi ca, etaṃ maṅgalamuttamaṃ. [6.576]
Giữ mình được tốt đẹp, là phước lành cao thượng.

Bāhusaccañca sippañca, vinayo ca susikkhito; [6.722]
Học nhiều, thực hành giỏi, thuần thục các giới điều,
Subhāsitā ca yā vācā, etaṃ maṅgalamuttamaṃ. [7.578]
Nói những lời lợi ích, là phước lành cao thượng.
Mātāpitu upaṭṭhānaṃ, puttadārassa saṅgaho; [7.494]
Phụng dưỡng mẹ và cha, chăm sóc vợ và con,
Anākulā ca kammantā, etaṃ maṅgalamuttamaṃ. [7.265]
Việc làm không lẫn lộn, là phước lành cao thượng.

Dānañca dhammacariyā ca, ñātakānañca saṅgaho; [7.494]
Bố thí, hành thiện pháp, hộ độ thân quyến thuộc,
Anavajjāni kammāni, etaṃ maṅgalamuttamaṃ. [7.327]
Hành xử không lỗi lầm, là phước lành cao thượng.
Aratī viratī pāpā, majjapānā ca saṃyamo; [7.766]
Bỏ và tránh điều ác, kiêng cữ các chất say,
Appamādo ca dhammesu, etaṃ maṅgalamuttamaṃ. [7.285]
Nỗ lực trong thiện nghiệp, là phước lành cao thượng.

Gāravo ca nivāto ca, santuṭṭhi ca kataññutā; [7.327]
Cung kính và khiêm nhường, tri túc và tri ân,
Kālena dhammassavanaṃ‚ etaṃ maṅgalamuttamaṃ. [6.868]
Đúng thời nghe chánh pháp, là phước lành cao thượng.
Khantī ca sovacassatā, samaṇānañca dassanaṃ; [6.743]
Kham nhẫn và nhu thuận, tiếp kiến các Sa Môn,
Kālena dhammasākacchā, etaṃ maṅgalamuttamaṃ. [7.452]
Đàm luận pháp tùy thời, là phước lành cao thượng.

Tapo ca brahmacariyañca, ariyasaccāna dassanaṃ; [7.118]
Tận tâm hành Phạm hạnh, tri kiến tứ Thánh đế,
Nibbānasacchikiriyā ca, etaṃ maṅgalamuttamaṃ. [7.536]
Thực chứng được Niết Bàn, là phước lành cao thượng.
Phuṭṭhassa lokadhammehi, cittaṃ yassa na kampati; [7.014]
Xúc chạm pháp thế gian, tâm không động, không sầu,
Asokaṃ virajaṃ khemaṃ, etaṃ maṅgalamuttamaṃ. [8.308]
Tự tại và vô nhiễm, là phước lành cao thượng.

Etādisāni katvāna, sabbatthamaparājitā; [7.953]
Những sở hành như vậy, bất bại ở mọi nơi,
Sabbattha sotthiṃ gacchanti, taṃ tesaṃ maṅgalamuttamaṃ. [9.781]
Mọi nơi đến cát tường, đây phước lành cao thượng.`
},

{
    id: 'Ratana', title: '2. Ratanasutta', title_vn: '2. Kinh Châu Báu', audio: '02-Ratanasutta.mp3',
    text: `Paṇidhānato paṭṭhāya tathāgatassa dasa pāramiyo, [10.128]
Đại nguyện của Như Lai, gồm mười ba-la-mật,
Dasa upapāramiyo, dasa paramatthapāramiyoti, samatiṃsa pāramiyo, [10.446]
Mười thường ba-la-mật, mười thắng ba-la-mật, đủ ba mươi pháp độ.
Pañca mahapariccāge, lokatthacariyaṃ ñātatthacariyaṃ buddhatthacariyanti tisso cariyāyo [12.642]
Năm pháp đại xả thí, và cả ba đại hạnh: đại hạnh cho thế gian, đại hạnh cho thân tộc, đại hạnh quả vị Phật,
Pacchimabhave gabbhavokkantiṃ jātiṃ abhinikkhamanaṃ padhānacariyaṃ bodhipallaṅke māravijayaṃ [14.082]
Trong kiếp chót giáng trần, xuất gia tầm giải thoát, sáu năm tu khổ hạnh, chiến thắng đại ma quân,
Sabbaññutaññāṇappativedhaṃ dhammacakkappavattanaṃ navalokuttaradhammeti [10.983]
Đạt Nhất Thiết Chủng Trí, chứng chín pháp siêu phàm, và chuyển vận Pháp luân.
Sabbepime buddhaguṇe āvajjetvā vesāliyā tīsu pākarantaresu [10.275]
Ba vòng thành Vesali, niệm tất cả ân đức,
Tiyāmarattiṃ parittaṃ karonto āyasmā ānandatthero viya kāruññacittaṃ upaṭṭhapetvā [12.325]
Tôn giả Ananda với từ tâm vô lượng, trì tụng kinh châu báu, suốt trọn cả ba canh.
Koṭīsahassesu, cakkavāḷesu devatā; [6.150]
Mười muôn triệu thế giới, chư Thiên khắp các cõi,
Yassānaṃ paṭiggaṇhanti, yañca vesāliyā pure. [7.297]
Uy lực kinh thọ trì, trong thành Vesali,
Rogāmanussadubbhikkha sambhutaṃ tividhaṃ bhayaṃ; [6.931]
Tiêu trừ mọi tai ương, đói khát và bệnh tật, cùng phi nhân quấy nhiễu,
Khippamantaradhāpesi, parittaṃ taṃ bhaṇāma he. [7.297]
Thảy đều được tan biến. Này hỡi chư hiền giả, chúng tôi sẽ tụng lên, hộ kinh châu báu ấy.

Yānīdha bhūtāni samāgatāni, bhummāni‚ vā yāni va antalikkhe. [9.494]
Phàm những sanh linh nào, đã tụ hội nơi đây, hoặc các hạng địa tiên, hay các hạng Thiên tiên,
Sabbeva bhūtā sumanā bhavantu, athopi sakkacca suṇantu bhāsitaṃ. [9.518]
Mong rằng mọi sanh linh, được đẹp ý vui lòng, rồi xin hãy thành tâm, lắng nghe lời dạy này.
Tasmā hi bhūtā nisāmetha sabbe, mettaṃ karotha mānusiyā pajāya; [9.103]
Do vậy các sanh linh, tất cả hãy lắng tâm, rồi khởi lòng từ mẫn, đối với thảy mọi loài.
Divā ca ratto ca haranti ye baliṃ, tasmā hi ne rakkhatha appamattā. [9.347]
Ban ngày và ban đêm, họ dâng lễ cúng dường, vì vậy chớ xao lãng, hãy hộ trì cho họ.

Yaṃ kiñci vittaṃ idha vā huraṃ vā, saggesu vā yaṃ ratanaṃ paṇītaṃ; [10.202]
Phàm có tài sản nào, đời này hay đời sau, hay ở tại Thiên giới, có châu báu thù thắng,
Na no samaṃ atthi tathāgatena, idampi buddhe ratanaṃ paṇītaṃ; etena saccena suvatthi hotu. [14.180]
Không gì sánh bằng được, với Như Lai Thiện Thệ. Như vậy, nơi Đức Phật, là châu báu thù diệu. Mong với sự thật này, mọi loài được hạnh phúc.

Khayaṃ virāgaṃ amataṃ paṇītaṃ, yadajjhagā sakyamunī samāhito; [9.884]
Pháp bất tử tối thượng, ly dục diệt phiền não, Đức Thích Ca Mâu Ni, có định chứng pháp này.
Na tena dhammena samatthi kiñci, idampi dhamme ratanaṃ paṇītaṃ; etena saccena suvatthi hotu. [14.570]
Không gì sánh bằng được, pháp thiền vi diệu ấy. Như vậy, nơi Chánh Pháp, có châu báu thù diệu. Mong với sự thật này, mọi loài được hạnh phúc.

Yaṃ buddhaseṭṭho parivaṇṇayī suciṃ, samādhimānantarikaññamāhu; [9.103]
Phật, Thanh Văn, Duyên Giác, nói lên lời tán thán, định thù diệu trong sạch, liên tục không gián đoạn.
Samādhinā tena samo na vijjati, idampi dhamme ratanaṃ paṇītaṃ; etena saccena suvatthi hotu. [14.277]
Không gì sánh bằng được, pháp thiền vi diệu ấy. Như vậy, nơi Chánh Pháp, có châu báu thù diệu. Mong với sự thật này, mọi loài được hạnh phúc.

Ye puggalā aṭṭha sataṃ pasatthā, cattāri etāni yugāni honti; [9.250]
Thánh tám vị bốn đôi, là những bậc Ứng Cúng, đệ tử Đấng Thiện Thệ, được trí giả tán thán,
Te dakkhiṇeyyā sugatassa sāvakā, etesu dinnāni mahapphalāni; [8.981]
Cúng dường đến các Ngài, được kết quả to lớn.
Idampi saṅghe ratanaṃ paṇītaṃ, etena saccena suvatthi hotu. [9.811]
Như vậy nơi Tăng chúng, có châu báu thù diệu, mong với sự thật này, mọi loài được hạnh phúc.

Ye suppayuttā manasā daḷhena, nikkāmino gotamasāsanamhi; [9.128]
Những vị đã ly dục, với ý thật kiên trì, đã khéo léo phụng hành, lời dạy Gotama.
Te pattipattā amataṃ vigayha, laddhā mudhā nibbutiṃ bhuñjamānā. [10.202]
Họ đạt được quả vị, họ thể nhập bất tử, hưởng thọ sự tịch tịnh.
Idampi saṅghe ratanaṃ paṇītaṃ, etena saccena suvatthi hotu. [9.689]
Như vậy nơi Tăng chúng, có châu báu thù diệu, mong với sự thật này, mọi loài được hạnh phúc.

Yathindakhīlo pathavissito siyā, catubbhi vātehi asampakampiyo. [9.713]
Ví như cột trụ đá, được chôn chặt xuống đất, dầu bốn hướng cuồng phong, cũng không hề lay động,
Tathūpamaṃ sappurisaṃ vadāmi, yo ariyasaccāni avecca passati; [8.933]
Ta nói bậc chân nhân, thấu rõ tứ Thánh đế, cũng tự tại bất động, trước tám pháp thế gian.
Idampi saṅghe ratanaṃ paṇītaṃ, etena saccena suvatthi hotu. [10.006]
Như vậy nơi Tăng chúng, có châu báu thù diệu, mong với sự thật này, mọi loài được hạnh phúc.

Ye ariyasaccāni vibhāvayanti, gambhīrapaññena sudesitāni; [8.664]
Bậc thấu triệt Thánh đế, đã được khéo thuyết giảng, bởi trí tuệ uyên thâm,
Kiñcāpi te honti bhusaṃ pamattā, na te bhavaṃ aṭṭhamamādiyanti; [9.103]
Dù cho có bất cẩn, thì cũng không bao giờ, tái sanh kiếp thứ tám.
Idampi saṅghe ratanaṃ paṇītaṃ, etena saccena suvatthi hotu. [9.909]
Như vậy nơi Tăng chúng, có châu báu thù diệu, mong với sự thật này, mọi loài được hạnh phúc.

Sahāvassa dassanasampadāya, tayassu dhammā jahitā bhavanti. [8.371]
Với đầy đủ tri kiến, Thanh Văn đạo quả tuệ, vị ấy đoạn trừ được, đồng thời ba kiết sử,
Sakkāyadiṭṭhī vicikicchitañca, sīlabbataṃ vāpi yadatthi kiñci. [9.006]
Thân kiến và hoài nghi, luôn cả giới cấm thủ.
Catūhapāyehi ca vippamutto, chaccābhiṭhānāni abhabba kātuṃ. [8.884]
Vị không thể nào phạm, sáu trọng nghiệp bất thiện, vĩnh viễn giải thoát mình, ra khỏi bốn đọa xứ.
Idampi saṅghe ratanaṃ paṇītaṃ, etena saccena suvatthi hotu. [9.836]
Như vậy nơi Tăng chúng, có châu báu thù diệu, mong với sự thật này, mọi loài được hạnh phúc.

Kiñcāpi so kamma karoti pāpakaṃ, kāyena vācā uda cetasā vā. [10.177]
Dù vô tâm phạm lỗi, bằng thân, ý hay lời,
Abhabba so tassa paṭicchadāya, abhabbatā diṭṭhapadassa vuttā. [8.615]
Đối với bậc “kiến đạo”, cũng không hề che giấu, lỗi lầm của vị ấy.
Idampi saṅghe ratanaṃ paṇītaṃ, etena saccena suvatthi hotu. [9.225]
Như vậy nơi Tăng chúng, có châu báu thù diệu, mong với sự thật này, mọi loài được hạnh phúc.

Vanappagumbe yatha phussitagge, gimhānamāse paṭhamasmiṃ gimhe. [9.030]
Đẹp là những cây rừng, đội chồi non đầu ngọn, trong tháng hạ nóng bức, những ngày hạ đầu tiên.
Tathūpamaṃ dhammavaraṃ adesayi, nibbānagāmiṃ paramaṃ hitāya. [8.396]
Pháp thù thắng Phật thuyết, được ví dụ như vậy, Pháp đưa đến Niết Bàn, Pháp lợi ích tối thượng.
Idampi buddhe ratanaṃ paṇītaṃ, etena saccena suvatthi hotu. [9.421]
Như vậy nơi Đức Phật, là châu báu thù diệu, mong với sự thật này, mọi loài được hạnh phúc.

Varo varaññū varado varāharo, anuttaro dhammavaraṃ adesayi; [8.298]
Đức Phật Bậc vô thượng, liễu thông Pháp vô thượng, ban bố Pháp vô thượng, chuyển đạt pháp vô thượng, tuyên thuyết Pháp vô thượng.
Idampi buddhe ratanaṃ paṇītaṃ, etena saccena suvatthi hotu. [9.323]
Như vậy nơi Đức Phật, là châu báu thù diệu, mong với sự thật này, mọi loài được hạnh phúc.

Khīṇaṃ purāṇaṃ nava natthi sambhavaṃ, virattacittāyatike bhavasmiṃ; [9.713]
Nghiệp cũ đã đoạn tận, nghiệp mới không sanh khởi, tâm tư không kiết sử, trong sanh hữu tương lai.
Te khīṇabījā avirūḷhichandā, nibbanti dhīrā yathāyaṃ padīpo. [9.543]
Bởi tham muốn đã đoạn, các chủng tử không còn, ví như ngọn đèn tắt, bậc trí chứng Niết Bàn.
Idampi saṅghe ratanaṃ paṇītaṃ, etena saccena suvatthi hotu. [9.445]
Như vậy nơi Tăng chúng, là châu báu thù diệu, mong với sự thật này, mọi loài được hạnh phúc.

Yānīdha bhūtāni samāgatāni, bhummāni vā yāni va antalikkhe; [9.177]
Phàm những sanh linh nào, đã tụ hội nơi đây, hoặc trên mặt đất này, hoặc chính giữa hư không,
Tathāgataṃ devamanussapūjitaṃ, buddhaṃ namassāma suvatthi hotu. [9.152]
Hãy đảnh lễ Đức Phật, đã như thực xuất hiện, được loài trời loài người, đảnh lễ và cúng dường, mong với sự thật này, mọi loài được hạnh phúc.

Yānīdha bhūtāni samāgatāni, bhummāni vā yāni va antalikkhe; [9.128]
Phàm những sanh linh nào tụ hội nơi đây, hoặc trên mặt đất hoặc giữa hư không,
Tathāgataṃ devamanussapūjitaṃ, dhammaṃ namassāma suvatthi hotu. [8.566]
Hãy đảnh lễ Chánh Pháp, đã như thực xuất hiện, được loài trời loài người, đảnh lễ và cúng dường, mong với sự thật này, mọi loài được hạnh phúc.

Yānīdha bhūtāni samāgatāni, bhummāni vā yāni va antalikkhe; [9.274]
Phàm những sanh linh nào tụ hội nơi đây, hoặc trên mặt đất hoặc giữa hư không,
Tathāgataṃ devamanussapūjitaṃ, saṅghaṃ namassāma suvatthi hotu. [10.500]
Hãy đảnh lễ Chúng Tăng, đã như thực xuất hiện, được loài trời loài người, đảnh lễ và cúng dường, mong với sự thật này, mọi loài được hạnh phúc.`
},

{
    id: 'Metta', title: '3. Mettasutta', title_vn: '3. Kinh Lòng Từ', audio: '03-Mettasutta.mp3',
    text: `Yassānubhāvato yakkhā, nevadassenti bhīsanaṃ; [10.475]
Nhờ uy lực kinh này, khiến những loài Dạ Xoa, không hiện hình ghê sợ.
Yamhi cevānuyuñjanto, rattindivamatandito. [7.643]
Những ai ngày và đêm, thường siêng năng tụng trì,
Sukhaṃ supati sutto ca, pāpaṃ kiñci na passati; [7.061]
Ngủ ngon, không ác mộng
Evamādi guṇūpetaṃ, parittaṃ taṃ bhaṇāma he. [8.419]
Này hỡi các tôn giả, xin chư vị lắng nghe, chúng tôi sẽ tụng lên, hộ kinh lòng từ này.

Karaṇīyamatthakusalena, yanta santaṃ padaṃ abhisamecca; [8.186]
Hiền nhân cầu an lạc, nên huân tu pháp lành,
Sakko ujū ca suhujū ca, suvaco cassa mudu anatimānī. [8.768]
Có nghị lực chân chất, ngay thẳng và nhu thuận, hiền hòa không kiêu mạn.
Santussako ca subharo ca, appakicco ca sallahukavutti; [7.565]
Sống dễ dàng tri túc, thanh đạm không rộn ràng.
Santindriyo ca nipako ca, appagabbho kulesvananugiddho. [8.419]
Lục căn luôn trong sáng, trí tuệ càng hiển minh, tự trọng không quyến niệm,

Na ca khuddamācare kiñci, yena viññū pare upavadeyyuṃ; [8.846]
Không làm việc ác nhỏ, mà bậc trí hiền chê.
Sukhino va khemino hontu, sabbasattā bhavantu sukhitattā. [8.807]
Nguyện thái bình an lạc, nguyện tất cả sanh linh, tràn đầy muôn hạnh phúc.
Ye keci pāṇabhūtatthi, tasā vā thāvarā vanavasesā; [8.419]
Với muôn loài chúng sanh, không phân phàm hay Thánh,
Dīghā vā yeva mahantā, majjhimā rassakā aṇukathūlā. [8.419]
Lớn nhỏ hoặc trung bình, thấp cao hay dài ngắn, tế thô không đồng đẳng.

Diṭṭhā vā yeva adiṭṭhā, ye va dūre vasanti avidūre. [8.380]
Hữu hình hoặc vô hình, gần xa không kể xiết
Bhūtā va sambhavesī va, sabbasattā bhavantu sukhitattā. [8.264]
Đã sanh hoặc chưa sanh, nguyện tất cả sanh linh, tràn đầy muôn hạnh phúc.
Na paro paraṃ nikubbetha, nātimaññetha katthaci na kiñci‚ [8.264]
Đừng làm hại lẫn nhau, chớ khinh rẻ người nào, ở bất cứ nơi đâu,
Byārosanā paṭighasaññā, nāññamaññassa dukkhamiccheyya. [8.186]
Đừng vì niệm sân si, hoặc hiềm hận trong lòng, mà mong người đau khổ.

Mātā yathā niyaṃ puttamāyusā ekaputtamanurakkhe; [8.225]
Hãy mở rộng tình thương, hy sinh như từ mẫu, suốt đời lo che chở, đứa con một của mình.
Evampi sabbabhūtesu, mānasaṃ bhāvaye aparimāṇaṃ. [8.341]
Hãy phát tâm vô lượng, đến tất cả sanh linh.
Mettañca sabbalokasmi, mānasaṃ bhāvaye aparimāṇaṃ; [7.837]
Từ bi gieo cùng khắp, cả thế gian khổ hải,
Uddhaṃ adho ca tiriyañca, asambādhaṃ averamasapattaṃ. [9.040]
Trên dưới và quanh mình, không hẹp hòi oan trái, không hờn giận căm thù.

Tiṭṭhaṃ caraṃ nisinno va, sayāno yāvatāssa vitamiddho‚ [8.147]
Khi đi đứng ngồi nằm, bao giờ còn tỉnh thức,
Etaṃ satiṃ adhiṭṭheyya, brahmametaṃ vihāramidhamāhu. [8.807]
An trú chánh niệm này, Phạm hạnh chính là đây.
Diṭṭhiñca anupaggamma, sīlavā dassanena sampanno; [7.682]
Ai từ bỏ kiến chấp, khéo nghiêm trì giới hạnh, thành tựu được chánh trí,
Kāmesu vineyya gedhaṃ, na hi jātuggabbhaseyya punareti. [11.709]
Không ái nhiễm dục trần, không còn thai sanh nữa.`
},

{
    id: 'Khandha', title: '4. Khandhasutta', title_vn: '4. Hộ Kinh Khandha', audio: '04-Khandhasutta.mp3',
    text: `Sabbāsīvisajātīnaṃ, dibbamantāgadaṃ viya; [10.975]
Này hỡi các hiền giả, như một món Thiên dược, như bài linh chú hay,
Yaṃ nāseti visaṃ ghoraṃ, sesañcāpi parissayaṃ. [7.946]
Khiến cho các nọc độc, hay những lúc nguy nan, từ thú dữ, độc trùng,
Aṇākkhettamhi sabbattha, sabbadā sabbapāṇinaṃ; [7.499]
Trong tất cả cõi giới, gây hại đến chúng sanh,
Sabbassopi nivāreti, parittaṃ taṃ bhaṇāma he. [7.896]
thời nhanh chóng vô hiệu, chúng tôi sẽ tụng lên, hộ kinh Khandha này,

Virūpakkhehi me mettaṃ, mettaṃ erāpathehi me; [7.300]
Rải tâm từ của tôi, đến với dòng rắn chúa, tên Vi-rù-pak-kha, rải tâm từ của tôi, đến với dòng rắn chúa, tên E-rà-pa-tha.
Chabyāputtehi me mettaṃ, mettaṃ kaṇhāgotamakehi ca. [8.095]
Rải tâm từ của tôi, đến với dòng rắn chúa, tên Chab-yà-put-ta, rải tâm từ của tôi, đến với dòng rắn chúa, Kan-hà-go-ta-ma.

Apādakehi me mettaṃ, mettaṃ dvipādakehi me. [7.002]
Rải tâm từ của tôi đến chúng sinh không chân, rải tâm từ của tôi đến chúng sinh hai chân.
Catuppadehi me mettaṃ, mettaṃ bahuppadehi me. [6.654]
Rải tâm từ của tôi đến chúng sinh bốn chân, rải tâm từ của tôi đến chúng sinh nhiều chân.

Mā maṃ apādako hiṃsi, mā maṃ hiṃsi dvipādako [7.052]
Loài chúng sinh không chân, xin đừng làm khổ tôi, loài chúng sinh hai chân, xin đừng làm khổ tôi. 
Mā maṃ catuppado hiṃsi, mā maṃ hiṃsi bahuppado. [7.548]
Loài chúng sinh bốn chân, xin đừng làm khổ tôi, loài chúng sinh nhiều chân, xin đừng làm khổ tôi. 

Sabbe sattā sabbe pāṇā, sabbe bhūtā ca kevalā; [8.045]
Tôi xin rải tâm từ, đến tất cả chúng sinh, tất cả mọi sinh mạng, mọi chúng sinh hiện hữu.
Sabbe bhadrāni passantu, mā kañci pāpamāgamā. [7.995]
Tất cả chúng sinh ấy, thấy những cảnh tốt đẹp, cầu mong không một ai, gặp phải cảnh khổ đau.

Appamāṇo buddho, appamāṇo dhammo; appamāṇo saṅgho, [8.194]
Ân đức Phật vô lượng, Ân đức Pháp vô lượng, Ân đức Tăng vô lượng
Pamāṇavantāni sarīsapāni; ahivicchikā satapadī, uṇṇanābhī sarabū mūsikā. [12.316]
Rắn, bò cạp, rết, nhện, tắc kè, chuột, vân vân. Các loài bò sát ấy, có tính hay hung dữ,

Katā me rakkhā katā me parittā paṭikkamantu bhūtāni. [8.492]
Tôi có nơi hộ trì, tôi có nơi bảo hộ, xin tất cả chúng sinh, tránh xa đừng hại tôi.
Sohaṃ namo bhagavato, namo sattannaṃ sammāsambuddhānaṃ. [10.952]
Con đảnh lễ Chư Phật, hiện tại đến quá khứ, bảy Đức Phật Chánh Giác.`
},

{
    id: 'Mora', title: '5. Morasutta', title_vn: '5. Kinh Khổng Tước', audio: '05-Morasutta.mp3',
    text: `Pūrentaṃ bodhisambhāre, nibbattaṃ morayoniyaṃ; [10.284]
Vào thời bổ túc các pháp độ, Bồ Tát sanh làm loài khổng tước;
Yena saṃvihitārakkhaṃ, mahāsattaṃ vanecarā. [6.639]
Bậc đại sỹ sinh sống ở trong rừng, nhờ bài chú này được bảo vệ.
Cirassaṃ vāyamantāpi, neva sakkhiṃsu gaṇhituṃ; [6.466]
Bảy đời thợ săn dù nỗ lực cũng không thể bắt được khổng tước.
“Brahmamantan”ti akkhātaṃ, parittaṃ taṃ bhaṇāma he. [7.551]
Này chư hiền, hãy tụng bài hộ kinh, được cho là bài chú của Phạm Thiên.

Udetayaṃ cakkhumā ekarājā, harissavaṇṇo pathavippabhāso; [9.048]
Vị vua duy nhất cho mắt này đang mọc lên, với sắc màu vàng chói, chiếu sáng cả đất liền;
Taṃ taṃ namassāmi harissavaṇṇaṃ pathavippabhāsaṃ, tayājja guttā viharemu divasaṃ. [11.087]
Vậy ta đảnh lễ Ngài, vị sáng soi mặt đất, nhờ Ngài bảo hộ ta, sống an toàn trọn ngày.
Ye brāhmaṇā vedagū sabbadhamme, te me namo te ca maṃ pālayantu; [9.135]
Các vị Thánh, chân nhân, bậc tuệ tri mọi pháp, con đảnh lễ các Ngài, hãy hộ trì cho con.
Namatthu buddhānaṃ namatthu bodhiyā, namo vimuttānaṃ namo vimuttiyā; [9.221]
Đảnh lễ chư Phật-Đà, đảnh lễ Bồ-Đề vị, đảnh lễ bậc giải thoát, đảnh lễ giải thoát vị.
Imaṃ so parittaṃ katvā, moro carati esanā. [7.572]
Sau khi đọc lên chú bảo hộ này, chim khổng tước đi kiếm mồi.

Apetayaṃ cakkhumā ekarājā, harissavaṇṇo pathavippabhāso; [8.288]
Vị vua duy nhất cho mắt này đang lặn mất, với sắc màu vàng chói, chiếu sáng cả đất liền;
Taṃ taṃ namassāmi harissavaṇṇaṃ pathavippabhāsaṃ, tayājja guttā viharemu rattiṃ. [10.436]
Vậy ta đảnh lễ Ngài, vị sáng soi mặt đất, nhờ Ngài bảo vệ ta, sống an toàn trọn đêm.
Ye brāhmaṇā vedagū sabbadhamme, te me namo te ca maṃ pālayantu; [8.787]
Chư vị Thánh, chân nhân, bậc tuệ tri mọi pháp, con đảnh lễ các Ngài, hãy hộ trì cho con.
Namatthu buddhānaṃ namatthu bodhiyā, namo vimuttānaṃ namo vimuttiyā; [9.004]
Đảnh lễ chư Phật-Đà, đảnh lễ Bồ-Đề vị, đảnh lễ bậc giải thoát, đảnh lễ giải thoát vị.
Imaṃ so parittaṃ katvā, moro vāsamakappayi. [7.925]
Sau khi đọc lên chú bảo hộ này, chim khổng tước đi ngủ.`
},

 
 
{
    id: 'Vaṭṭa', title: '6. Vaṭṭasutta', title_vn: '6. Kinh Chim Cút', audio: '06-Vattasutta.mp3',
    text: `Pūrentaṃ bodhisambhāre, nibbattaṃ vaṭṭajātiyaṃ; [10.597]
Vào thời bổ túc các pháp độ, Bồ Tát tái sanh làm chim cút;
Yassa tejena dāvaggi, mahāsattaṃ vivajjayi. [6.696]
Thông qua uy lực của kinh này, Đại sỹ thoát được ngọn lửa rừng.
Therassa Sāriputtassa, lokanāthena bhāsitaṃ; [6.172]
Do duyên ngài Xá Lợi Phất hỏi, Đức Thế Tôn đã thuyết bài kinh;
Kappaṭṭhāyiṃ mahātejaṃ, parittaṃ taṃ bhaṇāma he. [7.492]
Có uy lực trụ đến mãn kiếp, ta hãy cùng tụng hộ kinh này:

Atthi loke sīlaguṇo, saccaṃ soceyyanuddayā; [6.774]
Ở đời có giới đức, chân thật, tịnh, từ bi;
Tena saccena kāhāmi, saccakiriyamuttamaṃ. [6.327]
Chính với chân thật ấy, ta sẽ làm một hạnh, hạnh chân thật vô thượng.
Avajjetvā dhammabalaṃ, saritvā pubbake jine; [6.289]
Rồi hướng niệm pháp lực, niệm chư Phật quá khứ;
Saccabalamavassāya, saccakiriyamakāsahaṃ. [6.677]
Dựa sức mạnh chân thật, ta làm hạnh chân thật.

Santi pakkhā apatanā, santi pādā avañcanā; [6.735]
Có cánh không bay được, có chân không thể đi;
Mātāpitā ca nikkhantā, jātaveda paṭikkama [6.871]
Cha mẹ đã bỏ ta, hỡi lửa, hãy lui đi!
Saha sacce kate mayhaṃ, mahāpajjalito sikhī; [6.890]
Ta làm hạnh chân thật, màn lửa lớn lửa ngọn;
Vajjesi soḷasakarīsāni, udakaṃ patvā yathā sikhī; [7.880]
Đi lui mười sáu tầm, như ngọn đuốc gặp nước.
Saccena me samo natthi, esā me saccapāramī. [7.922]
Không ai sánh kịp ta, hạnh chân thật hoàn hảo.`
},

{
    id: 'Dhajagga', title: '7. Dhajaggasutta', title_vn: '7. Kinh Đầu Lá Cờ', audio: '07-Dhajaggasutta.mp3',
    text: `Yassānussaranenāpi, antalikkhepi pāṇino. [8.263]
Chỉ mới nghĩ đến bài hộ kinh này, mà các chúng sanh trong khắp các phương, ở trong hư không
Patiṭṭhamadhigacchanti, bhūmiyaṃ viya sabbathā. [6.225]
Cũng như trên đất, đều được hộ trì
Sabbupaddavajālamhā, yakkhacorādisambhavā; [6.442]
Thoát lưới tai ương, từ cướp, dạ xoa.., vô số không xuể,
Gaṇanā na ca muttānaṃ, parittaṃ taṃ bhaṇāma he. [8.308]
Chư hiền, chúng ta hãy tụng lên Hộ Kinh này.

Evaṃ me sutaṃ - ekaṃ samayaṃ bhagavā sāvatthiyaṃ viharati. [8.199]
Tôi được nghe như vầy - Một thời Đức Thế Tôn trú ở Sāvatthi,
Jetavane anāthapiṇḍikassa ārāme. [5.640]
Jetavana, tại vườn ông Anāthapiṇḍika.
Tatra kho bhagavā bhikkhū āmantesi: “bhikkhavo”ti. [6.269]
Rồi Thế Tôn gọi các Tỳ-khưu: "- Này các Tỳ-khưu."
“Bhadante”ti te bhikkhū bhagavato paccassosuṃ. Bhagavā etadavoca: [9.588]
"- Thưa vâng, bạch Thế Tôn." Các Tỳ-khưu ấy vâng đáp Thế Tôn. Thế Tôn nói như sau:

“Bhūtapubbaṃ, bhikkhave, devāsurasaṅgāmo samupabyūḷho ahosi. [9.110]
“Thuở xưa, này các Tỳ-khưu, đã xảy ra một cuộc chiến dữ dội khởi lên giữa chư Thiên và các Asūra.
Atha kho, bhikkhave, sakko devānamindo deve tāvatiṃse āmantesi [9.436]
Rồi này các Tỳ-khưu, Thiên chủ Sakka gọi chư Thiên ở Tam thập tam thiên:
‘Sace, mārisā, devānaṃ saṅgāmagatānaṃ [5.705]
"- Này thân hữu, khi các Ông lâm chiến,
Uppajjeyya bhayaṃ vā chambhitattaṃ vā lomahaṃso vā, [7.050]
nếu sợ hãi, hoảng hốt hay lông tóc dựng ngược có khởi lên;
Mameva tasmiṃ samaye dhajaggaṃ ullokeyyātha. [6.356]
khi ấy, các Ông hãy nhìn nơi đầu ngọn cờ của ta.
Mamaṃ hi vo dhajaggaṃ ullokayataṃ [5.293]
Khi các Ông nhìn lên đầu ngọn cờ của ta,
Yaṃ bhavissati bhayaṃ vā chambhitattaṃ vā lomahaṃso vā, so pahīyissati. [8.980]
thì sợ hãi, hoảng hốt hay lông tóc dựng ngược sẽ tiêu diệt.

No ce me dhajaggaṃ ullokeyyātha, atha pajāpatissa devarājassa dhajaggaṃ ullokeyyātha. [10.390]
Nếu các Ông không ngó lên đầu ngọn cờ của ta, thì hãy ngó lên đầu ngọn cờ của Thiên vương Pajāpati.
Pajāpatissa hi vo devarājassa dhajaggaṃ ullokayataṃ [6.941]
Khi các Ông ngó lên đầu ngọn cờ của Thiên vương Pajāpati,
Yaṃ bhavissati bhayaṃ vā chambhitattaṃ vā lomahaṃso vā, so pahīyissati. [8.503]
thì sợ hãi, hoảng hốt hay lông tóc dựng ngược có khởi lên, cũng sẽ tiêu diệt.

No ce pajāpatissa devarājassa dhajaggaṃ ullokeyyātha, [6.659]
Nếu các Ông không ngó lên đầu ngọn cờ của Thiên vương Pajāpati,
Atha varuṇassa devarājassa dhajaggaṃ ullokeyyātha. [6.139]
hãy ngó lên đầu ngọn cờ của Thiên vương Varuṇa.
Varuṇassa hi vo devarājassa dhajaggaṃ ullokayataṃ [6.681]
Khi các Ông ngó lên đầu ngọn cờ của Thiên vương Varuṇa,
Yaṃ bhavissati bhayaṃ vā chambhitattaṃ vā lomahaṃso vā, so pahīyissati. [9.436]
thì sợ hãi, hoảng hốt hay lông tóc dựng ngược có khởi lên cũng sẽ tiêu diệt.

No ce varuṇassa devarājassa dhajaggaṃ ullokeyyātha, [6.312]
Nếu các Ông không ngó lên đầu ngọn cờ của Thiên vương Varuṇa,
Atha īsānassa devarājassa dhajaggaṃ ullokeyyātha. [6.030]
hãy ngó lên đầu ngọn cờ của Thiên vương Isāna.
Īsānassa hi vo devarājassa dhajaggaṃ ullokayataṃ [6.898]
Khi các Ông ngó lên đầu ngọn cờ của Thiên vương Isāna,
Yaṃ bhavissati bhayaṃ vā chambhitattaṃ vā lomahaṃso vā, so pahīyissatī’ti. [9.327]
thì sợ hãi, hoảng hốt hay lông tóc dựng ngược có khởi lên, cũng sẽ tiêu diệt."

Taṃ kho pana, bhikkhave, sakkassa vā devānamindassa dhajaggaṃ ullokayataṃ, [8.742]
Này các Tỳ-khưu, khi họ nhìn lên đầu ngọn cờ của Thiên chủ Sakka,
Pajāpatissa vā devarājassa dhajaggaṃ ullokayataṃ, [6.139]
hay khi họ nhìn lên đầu ngọn cờ của Thiên vương Pajāpati,
Varuṇassa vā devarājassa dhajaggaṃ ullokayataṃ, [6.182]
hay khi họ nhìn lên đầu ngọn cờ của Thiên vương Varuṇa,
Īsānassa vā devarājassa dhajaggaṃ ullokayataṃ [6.247]
hay khi họ nhìn lên đầu ngọn cờ của Thiên vương Isāna,
Yaṃ bhavissati bhayaṃ vā chambhitattaṃ vā lomahaṃso vā, [6.442]
thì sợ hãi, hoảng hốt hay lông tóc dựng ngược được khởi lên,
So pahīyethāpi nopi pahīyetha. Taṃ kissa hetu? [6.312]
có thể sẽ biến mất hoặc sẽ không biến mất. Vì cớ sao?
Sakko hi, bhikkhave, devānamindo avītarāgo avītadoso avītamoho [9.284]
Vì Thiên chủ Sakka chưa đoạn diệt tham, chưa đoạn diệt sân, chưa đoạn diệt si,
Bhīru chambhī utrāsī palāyīti. [5.358]
còn nhát gan, hoảng hốt, hoảng sợ, hoảng chạy.

Ahañca kho, bhikkhave, evaṃ vadāmi ‘sace tumhākaṃ, bhikkhave, [7.332]
Và này các Tỳ-khưu, Ta nói như sau: Này các Tỳ-khưu, khi các ông
Araññagatānaṃ vā rukkhamūlagatānaṃ vā suññāgāragatānaṃ vā [7.418]
đi vào rừng, đi đến gốc cây hay đi đến nhà trống,
Uppajjeyya bhayaṃ vā chambhitattaṃ vā lomahaṃso vā, [6.247]
nếu run sợ, hoảng hốt, hay lông tóc dựng ngược có khởi lên,
Mameva tasmiṃ samaye anussareyyātha [5.163]
trong khi ấy hãy chỉ nhớ đến Như lai như vầy:

‘Itipi so bhagavā arahaṃ sammāsambuddho [6.182]
Ngài là Thế Tôn, Ứng Cúng, Chánh Biến Tri,
Vijjācaraṇasampanno sugato lokavidū [5.726]
Minh Hạnh Túc, Thiện Thệ, Thế Gian Giải,
Anuttaro purisadammasārathi satthā devamanussānaṃ buddho bhagavā’ti. [10.108]
Vô Thượng Sĩ, Điều Ngự Trượng Phu, Thiên Nhân Sư, Phật, Thế Tôn.
Mamaṃ hi vo, bhikkhave, anussarataṃ [4.685]
Vì rằng, này các Tỳ-khưu, khi các ông nhớ đến Ta,
Yaṃ bhavissati bhayaṃ vā chambhitattaṃ vā lomahaṃso vā, so pahīyissati. [8.742]
thì sợ hãi, hoảng hốt hay lông tóc dựng ngược sẽ tiêu diệt.

No ce maṃ anussareyyātha, atha dhammaṃ anussareyyātha [6.681]
Nếu các Ông không nhớ đến Ta, hãy nhớ đến Giáo Pháp:
‘Svākkhāto bhagavatā dhammo [4.165]
Ðây là Pháp do Thế Tôn khéo thuyết,
Sandiṭṭhiko akāliko ehipassiko opaneyyiko [7.505]
Thiết thực hiện tại, cho quả lập tức, đến để mà thấy, có khả năng hướng thượng,
Paccattaṃ veditabbo viññūhī’ti. [4.924]
Do người trí tự mình kinh nghiệm.
Dhammaṃ hi vo, bhikkhave, anussarataṃ [4.620]
Vì rằng, này các Tỳ-khưu, khi các ông nhớ đến Giáo Pháp,
Yaṃ bhavissati bhayaṃ vā chambhitattaṃ vā lomahaṃso vā, so pahīyissati. [8.676]
thì sợ hãi, hoảng hốt hay lông tóc dựng ngược sẽ tiêu diệt.

No ce dhammaṃ anussareyyātha, atha saṅghaṃ anussareyyātha [7.136]
Nếu các Ông không nhớ đến Giáo Pháp, hãy nhớ đến Chúng Tăng:
‘Suppaṭipanno bhagavato sāvakasaṅgho [4.967]
Thực hành thiện lành là chúng Tăng đệ tử Đức Thế Tôn,
Ujuppaṭipanno bhagavato sāvakasaṅgho [4.967]
Thực hành ngay thẳng là chúng Tăng đệ tử Đức Thế Tôn,
Ñāyappaṭipanno bhagavato sāvakasaṅgho [5.141]
Ứng lý thực hành là chúng Tăng đệ tử Đức Thế Tôn,
Sāmīcippaṭipanno bhagavato sāvakasaṅgho, [5.488]
Cung kính thực hành là chúng Tăng đệ tử Đức Thế Tôn,
Yadidaṃ cattāri purisayugāni aṭṭha purisapuggalā [6.399]
Tức là bốn đôi, tám chúng.
Esa bhagavato sāvakasaṅgho, [4.056]
Chúng Tăng đệ tử này của Đức Thế Tôn
Āhuneyyo pāhuneyyo dakkhiṇeyyo añjalikaraṇīyo [7.397]
Đáng được tôn trọng, đáng được tiếp rước, đáng được cúng dường, đáng được chấp tay,
Anuttaraṃ puññakkhettaṃ lokassā’ti. [4.881]
Là vô thượng phước điền ở trên đời.

Saṅghaṃ hi vo, bhikkhave, anussarataṃ [4.382]
Vì rằng, này các Tỳ-khưu, khi các ông nhớ đến Chúng Tăng,
Yaṃ bhavissati bhayaṃ vā chambhitattaṃ vā lomahaṃso vā, so pahīyissati. [8.416]
thì sợ hãi, hoảng hốt hay lông tóc dựng ngược sẽ tiêu diệt.
Taṃ kissa hetu? Tathāgato hi, bhikkhave, arahaṃ sammāsambuddho [7.223]
Vì cớ sao? Vì Như Lai, này các Tỳ-khưu, là bậc A-la-hán, Chánh Biến Tri,
Vītarāgo vītadoso vītamoho abhīru acchambhī anutrāsī apalāyī”ti. [11.258]
Đã ly tham, ly sân, ly si, không nhát gan, không hoảng hốt, không hoảng sợ, không hoảng chạy.”

Idamavoca bhagavā. Idaṃ vatvāna sugato athāparaṃ etadavoca satthā [9.327]
Thế Tôn nói như vậy, Thiện Thệ nói vậy xong, bậc Ðạo Sư nói tiếp:
“Araññe rukkhamūle vā, suññāgāreva bhikkhavo; [6.074]
Này các vị Tỳ-khưu, trong rừng hay gốc cây, hay tại căn nhà trống;
Anussaretha sambuddhaṃ, bhayaṃ tumhāka no siyā. [6.182]
Hãy niệm Bậc Chánh Giác, các ông có sợ hãi, sợ hãi sẽ tiêu diệt;
“No ce buddhaṃ sareyyātha, lokajeṭṭhaṃ narāsabhaṃ; [6.182]
Nếu không tư niệm Phật, tối thượng chủ ở đời, và cũng là Ngưu vương, trong thế giới loài người;
Atha dhammaṃ sareyyātha, niyyānikaṃ sudesitaṃ. [6.507]
Vậy hãy tư niệm Pháp, hướng thượng, khéo tuyên thuyết.
“No ce dhammaṃ sareyyātha, niyyānikaṃ sudesitaṃ; [6.421]
Nếu không tư niệm Pháp, hướng thượng, khéo tuyên thuyết;
Atha saṅghaṃ sareyyātha, puññakkhettaṃ anuttaraṃ. [6.421]
Vậy hãy tư niệm Tăng, là phước điền vô thượng.
“Evaṃ buddhaṃ sarantānaṃ, dhammaṃ saṅghañca bhikkhavo; [7.136]
Vậy này các Tỳ-khưu, như vậy tư niệm Phật, tư niệm Pháp và Tăng;
Bhayaṃ vā chambhitattaṃ vā, lomahaṃso na hessati. [8.705]
Sợ hãi hay hoảng hốt, hay lông tóc dựng ngược, không bao giờ khởi lên.`
},

{
    id: 'Āṭānāṭiya', title: '8. Āṭānāṭiyasutta', title_vn: '8. Kinh Āṭānāṭiya', audio: '08-Atanatiyasutta.mp3',
    text: `Appasannehi Nāthassa, sāsane sādhusammate; [11.791]
Vì khiến kẻ vô tín, phải tôn kính Phật Pháp;
Amanussehi caṇḍehi, sadā kibbisakāribhi. [7.675]
Hàng phi nhân tàn ác, những ai hay phạm tội.
Parisānaṃ catassannaṃ, ahiṃsāya ca guttiyā; [7.397]
Khiến hộ trì vô hại, cho bốn đôi Tăng chúng;
Yaṃ desesi Mahāviro, parittaṃ taṃ bhaṇāma he. [8.115]
Chúng ta hãy tụng lên, kinh của Đấng Đại Hùng.

Vipassissa ca namatthu, cakkhumantassa sirīmato; [6.407]
Ðảnh lễ Vipassī, sáng suốt và huy hoàng!
Sikhissapi ca namatthu, sabbabhūtānukampino. [6.220]
Ðảnh lễ Đấng Sikhī, có lòng thương muôn loài!
Vessabhussa ca namatthu, nhātakassa tapassino; [5.799]
Ðảnh lễ Vessabha, thanh tịnh, tu khổ hạnh!
Namatthu kakusandhassa, mārasenāpamaddino. [6.361]
Ðảnh lễ Kakusandha, vị nhiếp phục ma quân!
Koṇāgamanassa namatthu, brāhmaṇassa vusīmato; [6.155]
Ðảnh lễ Koṇāgamana, Bà-la-môn viên mãn!
Kassapassa ca namatthu, vippamuttassa sabbadhi. [5.753]
Ðảnh lễ Kassapa, vị giải thoát muôn mặt!
Aṅgīrasassa namatthu, sakyaputtassa sirīmato; [6.314]
Ðảnh lễ Angīrasa, vị Thích tử huy hoàng,
Yo imaṃ dhammaṃ desesi, sabbadukkhāpanūdanaṃ. [7.389]
Đã thuyết chân diệu pháp, diệt trừ mọi khổ đau!

Ye cāpi nibbutā loke, yathābhūtaṃ vipassisuṃ; [7.226]
Ai yểm ly thế giới, nhìn đời đúng như chân;
Te janā apisuṇātha mahantā vītasāradā. [6.828]
Vị ấy không hai lưỡi, bậc vĩ đại thanh thoát.
Hitaṃ devamanussānaṃ yaṃ namassanti Gotamaṃ; [6.477]
Cùng đảnh lễ Gotama, lo an lạc nhân thiên;
Vijjācaraṇasampannaṃ mahantaṃ vītasāradaṃ. [6.618]
Trì giới đức viên mãn, bậc vĩ đại thanh thoát!

Ete caññe ca sambuddhā, anekasatakoṭiyo; [6.828]
Ngài cùng chư Chánh Giác, ngàn vạn vị như thế;
Sabbe Buddhā samasamā, sabbe Buddhā mahiddhikā. [6.805]
Tất cả lực chư Phật, thảy tương đồng như nhau.
Sabbe dasabalūpetā, vesārajjehupāgatā; [6.384]
Chư Phật có mười lực, đạt đến nơi không sợ;
Sabbe te paṭijānanti, āsabhaṃ ṭhānamuttamaṃ. [6.898]
Các Ngài đều tuyên thuyết, nơi tối thượng Ngưu Vương.
Sīhanādaṃ nadantete, parisāsu visāradā; [6.244]
Các Ngài giữa hội chúng, rống lên tiếng sư tử;
Brahmacakkaṃ pavattenti, loke appaṭivattiyaṃ. [6.477]
Chuyển vận tại thế gian, bánh xe Pháp bất thối.

Upetā Buddha dhammehi, aṭṭhārasahi nāyakā; [6.477]
Các Đức Đạo Sư ấy, đủ mười tám Pháp Phật;
Bāttiṃsalakkhaṇupeta, sītānubyañjanādharā. [6.968]
Ba mươi hai tướng tốt, cùng tám mươi tướng phụ.
Byāmappabhāya suppabhā, sabbe te munikuñjarā; [6.992]
Hào quang tỏa một tầm, các Ngài dòng Mâu-Ni;
Buddhā sabbaññuno ete, sabbe khīṇāsavā jinā. [7.343]
Bậc có tất cả trí, đã chiến thắng, lậu tận.
Mahāpabhā mahātejā, mahāpaññā mahabbalā; [6.454]
Sáng ngời uy lực lớn, trí tuệ cùng từ bi;
Mahākāruṇikā dhīrā, sabbesānaṃ sukhāvahā. [6.688]
Lực ấy lớn rộng khắp, các vị Đấng phúc lành!

Dīpā nāthā patiṭṭhā ca, tāṇā leṇā ca pāṇinaṃ; [7.039]
Là hải đảo lánh nạn, là dòng tộc đại an;
Gatī bandhu mahassāsā, saraṇā ca hitesino. [7.647]
Là nơi dừng nhiêu ích, chúng sanh quay về nương.
Sadevakassa lokassa, sabbe ete parāyaṇā; [6.781]
Các Đức Phật đều là, nơi nhân Thiên nương tựa.
Tesāhaṃ sirasā pāde, vandāmi purisuttame. [7.460]
Con đê đầu lễ kính, dưới chân bậc Thượng Sĩ.

Vacasā manasā ceva, vandāmete Tathāgate; [6.665]
Thông qua ý cùng lời, lễ kính chư Như Lai;
Sayane āsane ṭhāne, gamane cāpi sabbadā. [6.898]
Trong tất cả mọi thời, đi, đứng hay nằm ngồi.
Sadā sukkhena rakkhantu, Buddhā santikarā tuvaṃ; [6.594]
Nguyện chư Phật tịch tịnh, gia hộ con bình an;
Tehi tvaṃ rakkhito santo, mutto sabbabhayehi ca. [7.202]
Nguyện các Ngài bảo hộ, con thoát điều sợ hãi.
Sabbarogā vinīmutto, sabbasantāpa vajjito; [6.898]
Tất cả tật bệnh hết, lánh xa điều phiền não;
Sabbaveramatikkanto, nibbuto ca tuvaṃ bhava. [6.999]
Chinh phục các oán hận, mong con sống tĩnh an.

Tesaṃ saccena sīlena, khantimettābalena ca; [7.061]
Con dùng lời chân thật, nhờ sức nhẫn và từ bi;
Tepi amhenurakkhantu, arogena sukhena ca. [7.269]
Nguyện các Ngài gia hộ, con bình an, hạnh phúc.

Puratthimasmiṃ disābhāge, santi bhūtā mahiddhikā; [7.231]
Ở về nơi hướng Đông, có chư thần đại lực;
Tepi amhenurakkhantu, arogena sukhena ca. [7.202]
Nguyện các vị hộ trì, con bình an, hạnh phúc.
Dakkhiṇasmim disābhāge, santi devā mahiddhikā; [7.008]
Ở về nơi hướng Nam, có chư Thiên đại lực;
Tepi amhenurakkhantu, arogena sukhena ca. [7.620]
Nguyện các vị hộ trì, con bình an, hạnh phúc.
Pacchimasmiṃ disābhāge, santi nāgā mahiddhikā; [7.397]
Ở về nơi hướng Tây, có chư Rồng đại lực;
Tepi amhenurakkhantu, arogena sukhena ca. [7.147]
Nguyện các vị hộ trì, con bình an, hạnh phúc.
Uttarasmiṃ disābhāge, santi yakkhā mahiddhikā; [7.008]
Ở về nơi hướng Bắc, có Dạ Xoa đại lực;
Tepi amhenurakkhantu, arogena sukhena ca. [7.286]
Nguyện các vị hộ trì, con bình an, hạnh phúc.

Puratthimena Dhataraṭṭho, dakkhiṇena Virūḷhako; [6.785]
Đông: Thiên vương Trì Quốc; Nam: Thiên vương Tăng Trưởng ;
Pacchimena Virūpakkho, Kuvero uttaraṃ disaṃ. [6.618]
Tây: Thiên vương Quảng Mục; Bắc: Thiên vương Kuvera.
Cattāro te mahārājā, lokapālā yasassino; [7.147]
Bốn vị đại Thiên vương, có danh hộ thế gian;
Tepi amhenurakkhantu, arogena sukhena ca. [7.063]
Nguyện các vị hộ trì, con bình an hạnh phúc.

Ākāsaṭṭhā ca bhūmaṭṭha, devā nāgā mahiddhikā; [7.230]
Chư Thiên, Long đại lực, nơi hư không mặt đất;
Tepi amhenurakkhantu, arogena sukhena ca. [7.008]
Nguyện các vị hộ trì, con bình an hạnh phúc.
Iddhimanto ca ye devā, vasantā idha sāsane; [6.507]
Chư Thiên có thần thông, sống trong giáo pháp này;
Tepi amhenurakkhantu, arogena sukhena ca. [7.063]
Nguyện các vị hộ trì, con bình an hạnh phúc.

Sabbītiyo vivajjantu, soko rogo vinassatu; [6.674]
Nguyện tai họa lánh xa, tật bệnh, ưu sầu hết;
Mā te bhavantvantarāyā, sukhī dīghāyuko bhava. [7.453]
Nguyện con không chướng ngại, được an ổn, sống lâu.
Abhivādanasīlissa, niccaṃ vuḍḍhāpacāyino; [6.702]
Ai thường hay kính lễ, đến những bậc đáng kính;
Cattāro dhammā vaḍḍhanti, āyu vaṇṇo sukhaṃ balaṃ. [8.698]
Được tăng trưởng bốn pháp: vui, đẹp, khỏe và thọ.`
},

{
    id: 'Aṅgulimāla', title: '9. Aṅgulimālasutta', title_vn: '9. Kinh Aṅgulimāla', audio: '09-Angulimalasutta.mp3',
    text: `Parittaṃ yaṃ bhaṇantassa, nisinnaṭṭhānadhovanaṃ; [8.098]
Ngay cả nước để rửa chỗ ngồi của vị đã nói lên Hộ kinh này,
Udakampi vināseti, sabbameva parissayaṃ. [5.501]
Cũng có thể làm tiêu tan tất cả những tai ương;
Sotthinā gabbhavuṭṭhānaṃ, yañca sādheti taṅkhaṇe; [6.204]
Và đem lại sự khai nở dễ dàng tức thì cho sanh phụ.
Therassaṅgulimalassa, Lokanāthena bhāsitaṃ; [5.653]
Đây là bài kinh được Đấng Bảo Hộ dạy cho Tôn giả Aṅgulimāla,
Kappaṭṭhāyiṃ mahātejaṃ, parittaṃ taṃ bhaṇāma he. [7.299]
Này chư hiền, chúng ta hãy tụng lên bài hộ kinh này, có oai lực cho đến mãn kiếp.

“Yatohaṃ, bhagini, ariyāya jātiyā jāto, [5.929]
“Hỡi hiền tỷ! Từ khi tôi được sanh vào dòng Thánh đến nay,
Nābhijānāmi sañcicca pāṇaṃ jīvitā voropetā, [6.754]
Tôi chưa bao giờ cố ý giết hại mạng sống của chúng sanh.
Tena saccena sotthi te hotu, sotthi gabbhassa.” [6.648]
Mong với sự thật này, hiền tỷ được an lành, thai sản được an lành.”`
},

{
    id: 'Bojjhaṅga', title: '10. Bojjhaṅgasutta', title_vn: '10. Hộ Kinh Giác Chi', audio: '10-Bojjhangasutta.mp3',
    text: `Saṃsāre saṃsarantānaṃ, sabbadukkhavināsane; [9.683]
Đã hủy diệt mọi khổ, luân lưu trong luân hồi,
Satta dhamme ca bojjhaṅge, mārasenāpamaddane. [6.617]
Các pháp thất giác chi (của những vị hiền trí), đã đại thắng binh ma,
Bujjhitvā ye cime sattā, tibhavā muttakuttamā; [6.213]
Và khi đã liễu thông, bảy chi pháp giác ngộ, đã vượt thoát tam hữu;
Ajātimajarābyādhiṃ, amataṃ nibbhayaṃ gatā. [6.899]
Đạt vô úy bất tử, không sanh già bệnh chết.
Evamādi guṇūpetaṃ, anekaguṇasaṅgahaṃ; [6.334]
Đầy đủ vô số đức, những đức ấy ví như:
Osadhañca imaṃ mantaṃ, bojjhaṅgañca bhaṇāma he. [6.859]
Phương thảo dược, linh chú, này hỡi các hiền giả, cùng chúng tôi trì tụng, bài hộ kinh giác chi.

Bojjhaṅgo sati saṅkhāto, dhammānaṃ vicayo tathā; [6.576]
Các pháp thất giác chi, gồm có Niệm giác chi, và Trạch pháp giác chi;
Vīriyaṃ pīti passaddhi, bojjhaṅgā ca tathāpare. [6.738]
Thêm nữa là giác chi: Tinh tấn, Hỷ, Khinh an;
Samādhupekkhā bojjhaṅgā, sattete sabbadassinā; [7.101]
Định và Xả giác chi, bảy pháp giác chi ấy, đã được Bậc Toàn Giác;
Muninā sammadakkhātā, bhāvitā bahulīkatā. [6.536]
Bậc Đại Hiền khéo giảng, nếu được khéo thực hành, thực hành cho thuần thục;
Saṃvattanti abhiññāya, nibbānāya ca bodhiyā; [6.576]
Mang lại các thắng trí, Niết Bàn, đạo quả tuệ;
Etena saccavajjena, sotthi te hotu sabbadā. [6.576]
Mong lời chân thật này, người hằng được an lành.

Ekasmiṃ samaye Nātho, Moggallānañca Kassapaṃ; [6.193]
Một thuở, Bậc Đạo Sư, thấy hai vị trưởng lão, Ngài Moggallāna và ngài Kassapa;
Gilāne dukkhite disvā, bojjhaṅge satta desayi. [6.576]
Lâm bệnh nặng khổ thân, Phật bèn thuyết giác chi.
Te ca taṃ abhinanditvā, rogā mucciṃsu taṅkhaṇe; [6.819]
Thất giác chi được thuyết, các tôn giả hoan hỷ, bệnh tức khắc lành ngay;
Etena saccavajjena, sotthi te hotu sabbadā. [6.758]
Mong lời chân thật này, người hằng được an lành.

Ekadā Dhammarājāpi, gelaññenābhipīḷito; [6.375]
Một thuở Đấng Pháp Vương, thọ khổ thân trầm trọng;
Cundattherena taṃyeva, bhaṇāpetvāna sādaraṃ. [6.819]
Cũng vậy đức Cunda, cung kính tụng giác chi,
Sammoditvāna ābādhā, tamhā vuṭṭhāsi ṭhānaso, [6.980]
Khiến Phật-Đà hoan hỷ, bệnh liền khỏi tức thì;
Etena saccavajjena, sotthi te hotu sabbadā. [6.597]
Mong lời chân thật này, người hằng được an lành.

Pahīnā te ca ābādhā, tiṇṇannampi mahesinaṃ; [6.718]
Bệnh hoàn toàn dứt hẳn, với ba bậc Đại Sĩ;
Maggahatā kilesāva, pattānuppattidhammataṃ; [6.617]
Phiền não nào đoạn tuyệt, bởi đạo tuệ nào rồi, không còn sinh trở lại;
Etena saccavajjena, sotthi te hotu sabbadā. [7.806]
Mong lời chân thật này, người hằng được an lành.`
},

{
    id: 'Pubbaṇha', title: '11. Pubbaṇhasutta', title_vn: '11. Kinh Ban Mai', audio: '11-Pubbanhasutta.mp3',
    text: `Yaṃ dunnimittaṃ avamaṅgalañca, yo cāmanāpo sakuṇassa saddo; [11.880]
Những điềm triệu bất tường, tiếng điểu thú bi ai, những mộng mị chẳng lành, các nghịch duyên trở ngại,
Pāpaggaho dussupinaṃ akantaṃ, Buddhānubhāvena vināsamentu [9.306]
Nhờ uy linh Phật bảo, mong những nguy hại ấy, thảy đều mau tan biến.
Yaṃ dunnimittaṃ avamaṅgalañca, yo cāmanāpo sakuṇassa saddo; [8.147]
Những điềm triệu bất tường, tiếng điểu thú bi ai, những mộng mị chẳng lành, các nghịch duyên trở ngại,
Pāpaggaho dussupinaṃ akantaṃ, Dhammānubhāvena vināsamentu [9.052]
Nhờ uy linh Pháp bảo, mong những nguy hại ấy, thảy đều mau tan biến.
Yaṃ dunnimittaṃ avamaṅgalañca, yo cāmanāpo sakuṇassa saddo; [8.090]
Những điềm triệu bất tường, tiếng điểu thú bi ai, những mộng mị chẳng lành, các nghịch duyên trở ngại,
Pāpaggaho dussupinaṃ akantaṃ, Saṅghānubhāvena vināsamentu [9.363]
Nhờ uy linh Tăng bảo, mong những nguy hại ấy, thảy đều mau tan biến.
Dukkhappattā ca nidukkhā, bhayappattā ca nibbhayā; [6.308]
Đang khổ xin hết khổ, đang nguy dứt hiểm nguy,
Sokappattā ca nissokā, hontu sabbepi pāṇino. [6.647]
Đang sầu hết sầu bi, nguyện cầu cho muôn loài.
Ettāvatā ca amhehi sambhataṃ puññasampadaṃ; [6.619]
Do nói lời tán thán, công đức của chúng tôi.
Sabbe devānumodantu sabbasampattisiddhiyā. [6.327]
Nguyện tất cả Thiên thần, tựu thành mọi Thiên lạc.
Dānaṃ dadantu saddhāya, sīlaṃ rakkhantu sabbadā; [6.674]
Hãy cho với niềm tin (Nghiệp-quả và Tam Bảo), giới hạnh năng nghiêm trì,
Bhāvanābhiratā hontu, gacchantu devatāgatā. [6.541]
Hoan hỉ Pháp tăng thượng. Thiên giả nào đã đến, lắng nghe hộ kinh này, tùy hỷ công đức rồi, xin phản hồi Thiên sứ.
Sabbe Buddhā balappattā, paccekānañca yaṃ balaṃ; [6.922]
Chư Toàn Giác đại lực, Chư Độc Giác đại lực,
Arahantānañca tejena, rakkhaṃ bandhāmi sabbaso. [7.493]
Thanh Văn Giác đại lực, nguyện tổng trì uy đức, gia hộ con an lành.
Yaṃ kiñci vittaṃ idha vā huraṃ vā, saggesu vā yaṃ ratanaṃ paṇītaṃ; [9.300]
Phàm có tài sản gì, đời này hay đời sau, hay ở tại Thiên giới, có châu báu thù thắng,
Na no samaṃ atthi tathāgatena, [4.662]
Không gì sánh bằng được, với Như Lai Thiện Thệ,
Idampi Buddhe ratanaṃ paṇītaṃ; etena saccena suvatthi hotu. [8.991]
Như vậy nơi Đức Phật, là châu báu thù diệu, mong với sự thật này, mọi loài được hạnh phúc.
Yaṃ kiñci vittaṃ idha vā huraṃ vā, saggesu vā yaṃ ratanaṃ paṇītaṃ; [9.039]
Phàm có tài sản gì, đời này hay đời sau, hay ở tại Thiên giới, có châu báu thù thắng,
Na no samaṃ atthi tathāgatena, [4.329]
Không gì sánh bằng được, với Như Lai Thiện Thệ,
Idampi Dhamme ratanaṃ paṇītaṃ; etena saccena suvatthi hotu. [8.634]
Như vậy nơi đức Pháp, là châu báu thù diệu, mong với sự thật này, mọi loài được hạnh phúc.
Yaṃ kiñci vittaṃ idha vā huraṃ vā, saggesu vā yaṃ ratanaṃ paṇītaṃ; [9.015]
Phàm có tài sản gì, đời này hay đời sau, hay ở tại Thiên giới, có châu báu thù thắng,
Na no samaṃ atthi tathāgatena, [4.353]
Không gì sánh bằng được, với Như Lai Thiện Thệ,
Idampi Saṅghe ratanaṃ paṇītaṃ; etena saccena suvatthi hotu. [8.991]
Như vậy nơi đức Tăng, là châu báu thù diệu, mong với sự thật này, mọi loài được hạnh phúc.
Bhavatu sabbamaṅgalaṃ, rakkhantu sabbadevatā; [5.614]
Nguyện người trọn hạnh phúc, và chư Thiên che chở,
Sabba Buddhānubhāvena, sadā sukhī bhavantu te. [6.946]
Nhờ tất cả uy Phật, mong người hằng an lành.
Bhavatu sabbamaṅgalaṃ, rakkhantu sabbadevatā; [5.471]
Nguyện người trọn hạnh phúc, và chư Thiên che chở,
Sabba Dhammānubhāvena, sadā sukhī bhavantu te. [6.850]
Nhờ tất cả uy Pháp, mong người hằng an lành.
Bhavatu sabbamaṅgalaṃ, rakkhantu sabbadevatā; [5.471]
Nguyện người trọn hạnh phúc, và chư Thiên che chở,
Sabba Saṅghānubhāvena, sadā sukhī bhavantu te. [7.231]
Nhờ tất cả uy Tăng, mong người hằng an lành.
Mahākāruṇiko Nātho, hitāya sabbapāṇinaṃ; [6.327]
Đấng đại bi cứu khổ, vì lợi ích chúng sanh,
Pūretvā pāramī sabbā, patto sambodhimuttamaṃ; [5.851]
Huân tu ba la mật, chứng Vô Thượng Chánh Giác,
Etena saccavajjena, sotthi te hotu sabbadā. [7.017]
Nhờ với chân ngôn này, mong người được an lành.
Jayanto bodhiyā mūle, Sakyānaṃ nandivaḍḍhano, [6.565]
Vị đạt đến tối thắng, khiến vương tộc Thích Ca, tăng trưởng niềm hoan hỷ;
Evameva jayo hotu, jayassu jayamaṅgale. [6.184]
Bên cội cây Bồ Đề, trên bồ đoàn bất thối,
Aparājitapallaṅke, sīse puthuvipukkhale, [6.022]
Nơi Chư Phật lên ngôi, địa cầu Liên Hoa đỉnh.
Abhiseke sabbabuddhānaṃ, aggappatto pamodati. [6.660]
Mong người cũng chiến thắng, và khải hoàn như vậy. 
(Ngày nào hành thập thiện, ba hạnh nghiệp thanh tịnh)
Sunakkhattaṃ sumaṅgalaṃ suppabhātaṃ suhuṭṭhitaṃ; [6.755]
Đó là ngày cát tường, ngày có sao vận lành, có bình minh tốt đẹp, có thức giấc an lành,
Sukhaṇo sumuhutto ca, suyiṭṭhaṃ brahmacārisu. [6.589]
Mỗi giờ phút hưng thịnh, mỗi giây khắc hanh thông, cúng dường bậc phạm hạnh, là tế tự nhiệm mầu.
Padakkhiṇaṃ kāyakammaṃ vācākammaṃ padakkhiṇaṃ [6.303]
(Trong những ngày như vậy) Có hành động chân chánh, có lời nói an lành,
Padakkhiṇaṃ manokammaṃ paṇīdhi te padakkhiṇe. [6.280]
Trong sáng là ý nghĩ, ba nghiệp được tốt đẹp,
Padakkhiṇāni katvāna, labhantatthe padakkhiṇe. [6.042]
Thực hành điều tốt đẹp, thời đạt nhiều lợi ích,
Te atthaladdhā sukhitā viruḷhā Buddhasāsane; [7.112]
Nguyện cầu đến cho người, cùng thân bằng quyến thuộc, đạt lợi ích an vui,
Arogā sukhitā hotha, saha sabbehi ñātibhi. [8.455]
Vô bệnh được an lạc, tấn tu trong Pháp Phật.`
},

{
    id: 'Anekajati', title: 'Anekajāti Pāḷi ', title_vn: 'Kệ Khải Hoàn', audio: '12-Anekajati.mp3',
    text: `Namo tassa bhagavato arahato sammāsambuddhassa. [11.002]
Thành kính đảnh lễ Ngài, Thế Tôn, A-la-hán, Đấng Toàn Tri Diệu Giác.
Namo tassa bhagavato arahato sammāsambuddhassa. [11.596]
Thành kính đảnh lễ Ngài, Thế Tôn, A-la-hán, Đấng Toàn Tri Diệu Giác.
Namo tassa bhagavato arahato sammāsambuddhassa. [11.299]
Thành kính đảnh lễ Ngài, Thế Tôn, A-la-hán, Đấng Toàn Tri Diệu Giác.

Anekajātisaṃsāraṃ, sandhāvissaṃ anibbisaṃ; [7.582]
Luân hồi bao kiếp sống, tìm người làm nhà này, tìm mãi mà không gặp,
gahakāraṃ gavesanto, dukkhā jāti punappunaṃ. [7.211]
tái sanh hoài khổ thay.
gahakāraka diṭṭhosi, puna gehaṃ na kāhasi; [6.467]
Này hỡi người thợ kia, ngươi bị nhận diện rồi, nhà xây sao được nữa,
sabbā te phāsukā bhaggā, gahakūṭaṃ visaṅkhataṃ; [6.765]
rường cột ngươi bị gãy, rui mè đã tiêu vong,
visaṅkhāragataṃ cittaṃ, taṇhānaṃ khayamajjhagā. [7.359]
tâm ta chứng vô vi, mọi tham ái tận diệt.

Anekajātisaṃsāraṃ, sandhāvissaṃ anibbisaṃ; [6.839]
Luân hồi bao kiếp sống, tìm người làm nhà này, tìm mãi mà không gặp,
gahakāraṃ gavesanto, dukkhā jāti punappunaṃ. [6.542]
tái sanh hoài khổ thay.
gahakāraka diṭṭhosi, puna gehaṃ na kāhasi; [5.872]
Này hỡi người thợ kia, ngươi bị nhận diện rồi, nhà xây sao được nữa,
sabbā te phāsukā bhaggā, gahakūṭaṃ visaṅkhataṃ; [6.467]
rường cột ngươi bị gãy, rui mè đã tiêu vong,
visaṅkhāragataṃ cittaṃ, taṇhānaṃ khayamajjhagā. [6.839]
tâm ta chứng vô vi, mọi tham ái tận diệt.

Anekajātisaṃsāraṃ, sandhāvissaṃ anibbisaṃ; [6.170]
Luân hồi bao kiếp sống, tìm người làm nhà này, tìm mãi mà không gặp,
gahakāraṃ gavesanto, dukkhā jāti punappunaṃ. [6.557]
tái sanh hoài khổ thay.
gahakāraka diṭṭhosi, puna gehaṃ na kāhasi; [5.569]
Này hỡi người thợ kia, ngươi bị nhận diện rồi, nhà xây sao được nữa,
sabbā te phāsukā bhaggā, gahakūṭaṃ visaṅkhataṃ; [6.188]
rường cột ngươi bị gãy, rui mè đã tiêu vong,
visaṅkhāragataṃ cittaṃ, taṇhānaṃ khayamajjhagā. [6.895]
tâm ta chứng vô vi, mọi tham ái tận diệt.

Iti imasmiṃ sati idaṃ hoti, imassuppādā idaṃ uppajjati, [10.254]
Do cái này có, cái kia hiện hữu. Do cái này sanh, cái kia sanh. Tức là-
yadidaṃ – avijjāpaccayā saṅkhārā, saṅkhārapaccayā viññāṇaṃ, [7.205]
duyên vô minh, có các hành; duyên các hành, có thức;
viññāṇapaccayā nāmarūpaṃ, nāmarūpapaccayā saḷāyatanaṃ, [7.116]
duyên thức, có danh sắc; duyên danh sắc, có sáu xứ;
saḷāyatanapaccayā phasso, phassapaccayā vedanā, [6.055]
duyên sáu xứ, có xúc; duyên xúc, có thọ;
vedanāpaccayā taṇhā, taṇhāpaccayā upādānaṃ, [6.100]
duyên thọ, có ái; duyên ái, có thủ;
upādānapaccayā bhavo, bhavapaccayā jāti, [5.569]
duyên thủ, có hữu; duyên hữu, có sanh;
jātipaccayā jarāmaraṇaṃ sokaparidevadukkhadomanassupāyāsā sambhavanti. [8.707]
duyên sanh, có lão, tử, sầu, bi, khổ, ưu, não.
Evametassa kevalassa dukkhakkhandhassa samudayo hoti. [7.558]
Như vậy là sự tập khởi của toàn bộ khổ uẩn này.

Yadā have pātubhavanti dhammā; ātāpino jhāyato brāhmaṇassa; [7.823]
Thật sự khi các pháp, có mặt hiện khởi lên, cho vị Bà-la-môn, nhiệt tâm hành thiền định,
athassa kaṅkhā vapayanti sabbā; yato pajānāti sahetudhammaṃ. [8.707]
Khi ấy với vị ấy, các nghi hoặc tiêu trừ, vì biết rõ hoàn toàn, Pháp cùng với các nhân.

Iti imasmiṃ asati idaṃ na hoti, imassa nirodhā idaṃ nirujjhati, [9.989]
Do cái này không có, cái kia không hiện hữu. Do cái này diệt, cái kia diệt. Tức là-
yadidaṃ – avijjānirodhā saṅkhāranirodho, [5.437]
do vô minh diệt nên hành diệt;
saṅkhāranirodhā viññāṇanirodho, [4.420]
do hành diệt, nên thức diệt;
viññāṇanirodhā nāmarūpanirodho, [4.420]
do thức diệt nên danh sắc diệt;
nāmarūpanirodhā saḷāyatananirodho, [5.171]
do danh sắc diệt nên sáu xứ diệt;
saḷāyatananirodhā phassanirodho, [4.243]
do sáu xứ diệt nên xúc diệt,
phassanirodhā vedanānirodho, [3.845]
do xúc diệt nên thọ diệt,
vedanānirodhā taṇhānirodho, [4.022]
do thọ diệt nên ái diệt;
taṇhānirodhā upādānanirodho, [4.15]
do ái diệt nên thủ diệt;
upādānanirodhā bhavanirodho, [4.376]
do thủ diệt nên hữu diệt;
bhavanirodhā jātinirodho, [3.669]
do hữu diệt nên sanh diệt;
jātinirodhā jarāmaraṇaṃ sokaparidevadukkhadomanassupāyāsā nirujjhanti. [7.823]
do sanh diệt nên lão, tử, sầu, bi, khổ, ưu, não diệt.
Evametassa kevalassa dukkhakkhandhassa nirodho hoti. [6.763]
Như vậy là đoạn diệt của toàn bộ khổ uẩn này.

Yadā have pātubhavanti dhammā; ātāpino jhāyato brāhmaṇassa; [6.984]
Thật sự khi các pháp, có mặt hiện khởi lên, cho vị Bà-la-môn, nhiệt tâm hành thiền định,
athassa kaṅkhā vapayanti sabbā; yato khayaṃ paccayānaṃ avedi. [7.691]
Khi ấy với vị ấy, các nghi hoặc tiêu trừ, vì đã biết hoàn toàn, sự chấm dứt các duyên.

Iti imasmiṃ sati idaṃ hoti, imassuppādā idaṃ uppajjati, [9.459]
Do cái này có, cái kia hiện hữu. Do cái này sanh, cái kia sanh.
imasmiṃ asati idaṃ na hoti, imassa nirodhā idaṃ nirujjhati, [9.238]
Do cái này không có, cái kia không hiện hữu. Do cái này diệt, cái kia diệt. Tức là-
yadidaṃ – avijjāpaccayā saṅkhārā, saṅkhārapaccayā viññāṇaṃ, [6.807]
duyên vô minh, có các hành; duyên các hành, có thức;
viññāṇapaccayā nāmarūpaṃ, nāmarūpapaccayā saḷāyatanaṃ, [6.674]
duyên thức, có danh sắc; duyên danh sắc, có sáu xứ;
saḷāyatanapaccayā phasso, phassapaccayā vedanā, [5.613]
duyên sáu xứ, có xúc; duyên xúc, có thọ;
vedanāpaccayā taṇhā, taṇhāpaccayā upādānaṃ, [5.702]
duyên thọ, có ái; duyên ái, có thủ;
upādānapaccayā bhavo, bhavapaccayā jāti, [5.171]
duyên thủ, có hữu; duyên hữu, có sanh;
jātipaccayā jarāmaraṇaṃ sokaparidevadukkhadomanassupāyāsā sambhavanti. [7.868]
duyên sanh, có lão, tử, sầu, bi, khổ, ưu, não.
Evametassa kevalassa dukkhakkhandhassa samudayo hoti. [6.497]
Như vậy là sự tập khởi của toàn bộ khổ uẩn này.

Avijjāya tveva asesavirāganirodhā saṅkhāranirodho, [6.674]
Nhờ đoạn diệt viễn li mọi dục tham, do vô minh diệt nên hành diệt;
saṅkhāranirodhā viññāṇanirodho, [4.420]
do hành diệt, nên thức diệt;
viññāṇanirodhā nāmarūpanirodho, [4.464]
do thức diệt nên danh sắc diệt;
nāmarūpanirodhā saḷāyatananirodho, [4.774]
do danh sắc diệt nên sáu xứ diệt;
saḷāyatananirodhā phassanirodho, [4.022]
do sáu xứ diệt nên xúc diệt,
phassanirodhā vedanānirodho, [3.713]
do xúc diệt nên thọ diệt,
vedanānirodhā taṇhānirodho, [3.978]
do thọ diệt nên ái diệt;
taṇhānirodhā upādānanirodho, [4.022]
do ái diệt nên thủ diệt;
upādānanirodhā bhavanirodho, [3.757]
do thủ diệt nên hữu diệt;
bhavanirodhā jātinirodho, [3.934]
do hữu diệt nên sanh diệt;
jātinirodhā jarāmaraṇaṃ sokaparidevadukkhadomanassupāyāsā nirujjhanti. [8.531]
do sanh diệt nên lão, tử, sầu, bi, khổ, ưu, não diệt.
Evametassa kevalassa dukkhakkhandhassa nirodho hoti. [6.674]
Như vậy là đoạn diệt của toàn bộ khổ uẩn này.

Yadā have pātubhavanti dhammā; ātāpino jhāyato brāhmaṇassa; [7.072]
Thật sự khi các pháp, có mặt hiện khởi lên, cho vị Bà-la-môn, nhiệt tâm hành thiền định,
vidhūpayaṃ tiṭṭhati mārasenaṃ; sūriyova obhāsayamantalikkhaṃ. [7.956]
Quét sạch các ma quân, vị ấy đứng, an trú, như ánh sáng mặt trời, chói sáng khắp hư không.

Hetupaccayo, ārammaṇapaccayo, [4.685]
Nhân duyên, Cảnh duyên,
adhipatipaccayo, anantarapaccayo, [4.155]
Trưởng duyên, Vô Gián duyên,
samanantarapaccayo, sahajātapaccayo, [4.597]
Ðẳng Vô Gián duyên, Ðồng Sinh duyên,
aññamaññapaccayo, nissayapaccayo, [4.376]
Hỗ Tương duyên, Y Chỉ duyên,
upanissayapaccayo, purejātapaccayo, [4.553]
Cận Y duyên, Tiền Sinh Y duyên,
pacchājātapaccayo, āsevanapaccayo, [4.553]
Hậu Sinh duyên, Tập Hành duyên,
kammapaccayo, vipākapaccayo, [4.155]
Nghiệp duyên, Dị Thục duyên,
āhārapaccayo, indriyapaccayo, [4.199]
Vật Thực duyên, Căn Quyền duyên,
jhānapaccayo, maggapaccayo, [3.713]
Thiền Na duyên, Ðạo duyên,
sampayuttapaccayo, vippayuttapaccayo, [4.243]
Tương Ưng duyên, Bất Tương Ưng duyên,
atthipaccayo, natthipaccayo, [3.536]
Hiện Hữu duyên, Vô Hữu duyên,
vigatapaccayo, avigatapaccayoti. [5.486]
Ly duyên, Bất Ly duyên.Jayanto bodhiyā mūle, Sakyānaṃ nandivaḍḍhano, [6.000]
Vị đạt đến tối thắng, khiến vương tộc Thích Ca, tăng trưởng niềm hoan hỷ;
Evameva jayo hotu, jayassu jayamaṅgale. [5.426]
Bên cội cây Bồ Đề, trên bồ đoàn bất thối,
Aparājitapallaṅke, sīse puthuvipukkhale, [5.018]
Nơi Chư Phật lên ngôi, địa cầu Liên Hoa đỉnh.
Abhiseke sabbabuddhānaṃ, aggappatto pamodati. [5.501]
Mong người cũng chiến thắng, và khải hoàn như vậy. 
(Ngày nào hành thập thiện, ba hạnh nghiệp thanh tịnh)
Sunakkhattaṃ sumaṅgalaṃ suppabhātaṃ suhuṭṭhitaṃ; [5.241]
Đó là ngày cát tường, ngày có sao vận lành, có bình minh tốt đẹp, có tỉnh giấc an vui,
sukhaṇo sumuhutto ca, suyiṭṭhaṃ brahmacārisu. [5.241]
Mỗi giờ phút hưng thịnh, mỗi giây khắc hanh thông, cúng dường bậc phạm hạnh, là tế tự nhiệm mầu.
Padakkhiṇaṃ kāyakammaṃ vācākammaṃ padakkhiṇaṃ [4.869]
(Trong những ngày như vậy) Có hành động chân chánh, có lời nói an lành,
Padakkhiṇaṃ manokammaṃ paṇīdhi te padakkhiṇe. [4.500]
Trong sáng là ý nghĩ, ba nghiệp được tốt đẹp,
Padakkhiṇāni katvāna, labhantatthe padakkhiṇe. [5.241]
Thực hành điều tốt đẹp, thời đạt nhiều lợi ích,
Te atthaladdhā sukhitā viruḷhā Buddhasāsane; [4.795]
Nguyện cầu đến cho người, cùng thân bằng quyến thuộc, đạt lợi ích an vui,
Arogā sukhitā hotha, saha sabbehi ñātibhi. [5.687]
Vô bệnh được an lạc, tấn tu trong Pháp Phật.
Bhavatu sabbamaṅgalaṃ, rakkhantu sabbadevatā; [4.980]
Nguyện người trọn hạnh phúc, và chư Thiên che chở,
Sabba Buddhānubhāvena, sadā sukhī bhavantu te. [5.612]
Nhờ tất cả uy Phật, mong người hằng an lành.
Bhavatu sabbamaṅgalaṃ, rakkhantu sabbadevatā; [4.795]
Nguyện người trọn hạnh phúc, và chư Thiên che chở,
Sabba Dhammānubhāvena, sadā sukhī bhavantu te. [5.538]
Nhờ tất cả uy Pháp, mong người hằng an lành.
Bhavatu sabbamaṅgalaṃ, rakkhantu sabbadevatā; [4.720]
Nguyện người trọn hạnh phúc, và chư Thiên che chở,
Sabba Saṅghānubhāvena, sadā sukhī bhavantu te. [6.802]
Nhờ tất cả uy Tăng, mong người hằng an lành.
Sādhu Sādhu Sādhu. [7.451]
Lành thay Lành thay Lành thay.`
},

{
    id: 'Paccavekkhaṇā', title: 'Paccavekkhaṇā', title_vn: 'Quán Tưởng (Tứ Vật Dụng)', audio: '13-Paccavekkhana.mp3',
    text: `Paṭisaṅkhā yoniso cīvaraṃ paṭisevāmi [6.660]
Chân chánh quán tưởng rằng: Ta thọ dụng y phục,
yāvadeva sītassa paṭighātāya, uṇhassa paṭighātāya, [9.399]
để ngăn ngừa nóng lạnh,
ḍaṃsa makasa vātātapa sarīsapa samphassānaṃ paṭighātāya, [8.022]
bảo vệ khỏi muỗi mòng, gió sương và mưa nắng, cùng rắn rết côn trùng,
yāvadeva hirikopīnappaṭicchādanatthaṃ. [6.560]
Và chỉ để che thân, tránh những điều hổ thẹn.

Paṭisaṅkhā yoniso piṇḍapātaṃ paṭisevāmi [5.939]
Chân chánh quán tưởng rằng: Ta thọ dụng vật thực
neva davāya, na madāya, na maṇḍanāya, na vibhūsanāya, [7.269]
không phải để vui đùa, không ham mê vô độ, không phải để trang sức, không tự làm đẹp mình,
yāvadeva imassa kāyassa ṭhitiyā [6.072]
mà chỉ để thân này được bảo trì mạnh khỏe,
yāpanāya, vihiṃsūparatiyā, brahmacariyānuggahāya, [6.737]
để tránh sự tổn thương, để trợ duyên phạm hạnh,
iti purāṇañca vedanaṃ paṭihaṅkhāmi [5.008]
cảm thọ cũ được trừ,
navañca vedanaṃ na uppādessāmi, [4.388]
thọ mới không sinh khởi,
yātrā ca me bhavissati anavajjatā ca phāsuvihāro ca. [7.491]
và sẽ không lầm lỗi, ta sống được an lành.

Paṭisaṅkhā yoniso senāsanaṃ paṭisevāmi [5.673]
Chân chánh quán tưởng rằng: ta thọ dụng liêu thất,
yāvadeva sītassa paṭighātāya, uṇhassa paṭighātāya, [8.466]
để ngăn ngừa nóng lạnh,
ḍaṃsa makasa vātātapa sarīsapa samphassānaṃ paṭighātāya, [6.914]
bảo vệ khỏi muỗi mòng, gió sương và mưa nắng, cùng rắn rết côn trùng,
yāvadeva utuparissaya vinodana paṭisallānārāmatthaṃ. [7.446]
để giải trừ nguy hiểm do phong thổ tứ thời, và chỉ với mục đích sống độc cư an tịnh.

Paṭisaṅkhā yoniso gilānappaccaya bhesajja parikkhāraṃ paṭisevāmi [7.047]
Chân chánh quán tưởng rằng: Ta thọ dụng y dược, dành cho người bệnh dùng,
yāvadeva uppannānaṃ veyyābādhikānaṃ vedanānaṃ paṭighātāya, [7.136]
để ngăn ngừa cảm thọ tàn hại đã phát sanh,
abyāpajjaparamatāya. [4.234]
được hoàn toàn bình phục.`
},

{
    id: 'Pabbajita', title: 'Pabbajita-abhiṇhasutta', title_vn: 'Kinh Pháp Sa Môn Thường Quán', audio: '14-Pabbajita-abhiṇhasutta.mp3',
    text: `Dasayime, bhikkhave, dhammā pabbajitena abhiṇhaṃ paccavekkhitabbā. [7.811]
Này các Tỳ-khưu, có mười pháp này, vị xuất gia phải luôn luôn quán sát.
Katame dasa? [3.007]
Thế nào là mười?
1. Vevaṇṇiyamhi ajjhupagato"ti [4.151]
1. "Ta nay đi đến tình trạng là người không có giai cấp" (mất hết giai cấp)
pabbajitena abhiṇhaṃ paccavekkhitabbaṃ; [4.738]
Người xuất gia phải luôn luôn quán sát;
2. Parapaṭibaddhā me jīvikā"ti [4.025]
2. "Ðời sống của ta tùy thuộc vào người khác"
pabbajitena abhiṇhaṃ paccavekkhitabbaṃ; [4.948]
Người xuất gia phải luôn luôn quán sát;
3. Añño me ākappo karaṇīyo"ti [4.235]
3. "Nay cử chỉ uy nghi của ta cần phải thay đổi!"
pabbajitena abhiṇhaṃ paccavekkhitabbaṃ; [4.738]
Vị xuất gia cần phải luôn luôn quán sát;
4. Kacci nu kho me attā sīlato na upavadatī"ti [5.660]
4. "Không biết tự ngã có chỉ trích ta về giới hạnh không?"
pabbajitena abhiṇhaṃ paccavekkhitabbaṃ; [4.864]
Vị xuất gia cần phải luôn luôn quán sát;
5. Kacci nu kho maṃ anuvicca viññū sabrahmacārī [5.241]
5. "Không biết các đồng Phạm hạnh có trí, sau khi tìm hiểu,
sīlato na upavadantī"ti [3.857]
có chỉ trích ta về giới hạnh không?"
pabbajitena abhiṇhaṃ paccavekkhitabbaṃ; [5.053]
Vị xuất gia cần phải luôn luôn quán sát;
6. Sabbehi me piyehi manāpehi [4.151]
6. "Mọi sự vật khả ái, khả ý của ta
nānābhāvo vinābhāvo"ti [3.732]
bị đổi khác, bị biến hoại"
pabbajitena abhiṇhaṃ paccavekkhitabbaṃ; [4.822]
Vị xuất gia cần phải luôn luôn quán sát;
7. Kammassakomhi kammadāyādo kammayoni kammabandhu [7.925]
7. "Ta là chủ của nghiệp, là thừa tự của nghiệp, là thai tạng của nghiệp, là bà con của nghiệp,
kammapaṭisaraṇo, yaṃ kammaṃ karissāmi kalyāṇaṃ vā pāpakaṃ vā [7.547]
là chỗ quy hướng của nghiệp; phàm nghiệp gì ta sẽ làm, thiện hay ác
tassa dāyādo bhavissāmī"ti [3.606]
ta sẽ thừa tự nghiệp ấy."
pabbajitena abhiṇhaṃ paccavekkhitabbaṃ; [5.367]
Vị xuất gia cần phải luôn luôn quán sát;
8. Kathaṃbhūtassa me rattindivā vītivattantī"ti [5.283]
8. "Ðêm ngày trôi qua bên ta và nay ta đã thành người như thế nào?"
pabbajitena abhiṇhaṃ paccavekkhitabbaṃ; [5.451]
Vị xuất gia cần phải luôn luôn quán sát;
9. Kacci nu kho ahaṃ suññāgāre abhiramāmī"ti [5.283]
9. "Ta có cố gắng hoan hỷ trong ngôi nhà trống không hay không?"
pabbajitena abhiṇhaṃ paccavekkhitabbaṃ; [4.780]
Vị xuất gia cần phải luôn luôn quán sát;
10. Atthi nu kho me uttari manussadhammo [4.696]
10. "Ta có chứng được pháp Thượng nhân,
alamariyañāṇadassanaviseso adhigato, [4.864]
tri kiến thù thắng xứng đáng bậc Thánh không,
yenāhaṃ pacchime kāle sabrahmacārīhi puṭṭho [5.493]
để đến những ngày cuối cùng, các đồng Phạm hạnh có hỏi,
na maṅku bhavissāmī"ti [3.103]
ta sẽ không có xấu hổ?"
pabbajitena abhiṇhaṃ paccavekkhitabbaṃ. [5.241]
Vị xuất gia cần phải luôn luôn quán sát.
Ime kho, bhikkhave, dasa dhammā [3.774]
Này các Tỳ-khưu, mười pháp này,
pabbajitena abhiṇhaṃ paccavekkhitabbā. [5.710]
vị xuất gia cần phải luôn luôn quán sát.`
},
{
    id: 'Pattidana', title: 'Mettābhāvanā', title_vn: 'Hồi hướng - Chia phước', audio: '15-Pattidana.mp3',
text: `Sabbe sattā, sabbe pāṇā, [3.709]
Nguyện cho tất cả chúng sinh, tất cả hữu tình,
sabbe bhūtā, sabbe puggalā, [3.398]
tất cả sanh loại, tất cả cá nhân,
sabbe attabhāvapariyāpannā, [3.832]
tất cả cá thể,
sabbā itthiyo, sabbe purisā, [3.934]
tất cả nữ giới, tất cả nam giới,
sabbe ariyā, sabbe anariyā, [3.461]
tất cả thánh nhân, tất cả phàm nhân,
sabbe devā, sabbe manussā, [3.177]
tất cả chư thiên, tất cả nhân loại,
sabbe vinipātikā [3.238]
tất cả chúng sanh nơi bốn đoạ xứ -
averā hontu, abyāpajjā hontu, [4.470]
không còn oan trái, không còn ác ý,
anīghā hontu, sukhī attānaṃ pariharantu. [4.959]
không còn muộn phiền, giữ mình được an vui.
Dukkhā muccantu, yathāladdhasampattito [4.371]
mong cho tất cả thoát khổ đau, những gì đã thành tựu
māvigacchantu kammassakā. [4.039]
xin đừng mất, chỉ có Nghiệp là tài sản mà thôi.

Puratthimāya disāya, pacchimāya disāya, [5.343]
Trong hướng Đông, trong hướng Tây,
uttarāya disāya, dakkhiṇāya disāya, [4.882]
trong hướng Bắc, trong hướng Nam,
puratthimāya anudisāya, pacchimāya anudisāya, [5.419]
trong hướng Đông-Nam, trong hướng Tây-Bắc,
uttarāya anudisāya, dakkhiṇāya anudisāya, [5.189]
trong hướng Đông-Bắc, trong hướng Tây-Nam,
heṭṭhimāya disāya, uparimāya disāya. [5.010]
Ở dưới, ở trên.

Sabbe sattā, sabbe pāṇā, [3.604]
Nguyện cho tất cả chúng sinh, tất cả hữu tình,
sabbe bhūtā, sabbe puggalā, [3.144]
tất cả sanh loại, tất cả cá nhân,
sabbe attabhāvapariyāpannā, [3.604]
tất cả cá thể,
sabbā itthiyo, sabbe purisā, [3.655]
tất cả nữ giới, tất cả nam giới,
sabbe ariyā, sabbe anariyā, [3.528]
tất cả thánh nhân, tất cả phàm nhân,
sabbe devā, sabbe manussā, [3.093]
tất cả chư thiên, tất cả nhân loại,
sabbe vinipātikā [3.144]
tất cả chúng sanh nơi bốn đoạ xứ -
averā hontu, abyāpajjā hontu, [4.473]
không còn oan trái, không còn ác ý,
anīghā hontu, sukhī attānaṃ pariharantu. [4.985]
không còn muộn phiền, giữ mình được an vui.
Dukkhā muccantu, yathāladdhasampattito [4.473]
mong cho tất cả thoát khổ đau, những gì đã thành tựu
māvigacchantu kammassakā. [3.834]
xin đừng mất, chỉ có Nghiệp là tài sản mà thôi.

Uddhaṃ yāva bhavaggā ca, adho yāva avīcito; [5.700]
Phía trên lên mãi đến vô cùng, phía dưới đến tận A-tỳ ngục,
Samantā cakkavāḷesu, ye sattā pathavīcarā; [5.470]
Trong toàn khắp thiên hà vũ trụ, những sanh linh nào sống trên đất
Abyāpajjā niverā ca, niddukkhā cā"nuppaddavā. [5.547]
Nguyện cho tất cả không còn ác ý, nguyện cho tất cả không còn oan trái, thoát khổ đau và thoát mọi hiểm nguy.

Uddhaṃ yāva bhavaggā ca, adho yāva avīcito; [5.394]
Phía trên lên mãi đến vô cùng, phía dưới đến tận A-tỳ ngục,
Samantā cakkavāḷesu, ye sattā udakecarā; [5.521]
Trong toàn khắp thiên hà vũ trụ, những sanh linh nào sống dưới nước –
Abyāpajjā niverā ca, niddukkhā cā"nuppaddavā. [5.649]
Nguyện cho tất cả không còn ác ý, nguyện cho tất cả không còn oan trái, thoát khổ đau và thoát mọi hiểm nguy.

Uddhaṃ yāva bhavaggā ca, adho yāva avīcito; [5.343]
Phía trên lên mãi đến vô cùng, phía dưới đến tận A-tỳ ngục,
Samantā cakkavāḷesu, ye sattā ākāsecarā; [5.189]
Trong toàn khắp thiên hà vũ trụ, những sanh linh nào sống trên không –
Abyāpajjā niverā ca, niddukkhā cā"nuppaddavā. [5.496]
Nguyện cho tất cả không còn ác ý, nguyện cho tất cả không còn oan trái, thoát khổ đau và thoát mọi hiểm nguy.

Yaṃ pattaṃ kusalaṃ tassa, ānubhāvena pāṇino; [5.343]
Nhờ oai lực thiện nghiệp đã thành tựu, nguyện cho tất cả mọi sanh linh
sabbe saddhammarājassa, ñatvā dhammaṃ sukhāvahaṃ. [5.573]
hay biết Diệu Pháp mang lại an vui của Đấng Pháp Vương,
Pāpuṇantu visuddhāya, sukhāya paṭipattiyā; [5.445]
với sự hành trì an lạc, thanh tịnh,
asokamanupāyāsaṃ, nibbānasukhamuttamaṃ. [5.598]
không còn sầu khổ và bất mãn, thành tựu được Niết bàn - lạc tối thượng.

Ciraṃ tiṭṭhatu saddhammo, dhamme hontu sagāravā; [5.700]
ngưỡng mong sanh linh thành kính Pháp, nguyện cầu Diệu Pháp mãi trường tồn.
sabbepi sattā kālena, sammā devo pavassatu. [5.445]
xin Chư thiên thường làm mưa thuận gió hoà,
Yathā rakkhiṃsu porāṇā, surājāno tathevimaṃ; [5.675]
giống các vị Hiền vương xa xưa, đã bảo vệ chúng dân đúng theo Pháp,
rājā rakkhatu dhammena, attanova pajaṃ pajaṃ. [5.521]
như bảo vệ dòng dõi của chính mình.

Imāya dhammānudhammapaṭipattiyā Buddhaṃ pūjemi. [5.726]
Với sự hành Pháp tuần tự này, con xin cúng dường Phật.
Imāya dhammānudhammapaṭipattiyā Dhammaṃ pūjemi. [6.058]
Với sự hành Pháp tuần tự này, con xin cúng dường Pháp.
Imāya dhammānudhammapaṭipattiyā Saṃghaṃ pūjemi. [6.186]
Với sự hành Pháp tuần tự này, con xin cúng dường Tăng.
Addhā imāya paṭipattiyā jātijarābyādhimaraṇamhā parimuccissāmi. [7.618]
Nhất định, nhờ sự hành Pháp tuần tự này, con sẽ thoát khỏi sanh-già-bệnh-chết
Idaṃ me puññaṃ āsavakkhayā"vahaṃ hotu. [4.959]
Phước lành này của con, nguyện đoạn trừ các lậu hoặc-trầm luân
Idaṃ me puññaṃ nibbānassa paccayo hotu. [4.831]
Phước lành này của con, nguyện là duyên thành tựu được Niết bàn.
Mama puññabhāgaṃ sabbasattānaṃ bhājemi; [5.112]
Phần phước của con, xin chia đều đến tất cả sanh linh,
Te sabbe me samaṃ puññabhāgaṃ labhantu. [6.186]
Mong tất cả hãy thọ nhận phần phước ấy được đều nhau.
Sādhu Sādhu Sādhu [11.800]
Sādhu! Sādhu! Lành thay!`
}, 
		
    ];

    // --- BIẾN ---
    let globalInterval = 3000; 
    let recitationTimeout = null;
    let currentRecitationLine = 0;
    let allLines = [];
    let currentSectionIndex = 0;
	let selectedLoopIndices = new Set();
    
   let isLoopActive = false;

function toggleLoopSentence() {
    isLoopActive = !isLoopActive;
    const btn = document.getElementById('btn-loop');
    const loopOne = document.getElementById('loop-count');

    if (isLoopActive) {
        btn.classList.add('active-loop');
        loopOne.style.display = 'block'; // Show the "1"
    } else {
        btn.classList.remove('active-loop');
        loopOne.style.display = 'none'; // Hide the "1"
    }
}
    const displayArea = document.getElementById('display-area');
    const titleArea = document.getElementById('section-title');
    const sectionSelect = document.getElementById('section-select');
    const audioPlayer = document.getElementById('audioPlayer');
    const recitationToggleBtn = document.getElementById('recitation-toggle-btn');
    const settingsPanel = document.getElementById('settings-panel');
    const helpButton = document.getElementById('help-toggle');
    const helpContainer = document.getElementById('help-container');
    const symbolInfo = '<i class="fas fa-circle-info"></i>'; // Information symbol
    const symbolClose = '<i class="fas fa-xmark"></i>'; // Close symbol

    function toggleHelp() {
        const isVisible = helpContainer.style.display !== 'none';
        
        if (isVisible) {
            // Hide the container
            helpContainer.style.display = 'none';
            helpButton.innerHTML = symbolInfo; // Change back to Information symbol
            helpButton.setAttribute('aria-expanded', 'false');
        } else {
            // Show the container
            helpContainer.style.display = 'block';
            helpButton.innerHTML = symbolClose; // Change to Close symbol
            helpButton.setAttribute('aria-expanded', 'true');
        }
    }

    // Attach the function to the button's click event
    // This runs once when the script loads
    if (helpButton) {
        helpButton.addEventListener('click', toggleHelp);
    }
    // --- INIT ---
    function init() {
        
        // --- 1. TẢI CÀI ĐẶT GIAO DIỆN VÀ TỐC ĐỘ BAN ĐẦU ---
        const savedTheme = localStorage.getItem('themePreference');
        const body = document.body;
        const btn = document.querySelector('.btn-darkmode');

        if (savedTheme === 'dark') {
            body.setAttribute('data-theme', 'dark');
            if (btn) btn.innerHTML = '<i class="fas fa-sun-bright"></i>';
        } else {
             body.removeAttribute('data-theme');
             if (btn) btn.innerHTML = '<i class="fas fa-moon"></i>';
        }
        const savedDictState = localStorage.getItem('dictionaryEnabled');
        // If it is 'true' OR null (first time user), turn it ON
        if (savedDictState === 'true' || savedDictState === null) {
            isLookupEnabled = true;
            const dictBtn = document.getElementById('btn-dictionary');
            if (dictBtn) dictBtn.style.backgroundColor = "#d35400";
            // Wait slightly or call directly
            enablePaliLookup(); 
        } else {
            // Explicitly 'false'
            isLookupEnabled = false;
            // No need to set color, default is none
        }
		const savedVietState = localStorage.getItem('vietnameseEnabled');
        const vietBtn = document.getElementById('btn-viet-toggle');
        // If it is 'true' OR null (first time user), turn it ON
        if (savedVietState === 'true' || savedVietState === null) {
            displayArea.classList.add('show-translation');
            if (vietBtn) vietBtn.classList.add('btn-viet-active');
        } else {
            displayArea.classList.remove('show-translation');
            if (vietBtn) vietBtn.classList.remove('btn-viet-active');
        }
        const savedInterval = localStorage.getItem('overrideInterval');
        const intervalInput = document.getElementById('recitation-interval');
        const speedControlArea = document.getElementById('speed-control-area');
        const btnShowSpeed = document.getElementById('btn-show-speed');

        if (savedInterval !== null) {
            const parsedInterval = parseFloat(savedInterval);
            globalInterval = parsedInterval * 1000; 
            intervalInput.value = parsedInterval.toFixed(1);
            document.getElementById('recitation-interval-label').innerText = parsedInterval.toFixed(1) + "s";
            
            speedControlArea.style.display = 'flex';
            btnShowSpeed.style.display = 'none';
        } else {
            globalInterval = 3000;
            intervalInput.value = 3;
            speedControlArea.style.display = 'none';
            btnShowSpeed.style.display = 'inline-block';
        }

        // --- 2. SETUP PHẦN CÒN LẠI ---
        sections.forEach((sec, index) => {
            let option = document.createElement("option");
            option.value = index; option.text = sec.title;
            sectionSelect.appendChild(option);
        });
// BỔ SUNG: Xử lý đồng bộ khi người dùng tua (scrub) audio
        audioPlayer.addEventListener('seeked', () => {
            // Nếu đang trong chế độ Tuỳ chỉnh thời gian (Override Interval), không đồng bộ theo audio
            if (localStorage.getItem('overrideInterval')) return;

            // Chỉ chạy logic này khi đang trong chế độ Tụng Đọc
            if (displayArea.classList.contains('recitation-active')) {
                
                // 1. Tìm dòng văn bản mới tương ứng với thời gian audio hiện tại
                const newRecitationLine = findRecitationLine(audioPlayer.currentTime);
                
                // 2. Nếu dòng mới khác dòng cũ, tiến hành đồng bộ
                if (newRecitationLine !== currentRecitationLine) {
                    currentRecitationLine = newRecitationLine;
                    showRecitationLine(currentRecitationLine);
                }
                
                // 3. Xóa timer cũ và tạo timer mới (dựa trên thời gian còn lại của dòng mới)
                if (!audioPlayer.paused) {
                    // Khi audio đang chạy, runRecitationStep sẽ tự tính toán thời gian còn lại
                    // của dòng mới và đặt timer chính xác.
                    runRecitationStep();
                } else {
                    // Nếu audio đang dừng, chỉ cần xóa timer cũ và cập nhật visuals
                    if (recitationTimeout) {
                        clearTimeout(recitationTimeout);
                        recitationTimeout = null;
                    }
                    updateButtonVisuals('manual');
                }
            }
        });        

audioPlayer.addEventListener('play', () => {
    
    if (displayArea.classList.contains('recitation-active') && !recitationTimeout) {
        runRecitationStep();
    }
});
        
// CẬP NHẬT MỚI: Chỉ dừng timer nếu user bấm pause, không dừng nếu audio tự hết
        audioPlayer.addEventListener('pause', () => {
            // Chỉ chạy logic này khi đang trong chế độ Tụng Đọc
            if (displayArea.classList.contains('recitation-active')) {
                
                // Nếu audio dừng vì đã hết bài (ended), THOÁT NGAY.
                if (audioPlayer.ended) return; 

                // Nếu audio dừng do người dùng bấm pause (dù là nút Recitation hay nút Audio Player)
                if(recitationTimeout) {
                    clearTimeout(recitationTimeout); 
                    recitationTimeout = null;
                }
                updateButtonVisuals('manual');
            }
        });
		
audioPlayer.addEventListener('volumechange', () => {
    // Save the current volume (0.0 to 1.0) to localStorage
    localStorage.setItem('savedAudioVolume', audioPlayer.volume);
});
        // Sự kiện khi audio chạy hết bài: Reset về 0:00 và thoát chế độ Recitation
        audioPlayer.addEventListener('ended', () => {
    // If Loop is active and we are in Recitation Mode, 
    // DO NOT reset to 0. Let runRecitationStep handle the loop jump.
    if (isLoopActive && displayArea.classList.contains('recitation-active')) {
        return; 
    }
    
});
        // -------------------------
        let initialIndex = 0;
        const savedIndex = localStorage.getItem('lastSectionIndex');
        if (savedIndex !== null) {
            const parsedIndex = parseInt(savedIndex);
            if (parsedIndex >= 0 && parsedIndex < sections.length) {
                initialIndex = parsedIndex;
            }
        }
        
        loadSection(initialIndex);
    }

/* --- INFO MODAL LOGIC --- */
function showSectionInfo() {
    const currentSection = sections[currentSectionIndex];
    const infoContent = sectionInfoData[currentSection.id];
    
    if (infoContent) {
        // Default Title
        let displayTitle = "Về Kinh Hộ Trì Paritta";
        
        
        document.getElementById('simple-modal-title').innerText = displayTitle;
        document.getElementById('simple-modal-body').innerHTML = infoContent;
        document.getElementById('simple-info-modal').style.display = 'flex';
    }
}

function closeSimpleInfoModal() {
    document.getElementById('simple-info-modal').style.display = 'none';
}

function loadSection(index) {
    // 1. Check if Recitation Mode is CURRENTLY active
    const wasRecitationActive = document.body.classList.contains('recitation-active-mode');

    // 2. Stop audio if playing
    if (!audioPlayer.paused) audioPlayer.pause();
    
    // 3. Handle Index wrapping
    if (index < 0) index = sections.length - 1;
    if (index >= sections.length) index = 0;
    currentSectionIndex = index;
    
    // 4. Save preference
    localStorage.setItem('lastSectionIndex', index);
    selectedLoopIndices.clear();
    // 5. Update UI Basics
    sectionSelect.value = index;
    titleArea.innerText = sections[index].title;
	const infoIcon = document.getElementById('btn-section-info');
    if (sectionInfoData[sections[index].id]) {
        infoIcon.style.display = 'block';
    } else {
        infoIcon.style.display = 'none';
    }
	const vnTitleEl = document.getElementById('section-title-vn');
    if (vnTitleEl) {
        vnTitleEl.innerText = sections[index].title_vn || ""; // Fallback to empty if missing
    }
    audioPlayer.src = 'audio2/' + sections[index].audio; // Ensure path is correct ('audio/' or './audio/')
    
    // 6. Render the Text (This populates allLines)
    renderText(sections[index].text);

   isLoopActive = false;
        document.getElementById('btn-loop').classList.remove('active-loop');
		
		 updateOverallStats(); 
    if (wasRecitationActive) {
        // If mode was on, RESTART it for the new section immediately.
        // We do NOT call exitRecitation().
        
        // a. Re-initialize dashboard for new section
        startRecitationMode(); 
        
        // b. Reset audio position to 0
        audioPlayer.currentTime = 0;
        
        // c. Ensure visuals are set to "Manual" (Paused) start
        updateButtonVisuals('manual');
    } else {
        // If mode was off, ensure we clean up any remnants
        exitRecitation();
    }
}

    function selectSection() { loadSection(parseInt(sectionSelect.value)); }
    function changeSection(d) { loadSection(currentSectionIndex + d); }
// --- RANDOM FUNCTION ---
    function randomSection() {
        // Generate a random index between 0 and the last index of sections array
        const randomIndex = Math.floor(Math.random() * sections.length);
        
        // Load the section
        loadSection(randomIndex);
        
        // Optional: Scroll to top to ensure user sees the new title
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
/* --- NEW RENDER LOGIC --- */
function renderText(rawText) {
    displayArea.innerHTML = '';
    allLines = []; // Reset recitation lines array
    
    // Split text by new line
    const lines = rawText.split('\n');
    
    let cumulativeStartTimeMs = 0;
    const overrideIntervalMs = localStorage.getItem('overrideInterval') ? parseFloat(localStorage.getItem('overrideInterval')) * 1000 : null;

    lines.forEach(line => {
        let cleanLine = line.trim();
        if (cleanLine === '') return;

        // Check if this line is Pali (Recitation line) by looking for time marker [x.x]
        const timeMatch = cleanLine.match(/\s*\[(\d+(\.\d+)?)\]\s*$/);

        if (timeMatch) {
            // === IS PALI LINE ===
            let customDuration = parseFloat(timeMatch[1]) * 1000;
            cleanLine = cleanLine.replace(timeMatch[0], ''); // Remove time marker for display

            const lineDiv = document.createElement('div');
            lineDiv.className = 'line-break';
            
            // Logic for duration (Original vs Override)
            let currentLineDuration; 
            if (overrideIntervalMs !== null) {
                currentLineDuration = overrideIntervalMs;
                lineDiv.dataset.hasCustomTime = "false";
            } else {
                currentLineDuration = customDuration || 3000;
                lineDiv.dataset.hasCustomTime = "true";
            }

            lineDiv.dataset.startTime = cumulativeStartTimeMs / 1000;
            lineDiv.dataset.duration = currentLineDuration;

            cumulativeStartTimeMs += currentLineDuration;

            // Create clickable words for Pali
            cleanLine.split(/\s+/).forEach(wordStr => {
                if (wordStr.trim() === '') return;
                const span = document.createElement('span');
                span.className = 'word';
                span.innerText = wordStr;
                // Click to reveal hidden words logic
                span.onclick = function() {
                    if (this.classList.contains('hidden')) {
                        this.classList.remove('hidden');
                        this.classList.add('revealed');
                    }
                };
                lineDiv.appendChild(span);
            });

            displayArea.appendChild(lineDiv);
            allLines.push(lineDiv); // Add ONLY Pali lines to the recitation array

        } else {
            // === IS TRANSLATION LINE (No time marker) ===
            const transDiv = document.createElement('div');
            transDiv.className = 'translation-line';
            transDiv.innerText = cleanLine;
            displayArea.appendChild(transDiv);
        }
    });
}

// specific setup function or inside window.onload
function initAudioPlayer() {
    const savedVolume = localStorage.getItem('savedAudioVolume');
    
    if (savedVolume !== null) {
        // Convert the string back to a float and apply it
        audioPlayer.volume = parseFloat(savedVolume);
    } else {
        // Optional: Set a default if nothing is saved (e.g., 50%)
        audioPlayer.volume = 0.5; 
    }
}

// Call this when the app starts
initAudioPlayer();
function toggleVietnamese() {
    displayArea.classList.toggle('show-translation');
    const btn = document.getElementById('btn-viet-toggle');
    const isEnabled = displayArea.classList.contains('show-translation');
    
    if (isEnabled) {
        btn.classList.add('btn-viet-active');
    } else {
        btn.classList.remove('btn-viet-active');
    }

    // Save state to LocalStorage
    localStorage.setItem('vietnameseEnabled', isEnabled);
}

    function updateButtonVisuals(state) {
        recitationToggleBtn.classList.remove('active-auto', 'active-manual');
        if (state === 'auto') {
            recitationToggleBtn.classList.add('active-auto'); recitationToggleBtn.innerHTML = '<i class="fas fa-pause"></i>';
        } else if (state === 'manual') {
            recitationToggleBtn.classList.add('active-manual'); recitationToggleBtn.innerHTML = '<i class="fas fa-play"></i>';
        } else {
            recitationToggleBtn.innerHTML = '<i class="fas fa-microphone"></i>';
        }
    }

/* =========================================
   MEMORIZATION DASHBOARD LOGIC
   ========================================= */

// Create a unique key for local storage: score_SectionID_LineIndex
function getScoreKey(lineIdx) {
    const sectionId = sections[currentSectionIndex].id;
    return `memo_score_${sectionId}_${lineIdx}`;
}

function getLineScore(lineIdx) {
    const val = localStorage.getItem(getScoreKey(lineIdx));
    return val ? parseInt(val) : 0;
}

function saveLineScore(lineIdx, score) {
    localStorage.setItem(getScoreKey(lineIdx), score);
    updateDashboardBox(lineIdx, score);
    updateOverallStats();
}

// Render the grid of boxes
// --- UPDATED DASHBOARD LOGIC WITH LONG PRESS ---

function renderDashboard() {
    const grid = document.getElementById('dashboard-grid');
    grid.innerHTML = ''; // Clear old

    allLines.forEach((line, idx) => {
        const score = getLineScore(idx);
        const box = document.createElement('div');
        
        // Add heatmap class
        box.className = `progress-box ${getHeatmapClass(score)}`;
        
        // Restore selection state if re-rendering
        if (selectedLoopIndices.has(idx)) {
            box.classList.add('multi-loop-selected');
        }

        box.innerText = idx + 1;
        box.id = `box-${idx}`;
        
        // ATTACH LONG PRESS EVENTS
        attachBoxEvents(box, idx);

        grid.appendChild(box);
    });

    updateOverallStats();
}

function attachBoxEvents(box, idx) {
    let longPressTimer;
    let isLongPress = false;

    const startPress = (e) => {
        isLongPress = false;
        longPressTimer = setTimeout(() => {
            isLongPress = true;
            toggleBoxSelection(idx);
            // Optional: Vibrate mobile device for feedback
            if (navigator.vibrate) navigator.vibrate(50);
        }, 400); // 500ms threshold for long press
    };

    const cancelPress = () => {
        if (longPressTimer) {
            clearTimeout(longPressTimer);
            longPressTimer = null;
        }
    };

    // Mouse Events
    box.addEventListener('mousedown', startPress);
    box.addEventListener('mouseup', cancelPress);
    box.addEventListener('mouseleave', cancelPress);

    // Touch Events
    box.addEventListener('touchstart', (e) => {
        // We do not preventDefault here to allow scrolling
        startPress(e);
    }, { passive: true });
    
    box.addEventListener('touchend', cancelPress);
    box.addEventListener('touchmove', cancelPress);

    // Click Event (Standard Jump)
    box.onclick = function(e) {
        // If it was a long press, ignore the click (don't jump)
        if (isLongPress) {
            e.stopPropagation();
            return;
        }
        jumpToLine(idx);
    };
}

function toggleBoxSelection(idx) {
    const box = document.getElementById(`box-${idx}`);
    if (selectedLoopIndices.has(idx)) {
        selectedLoopIndices.delete(idx);
        box.classList.remove('multi-loop-selected');
    } else {
        selectedLoopIndices.add(idx);
        box.classList.add('multi-loop-selected');
    }
}

// Determine color class based on score
function getHeatmapClass(score) {
    if (score === 0) return 'heatmap-0';
    if (score <= 25) return 'heatmap-1';
    if (score <= 50) return 'heatmap-2';
    if (score <= 75) return 'heatmap-3';
    return 'heatmap-4';
}

function updateDashboardBox(idx, score) {
    const box = document.getElementById(`box-${idx}`);
    if (box) {
        // Remove old heatmap classes
        box.classList.remove('heatmap-0', 'heatmap-1', 'heatmap-2', 'heatmap-3', 'heatmap-4');
        // Add new
        box.classList.add(getHeatmapClass(score));
    }
}

/* --- UPDATED STATISTICS LOGIC --- */

/* --- UPDATED STATISTICS LOGIC WITH REWARDS --- */

/* --- REPLACE YOUR EXISTING updateOverallStats FUNCTION WITH THIS ONE --- */

function updateOverallStats() {
    // --- 1. CALCULATE SESSION PROGRESS (Current Section) ---
    let sessionTotalScore = 0;
    let sessionMaxScore = allLines.length * 100; // 100% per line

    allLines.forEach((_, idx) => {
        const s = getLineScore(idx); // Get score for current section line
        sessionTotalScore += s;
    });

    // Calculate Session %
    const sessionPct = sessionMaxScore === 0 ? 0 : Math.round((sessionTotalScore / sessionMaxScore) * 100);
    
    // Update Session Bar UI
    document.getElementById('bar-session').style.width = sessionPct + '%';
    document.getElementById('text-session').innerText = sessionPct + '%';

    // --- 2. CALCULATE GLOBAL PROGRESS (All Sections) ---
    const globalStats = calculateGlobalStats();
    
    // Calculate Global %
    const globalPct = globalStats.maxScore === 0 ? 0 : Math.round((globalStats.currentScore / globalStats.maxScore) * 100);

    // Update Global Bar UI
    document.getElementById('bar-total').style.width = globalPct + '%';
    document.getElementById('text-total').innerText = globalPct + '%';

    // --- 3. BANNER LOGIC (UPDATED) ---
    const banner = document.getElementById('section-achievement-banner');
    const bannerTitle = banner.querySelector('h3');
    const bannerSubtitle = banner.querySelector('div');

   if (globalPct === 100 && sessionPct === 100) {
        // CASE A: USER HAS MEMORIZED EVERYTHING (GLOBAL 100%)
        banner.style.display = 'block';
        // Update Title
        bannerTitle.innerHTML = '<i class="fas fa-wreath-laurel"></i> Hộ Trì Pháp Bảo <i class="fas fa-wreath-laurel"></i>';
        // Update Subtitle
        bannerSubtitle.innerHTML = 'Chứng Nhận Thành Tựu Học&nbsp;Thuộc&nbsp;Lòng Kinh&nbsp;Hộ&nbsp;Trì&nbsp;Paritta';

    } else if (sessionPct === 100 && sessionMaxScore > 0) {
        // CASE B: USER MEMORIZED ONLY THIS SECTION (SESSION 100%)
        banner.style.display = 'block';
        // Update Title (Revert to default section title)
        bannerTitle.innerHTML = '<i class="fas fa-wreath-laurel"></i> Hộ Trì Học Pháp <i class="fas fa-wreath-laurel"></i>';
        // Update Subtitle
        bannerSubtitle.innerHTML = 'Chứng Nhận Thành Tựu Học&nbsp;Thuộc&nbsp;Lòng Bài&nbsp;Kinh&nbsp;Này';

    } else {
        // CASE C: NOT COMPLETE
        banner.style.display = 'none';
    }

    // *** REWARD 2: GLOBAL MODAL (Keep existing logic) ***
    if (globalPct === 100 && sessionPct === 100) {
        showGrandAchievement();
    }
}

// Global variable to ensure we don't spam the user if they close the modal in the same session
let hasSeenGlobalModal = false;

function showGrandAchievement() {
    if (hasSeenGlobalModal) return;
    
    const modal = document.getElementById('grand-achievement-modal');
    modal.style.display = 'flex'; // Use flex to center
}

function closeAchievementModal() {
    const modal = document.getElementById('grand-achievement-modal');
    modal.style.display = 'none';
    hasSeenGlobalModal = true; // Mark as seen for this page load
}

// Helper: Iterates through ALL sections data to calculate total mastery
function calculateGlobalStats() {
    let totalScore = 0;
    let maxScore = 0;

    // Loop through every section defined in your data
    sections.forEach(section => {
        // We need to parse the text to find how many "audio lines" exist
        // Regex to match lines ending in time marker [x.x]
        const lines = section.text.split('\n');
        let lineIndex = 0;

        lines.forEach(rawLine => {
            const line = rawLine.trim();
            if (line === '') return;

            // Check if it's a valid recitation line (has time marker)
            if (/\s*\[(\d+(\.\d+)?)\]\s*$/.test(line)) {
                
                // Reconstruct the storage key: memo_score_SECTIONID_LINEINDEX
                // Note: lineIndex increments only for valid audio lines
                const key = `memo_score_${section.id}_${lineIndex}`;
                const savedScore = localStorage.getItem(key);
                
                totalScore += savedScore ? parseInt(savedScore) : 0;
                maxScore += 100; // Each line is worth 100%
                
                lineIndex++;
            }
        });
    });

    return { currentScore: totalScore, maxScore: maxScore };
}

// Function to handle clicking a box
function jumpToLine(idx) {
    const wasPlaying = !audioPlayer.paused;
    if (recitationTimeout) { clearTimeout(recitationTimeout); recitationTimeout = null; }
    
    currentRecitationLine = idx;
    showRecitationLine(idx);
    
    // Sync Audio
    const targetEl = allLines[idx];
    const startTime = parseFloat(targetEl.dataset.startTime || 0);
    audioPlayer.currentTime = startTime;

    if (wasPlaying) {
        // If it was playing, keep playing from the new time
        audioPlayer.play();
        // You may need to update visuals to 'playing' state here if 'manual' sets it to pause
        // updateButtonVisuals('playing'); 
    } else {
        // If it was paused, keep it paused and update visuals
        updateButtonVisuals('manual'); 
        audioPlayer.pause();
    }
} 
function toggleRecitationAction() {
    const isActive = displayArea.classList.contains('recitation-active');
    const isRunning = !!recitationTimeout;

    if (!isActive) {
        // Action: START RECITATION MODE (Manual Start)
        
        startRecitationMode();
        
        // --- CHANGE HERE: REMOVED audioPlayer.play() ---
        // By removing audioPlayer.play(), the mode starts but the audio remains paused.
        // startRecitationMode() already sets the initial line and the 'manual' visual state.
        
        return;
    }

    // We are already in Recitation Mode
    if (isRunning || !audioPlayer.paused) {
        // Action: PAUSE
        // This handles pausing when in auto-play or manual-play state.
        if (!audioPlayer.paused) audioPlayer.pause();
    } else {
        // Action: PLAY / RESUME
        if (audioPlayer.ended) {
            // If audio ended, reset, and start from the beginning
            audioPlayer.currentTime = 0;
            currentRecitationLine = 0;
            showRecitationLine(0);
        }
        // Simply call play. The 'play' event listener will trigger the self-correcting runRecitationStep.
        audioPlayer.play();
    }
}
function findRecitationLine(currentTime) {
        // Iterate backwards for slightly more efficient search, 
        // especially if seeking near the end.
        for (let i = allLines.length - 1; i >= 0; i--) {
            const line = allLines[i];
            const startTime = parseFloat(line.dataset.startTime || 0);
            const duration = parseFloat(line.dataset.duration || 0) / 1000;
            const endTime = startTime + duration;

            // If the current audio time is within this line's window
            if (currentTime >= startTime && currentTime < endTime) {
                return i;
            }
        }
        // If the current time is before the first line, return the first line (0)
        return 0;
    }
    function startRecitationMode() {
    resetText();
    displayArea.classList.add('recitation-active');
    document.body.classList.add('recitation-active-mode');
    
    // --- NEW: GENERATE DASHBOARD ---
    renderDashboard(); 
    // -------------------------------

    currentRecitationLine = 0;
    showRecitationLine(0);
    updateButtonVisuals('manual');
}

    function exitRecitation() {
        if(recitationTimeout) clearTimeout(recitationTimeout); recitationTimeout = null;
        if(!audioPlayer.paused) audioPlayer.pause();

        displayArea.classList.remove('recitation-active');
        document.body.classList.remove('recitation-active-mode');
        document.querySelector('.line-recitation-show')?.classList.remove('line-recitation-show');
        
        // --- FIX: Remove all slider containers from the text ---
        document.querySelectorAll('.memorize-slider-container').forEach(el => el.remove());
        // -------------------------------------------------------

        updateButtonVisuals('inactive');
    }

    function runRecitationStep() {
    if (recitationTimeout) clearTimeout(recitationTimeout);
    
    // Safety check
    if (currentRecitationLine >= allLines.length) { exitRecitation(); return; }

    showRecitationLine(currentRecitationLine);
    updateButtonVisuals('auto'); 

    const el = allLines[currentRecitationLine];
    const dur = parseFloat(el.dataset.duration);
    const startTimeSeconds = parseFloat(el.dataset.startTime);

    let timeToNextStep = dur; 
    const isCustomSpeed = localStorage.getItem('overrideInterval') !== null;
    
    // --- 1. Calculate time remaining for current line ---
    if (!isCustomSpeed && !audioPlayer.paused) {
        const lineDurationSeconds = dur / 1000;
        const elapsedTimeSeconds = audioPlayer.currentTime - startTimeSeconds;
        const remainingDurationMs = (lineDurationSeconds - elapsedTimeSeconds) * 1000;
        
        if (remainingDurationMs > 50) {
            timeToNextStep = remainingDurationMs;
        } else {
            // If we are already past the time, force a tiny delay to trigger the transition immediately
            timeToNextStep = 10;
        }
    }

    // --- 2. Determine the Next Index (The Sequence Logic) ---
    recitationTimeout = setTimeout(() => {
        let nextIdx;

        if (isLoopActive) {
            // --- A. Loop Mode (Single or Selected Boxes) ---
            if (selectedLoopIndices.size > 0) {
                 // Multi-loop logic...
                 const sortedIndices = Array.from(selectedLoopIndices).sort((a, b) => a - b);
                 const nextInSequence = sortedIndices.find(i => i > currentRecitationLine);
                 nextIdx = nextInSequence !== undefined ? nextInSequence : sortedIndices[0];
            } else {
                 // Single Loop (Current Sentence)
                 nextIdx = currentRecitationLine; 
            }
        } else {
            // --- B. Normal Mode (Default: Loop Entire Section) ---
            nextIdx = currentRecitationLine + 1;
            
            // IF we reach the end, wrap back to 0 (Loop All)
            if (nextIdx >= allLines.length) {
                nextIdx = 0;
            }
        }

        // --- 3. Execute Transition ---
        if (nextIdx < allLines.length) {
            const prevLine = currentRecitationLine;
            currentRecitationLine = nextIdx;
            
            // Sync Audio logic
            // We need to seek audio if:
            // 1. Loop Mode is Active (Single or Multi jumping back)
            // 2. We wrapped around from End -> Start in Normal Mode (Loop All)
            
            const wrappedAround = (!isLoopActive && nextIdx === 0 && prevLine === allLines.length - 1);
            
            if ((isLoopActive || wrappedAround) && !isCustomSpeed) {
                const targetLine = allLines[currentRecitationLine];
                const newStart = parseFloat(targetLine.dataset.startTime);
                
                audioPlayer.currentTime = newStart;
                
                // Ensure audio resumes if it paused at the end of the track
                if (audioPlayer.paused) audioPlayer.play(); 
            }

            runRecitationStep(); 
        } else {
            // This path is now rarely taken unless the text is empty
            exitRecitation(); 
        }

    }, timeToNextStep);
}

    function showRecitationLine(idx) {
    // 1. Remove highlight from previous line
    document.querySelector('.line-recitation-show')?.classList.remove('line-recitation-show');
    
    // 2. Remove highlight from previous dashboard box
    document.querySelector('.progress-box.active-box')?.classList.remove('active-box');

    // 3. Highlight new line & new box
    if (allLines[idx]) {
        const lineDiv = allLines[idx];
        lineDiv.classList.add('line-recitation-show');
        lineDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });

        // Highlight box in dashboard
        const box = document.getElementById(`box-${idx}`);
        if(box) box.classList.add('active-box');

        // --- NEW: INJECT SLIDER ---
        injectSlider(lineDiv, idx);
    }
}

// Function to create/update slider
function injectSlider(lineElement, idx) {
    // Check if container exists (Reusing class name for cleanup compatibility)
    let container = lineElement.querySelector('.memorize-slider-container');
    
    if (!container) {
        // Create container
        container = document.createElement('div');
        container.className = 'memorize-slider-container';
        
        // Create Label Wrapper
        const label = document.createElement('label');
        label.className = 'memorize-checkbox-label';
        
        // Create Checkbox
        const input = document.createElement('input');
        input.type = 'checkbox';
        input.className = 'memorize-checkbox';
        
        // Logic: Binary 0 or 100
        input.onchange = function() {
            const score = this.checked ? 100 : 0;
            saveLineScore(idx, score);
        };

        // Append Text
        const textSpan = document.createElement('span');
        textSpan.innerText = "Đã thuộc"; // Label text: "Memorized"

        // Assemble elements
        label.appendChild(input);
        label.appendChild(textSpan);
        container.appendChild(label);
        lineElement.appendChild(container);
    }

    // Set current state (Checked if score is 100)
    const currentScore = getLineScore(idx);
    const input = container.querySelector('input');
    // We treat anything less than 100 as "not fully memorized"
    input.checked = (currentScore >= 100);
}


function navigateRecitation(d) {
        // 1. Check if audio is currently playing before we do anything
        const isPlaying = !audioPlayer.paused && !audioPlayer.ended;
        
        // 2. Clear the existing timer so we don't have overlapping jumps
        if (recitationTimeout) { clearTimeout(recitationTimeout); recitationTimeout = null; }
        
        // 3. Activate recitation mode if it wasn't already (Edge case)
        if (!displayArea.classList.contains('recitation-active')) { 
            startRecitationMode();
        }
        
        // 4. Update the line index
        currentRecitationLine += d;
        if (currentRecitationLine < 0) currentRecitationLine = 0;
        if (currentRecitationLine >= allLines.length) currentRecitationLine = allLines.length - 1;

        // 5. Show the new line visually
        showRecitationLine(currentRecitationLine);

        // 6. Sync the audio to the start time of the new line
        const targetEl = allLines[currentRecitationLine];
        const startTimeSeconds = parseFloat(targetEl.dataset.startTime || 0);
        audioPlayer.currentTime = startTimeSeconds; 
        
        // 7. Decide logic based on previous state
        if (isPlaying) {
            // If it was playing:
            // We do NOT pause. We just restart the sync timer (runRecitationStep)
            // so it counts down the duration of this new line correctly.
            runRecitationStep();
        } else {
            // If it was paused:
            // Keep it paused and show the "Manual" (Play button) state.
            updateButtonVisuals('manual');
        }
    }

    // --- CÁC HÀM PHỤ ---
    function hideRandomWords() {
        const wasActive = displayArea.classList.contains('recitation-active');
        resetText(true);
        const words = document.querySelectorAll('.word');
        const count = Math.floor(words.length * (document.getElementById('difficulty').value / 100));
        Array.from({length: words.length}, (_, i) => i).sort(() => Math.random()-.5).slice(0, count).forEach(i => words[i].classList.add('hidden'));
        
        if (wasActive) {
            displayArea.classList.add('recitation-active');
            updateButtonVisuals('manual');
        }
    }
    
    function resetText(keep = false) {
        if (!keep) exitRecitation();
        document.querySelectorAll('.word').forEach(w => w.classList.remove('hidden', 'revealed'));
    }

    function toggleSettings() { settingsPanel.classList.toggle('open'); }
    function updateLabel(v) { document.getElementById('difficulty-label').innerText = v + "%"; }
    
    // --- CÁC HÀM MỚI CHO TỐC ĐỘ ---

    function toggleSpeedControl() {
        document.getElementById('btn-show-speed').style.display = 'none';
        document.getElementById('speed-control-area').style.display = 'flex';
    }

    function updateRecitationInterval(v) { 
        const newIntervalSeconds = parseFloat(v);
        localStorage.setItem('overrideInterval', newIntervalSeconds.toFixed(1)); 
        
        document.getElementById('recitation-interval-label').innerText = newIntervalSeconds.toFixed(1) + "s";
        loadSection(currentSectionIndex); 
        if(!audioPlayer.paused && displayArea.classList.contains('recitation-active')) audioPlayer.pause();
    }

    function resetSpeedDefault() {
        localStorage.removeItem('overrideInterval');
        document.getElementById('recitation-interval').value = 3;
        document.getElementById('recitation-interval-label').innerText = "3.0s";
        document.getElementById('speed-control-area').style.display = 'none';
        document.getElementById('btn-show-speed').style.display = 'inline-block';
        loadSection(currentSectionIndex);
    }
    
    function toggleTheme() {
        const body = document.body;
        const btn = document.querySelector('.btn-darkmode');
        const isDark = body.getAttribute('data-theme') === 'dark';

        if (isDark) {
            body.removeAttribute('data-theme');
            btn.innerHTML = '<i class="fas fa-moon"></i>';
            localStorage.setItem('themePreference', 'light');
        } else {
            body.setAttribute('data-theme', 'dark');
            btn.innerHTML = '<i class="fas fa-sun-bright"></i>';
            localStorage.setItem('themePreference', 'dark');
        }
    }

    init();
</script>
</body>
</html>