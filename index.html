<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="icon" type="image/x-icon" href="./images/favicon2.ico">
	<link rel="manifest" href="./manifest4.json">
	<meta name="theme-color" content="#8b5cf6">
	<link rel="apple-touch-icon" href="./images/icon-192-patimokkha.png">
	<link href="./css/css.css" rel="stylesheet">
	<link href="./css/vi.css" rel="stylesheet">
    <title>Pātimokkha Memorize</title>
 	<script src="./js/jquery-1.10.2.min.js"></script>
    <script src="./js/edpd_i2h.js"></script>
    <script src="./js/edpd_ebts.js"></script>
    <script src="./js/dpd_deconstructor.js"></script>	
</head>
<body>

<div class="container" id="main-container">
<div class="top-nav">
    <button class="btn-darkmode" onclick="toggleTheme()"><i class="fas fa-moon"></i></button> 
    

        
        <div class="nav-controls">
            <button class="btn-nav" onclick="changeSection(-1)"><i class="fas fa-angle-left"></i></button>
            <select id="section-select" onchange="selectSection()"></select>
            <button class="btn-nav" onclick="changeSection(1)"><i class="fas fa-angle-right"></i></button>
	    <div id="top-right-controls" style="display: flex; gap: 3px; align-items: center;">
        
        <button class="btn-nav" onclick="openHelpModal()" title="Trợ giúp">
    <i class="fas fa-circle-info"></i>
</button>		
        </div>
    </div>
</div>

<div id="section-achievement-banner">
    <h3>
        <i class="fas fa-wreath-laurel"></i> 
        Vinayavidū
        <i class="fas fa-wreath-laurel"></i>
    </h3>
    <div style="font-size:12px; margin-top:5px;">Certification of Achievement in&nbsp;Memorizing&nbsp;this&nbsp;Sikkhāpada</div>
</div>

	<div id="recitation-dashboard">
    <div id="dashboard-grid" class="dashboard-grid">
        </div>
    <div class="dashboard-stats">
        <div class="progress-bar-container">
            <span style="width: 120px;">Section Progress:</span>
            <div class="progress-track"><div id="bar-session" class="progress-fill" style="background-color: #3498db;"></div></div>
            <span id="text-session">0%</span>
        </div>
        <div class="progress-bar-container">
            <span style="width: 120px;">Memorized Total:</span>
            <div class="progress-track"><div id="bar-total" class="progress-fill" style="background-color: #27ae60;"></div></div>
            <span id="text-total">0%</span>
        </div>
    </div>
</div>
    <h2 id="section-title">Loading...</h2>
    <div id="display-area" class="text-content"></div>
</div>

<div class="bottom-bar">
    <div class="bar-main-row">
        <audio id="audioPlayer" controls>Your browser doesn't support audio.</audio>

        <div class="controls-cluster">
		
	           
            <button id="btn-dictionary" class="icon-btn" onclick="togglePaliLookup()" title="Pali Lookup"><i class="fas fa-book-open"></i></button>
			<button id="settings-btn" class="icon-btn btn-settings" onclick="toggleSettings()" title="Settings"><i class="fas fa-gear"></i></button>
			<button id="btn-exit-recitation" class="icon-btn" onclick="exitRecitation()" title="Exit Recitation"><i class="fas fa-xmark"></i></button> <button id="btn-loop" class="icon-btn" onclick="toggleLoopSentence()" title="Loop current sentence">
    <i class="fas fa-arrows-repeat"></i>
</button> <button id="recitation-toggle-btn" class="icon-btn btn-recitation" onclick="toggleRecitationAction()" title="Recitation"><i class="fas fa-microphone"></i></button>
           
		<button id="btn-random" class="icon-btn" onclick="randomSection()" title="Random Training Rule">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
            <circle cx="12" cy="12" r="9"></circle>
            <circle cx="12" cy="12" r="2.5"></circle>
            <line x1="12" y1="3" x2="12" y2="9.5"></line>   <line x1="12" y1="14.5" x2="12" y2="21"></line> <line x1="3" y1="12" x2="9.5" y2="12"></line>   <line x1="14.5" y1="12" x2="21" y2="12"></line> <line x1="5.64" y1="5.64" x2="10.23" y2="10.23"></line> <line x1="13.77" y1="13.77" x2="18.36" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="13.77" y2="10.23"></line>
            <line x1="10.23" y1="13.77" x2="5.64" y2="18.36"></line>
        </svg>
    </button>
  <button id="btn-english-toggle" class="icon-btn" onclick="toggleEnglish()" title="Show English translation">EN</button>
			<button class="icon-btn btn-nav-recitation" onclick="navigateRecitation(-1)" title="Previous"><i class="fas fa-angles-left"></i></button>
            <button class="icon-btn btn-nav-recitation" onclick="navigateRecitation(1)" title="Next"><i class="fas fa-angles-right"></i></button>
        </div>
    </div>

    <div id="settings-panel" class="settings-panel">
        <div class="settings-content">
            <div class="setting-group">
                <span style="font-size:13px; font-weight:600">Hide texts:</span>
                <input type="range" id="difficulty" min="10" max="90" value="40" oninput="updateLabel(this.value)" style="width:80px">
                <span id="difficulty-label" style="font-size:12px">40%</span>
                <button class="btn-sm" onclick="hideRandomWords()" style="background:#d35400; color:white;">Hide</button>
                <button class="btn-sm" onclick="resetText(true)" style="background:#7f8c8d; color:white;">Show</button>
            </div>

            <div class="setting-group">
                <span style="font-size:13px; font-weight:600">Speed:</span>
                
                <button id="btn-show-speed" class="btn-sm" onclick="toggleSpeedControl()" style="background:#2980b9; color:white;"><i class="far fa-clock"></i></button>

                <div id="speed-control-area" style="display:none; align-items:center; gap:5px;">
                    <input type="range" id="recitation-interval" min="1" max="10" step="0.5" value="3" oninput="updateRecitationInterval(this.value)" style="width:80px">
                    <span id="recitation-interval-label" style="font-size:12px">3.0s</span>
                    <button class="btn-sm" onclick="resetSpeedDefault()" style="background:#6a4c93; color:white;" title="Use default values">Use default</button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="help-modal" class="help-modal-overlay" onclick="closeHelpModal(event)">
    <div class="help-modal-content">
        <div class="help-modal-header">
            <h3>Pātimokkha Memorize</h3>
            <button class="btn-close-help" onclick="closeHelpModal(event)"><i class="fas fa-xmark"></i></button>
        </div>
		<div class="help-modal-body">
    
   
    <p>This is a web-based app & tool designed to assist Bhikkhus and students in <b>memorizing the Pātimokkha</b>. It features synchronized text & audio chanting for precise follow-along practice, includes memorization drills by hiding random words, and an interactive dashboard to track memorization progress.</p>

    <h4><i class="fas fa-book-open-reader"></i> User Guide</h4>
    
    <h4>1. Navigation & Basics</h4>
    <ul>
        <li><b>Theme Toggle (<i class="fas fa-moon"></i>/<i class="fas fa-sun-bright"></i>):</b> Switch between Light and Dark modes.</li>
        <li><b>Section Selector:</b> Jump to a specific rule (e.g., Pārājika 1).</li>
        <li><b>Random (<i class="far fa-dharmachakra"></i>):</b> Jump to a random rule to test your recall.</li>
        <li><b>Dictionary (<i class="fas fa-book-open"></i>):</b> Toggle to enable Pāli lookup. Hover over words to see definitions.</li>
    </ul>

    <h4>2. Recitation Mode (<i class="fas fa-microphone"></i>)</h4>
    <p>Click the Mic button to enter Recitation Mode. The text enlarges and syncs with the audio.</p>
    <ul>
        <li><b>Status:</b> Green = Auto-playing; Blue = Paused/Manual.</li>
        <li><b>Navigation:</b> Use <b>«</b> and <b>»</b> to jump lines.</li>
    </ul>

    <h4>3. Loop Mode (Repetition)</h4>
    <ul>
        <li><b>Single Loop:</b> Click the Loop button (<i class="fas fa-arrows-repeat"></i>) to repeat the current sentence indefinitely.</li>
        <li><b>Multi-Loop (Custom Sequence):</b> 
            <ul>
                <li>In the Dashboard Grid (colored boxes), <b>Long Press (Hold)</b> a box to select it. It will turn Red.</li>
                <li>Select multiple boxes to create a custom loop. The player will cycle through only the selected lines.</li>
                <li>Long press again to deselect.</li>
            </ul>
        </li>
		<li><b>Default Loop:</b> When not clicked upon, the Loop button will repeat the current section audio.</li>
    </ul>

    <h4>4. Mastery Dashboard & Progress</h4>
    <p>Located above the text in Recitation Mode, this dashboard visualizes your memory retention.</p>
    <ul>
        <li><b>Heatmap Grid:</b> Each box represents a line of text.
            <ul>
                <li><b>Gray:</b> Not memorized.</li>
                <li><b>Green:</b> Memorized.</li>
            </ul>
        </li>
        <li><b>Marking Progress:</b> When a line is active, a <b>"Memorized"</b> checkbox appears below the text. Check this to mark the line as complete (100%).</li>
        <li><b>Statistics:</b>
            <ul>
                <li><b>Section Progress:</b> Completion % of the current rule.</li>
                <li><b>Memorized Total:</b> Completion % of the entire Pātimokkha.</li>
            </ul>
        </li>    </ul>
		
		<h4>5. Review & Quiz System <i class="fas fa-clipboard-check"></i></h4>
    <p>To ensure solid memorization, the app features an integrated multiple-choice quiz system:</p>
    <ul>
        <li><b>Verifying "Memorized":</b> When you tick the <i>"Memorized"</i> checkbox next to a line, a mini-quiz appears. You must correctly select the missing word for the system to officially mark that line as memorized.</li>
        <li><b>Mastery Test:</b> Once you have memorized 100% of the lines in a section, the <b>"Start Test"</b> button will appear. You must pass this random test (10 questions) to receive the Certificate of Achievement for that section.</li>
        <li><b>Custom Review:</b> You can select specific cells on the progress grid (by <b>long-pressing</b> them). The system will then generate a custom quiz consisting only of the lines you selected for review.</li>
       <li><b>Achievements:</b> You will receive a "Sikkhāpadavidū" banner for completing a section, and a "Vinayavidū" Medal Modal for completing the entire text.</li>
    </ul>
		

    <h4>6. Settings (<i class="fas fa-gear"></i>)</h4>
    <ul>
        <li><b>Hide Texts:</b> Use the slider to hide random words (10%-90%) to test your memory. Click hidden boxes to reveal them.</li>
        <li><b>Speed Control (<i class="far fa-clock"></i>):</b> Override the audio synchronization to set a fixed speed (e.g., 5 seconds per line) for practicing recitation at a steady, slower, or faster pace without audio sync.</li>
    </ul>

    <h4><i class="fas fa-floppy-disk"></i> Use Offline</h4>
    <p>
        To Use Offline, download the Apk file for Android, Zip file for PC, or ZIM file for Kiwix.
        (Learn more about Kiwix: <a href="https://kiwix.org/en/" target="_blank">kiwix.org</a>).
    </p>
    <p>Download Link & Source Code: <a href="https://github.com/buddhanussati/patimokkha-memorize"><b>here</b></a></p>

    <h4><i class="fas fa-scale-balanced"></i>&nbsp;&nbsp;License</h4>
    <p>
        Licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0/legalcode" target="_blank">CC BY-NC 4.0</a>.
        Free to Share and Adapt for <b>non-commercial</b> purposes.
    </p>
	<button class="btn-bottom-close" onclick="closeHelpModal(event)">Close</button>
        </div>
</div></div>
<div id="grand-achievement-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="medal-icon">
            <i class="far fa-wreath-laurel"></i>
        </div>
        
        <div class="modal-title">Vinayavidū</div>
        
        <p class="modal-text">
            Certification of Achievement: Full&nbsp;Memorization of&nbsp;the&nbsp;<b>Bhikkhu&nbsp;Pātimokkha</b><br>
            
            <span style="display: block; color: #b35900; font-weight: 600; font-style: italic; margin-top: 15px;">
       "Calm in body, calm in speech,<br>
        Tranquil and composed of heart,<br>
        Whoso has spewed out worldly&nbsp;wants<br>
        "Serene" is such a bhikkhu called."
    </span>
        </p>
        
        <button class="btn-close-modal" onclick="closeAchievementModal()">Sādhu! Sādhu!</button>
    </div>
</div>
<div id="quiz-modal" class="modal-overlay">
    <div class="modal-content quiz-content">
        <div class="quiz-header">
            <h3 id="quiz-title">Memory Test</h3>
            <div id="quiz-progress">Question 1/2</div>
        </div>
        
        <div id="quiz-body">
            <p class="quiz-instruction">Select the words below to fill in the blanks:</p>
            
            <div id="quiz-sentence-area" class="quiz-sentence-area">
                </div>

            <div id="quiz-options-area" class="quiz-options-area">
                </div>
        </div>

        <div id="quiz-feedback" class="quiz-feedback" style="display:none;"></div>

        <div class="quiz-footer">
            <button id="btn-quiz-cancel" class="btn-secondary" onclick="closeQuizModal()">Cancel</button>
            <button id="btn-quiz-reset" class="btn-warning" onclick="resetCurrentQuestion()" style="display:none;">Reset</button>
            <button id="btn-quiz-next" class="btn-primary" onclick="nextQuizQuestion()" disabled>Continue</button>
        </div>
    </div>
</div>
<script src="./js/en-patimokkha.js"></script>

</body>
</html>